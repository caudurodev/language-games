(function(D,U){typeof exports=="object"&&typeof module!="undefined"?U(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],U):(D=typeof globalThis!="undefined"?globalThis:D||self,U(D["@nhost/nextjs"]={},D.React))})(this,function(D,U){"use strict";function Ui(t){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const r in t)if(r!=="default"){const n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:()=>t[r]})}}return e.default=t,Object.freeze(e)}const Mi=Ui(U);function Ht(t){this.message=t}Ht.prototype=new Error,Ht.prototype.name="InvalidCharacterError";var Br=typeof window!="undefined"&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new Ht("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,i=0,s=0,o="";n=e.charAt(s++);~n&&(r=i%4?64*r+n:n,i++%4)?o+=String.fromCharCode(255&r>>(-2*i&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return o};function ji(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(r){return decodeURIComponent(Br(r).replace(/(.)/g,function(n,i){var s=i.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}(e)}catch{return Br(e)}}function ut(t){this.message=t}function Gr(t,e){if(typeof t!="string")throw new ut("Invalid token specified");var r=(e=e||{}).header===!0?0:1;try{return JSON.parse(ji(t.split(".")[r]))}catch(n){throw new ut("Invalid token specified: "+n.message)}}ut.prototype=new Error,ut.prototype.name="InvalidTokenError";/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var T=function(){return T=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},T.apply(this,arguments)};function zt(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function B(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function F(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function z(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}var Y;(function(t){t.Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose"})(Y||(Y={}));var pe;(function(t){t.Parent="#_parent",t.Internal="#_internal"})(pe||(pe={}));var lt=Y.Start,dt=Y.Stop,Re=Y.Raise,Ce=Y.Send,Kt=Y.Cancel,$r=Y.NullEvent,ht=Y.Assign,Fi=Y.After,Vi=Y.DoneState,ft=Y.Log,qr=Y.Init,pt=Y.Invoke,Bi=Y.ErrorExecution,Jt=Y.ErrorPlatform,Wt=Y.ErrorCustom,vt=Y.Update,Yr=Y.Choose,Hr=Y.Pure;const Gi=Object.freeze(Object.defineProperty({__proto__:null,after:Fi,assign:ht,cancel:Kt,choose:Yr,doneState:Vi,error:Wt,errorExecution:Bi,errorPlatform:Jt,init:qr,invoke:pt,log:ft,nullEvent:$r,pure:Hr,raise:Re,send:Ce,start:lt,stop:dt,update:vt},Symbol.toStringTag,{value:"Module"}));var zr=".",Kr={},Qt="xstate.guard",$i="",W=process.env.NODE_ENV==="production",mt;function Xt(t,e,r){r===void 0&&(r=zr);var n=We(t,r),i=We(e,r);return G(i)?G(n)?i===n:!1:G(n)?n in i:Object.keys(n).every(function(s){return s in i?Xt(n[s],i[s]):!1})}function Jr(t){try{return G(t)||typeof t=="number"?"".concat(t):t.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function Zt(t,e){try{return je(t)?t:t.toString().split(e)}catch{throw new Error("'".concat(t,"' is not a valid state path."))}}function qi(t){return typeof t=="object"&&"value"in t&&"context"in t&&"event"in t&&"_event"in t}function We(t,e){if(qi(t))return t.value;if(je(t))return yt(t);if(typeof t!="string")return t;var r=Zt(t,e);return yt(r)}function yt(t){if(t.length===1)return t[0];for(var e={},r=e,n=0;n<t.length-1;n++)n===t.length-2?r[t[n]]=t[n+1]:(r[t[n]]={},r=r[t[n]]);return e}function Qe(t,e){for(var r={},n=Object.keys(t),i=0;i<n.length;i++){var s=n[i];r[s]=e(t[s],s,t,i)}return r}function Wr(t,e,r){var n,i,s={};try{for(var o=B(Object.keys(t)),c=o.next();!c.done;c=o.next()){var a=c.value,u=t[a];r(u)&&(s[a]=e(u,a,t))}}catch(l){n={error:l}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}var Yi=function(t){return function(e){var r,n,i=e;try{for(var s=B(t),o=s.next();!o.done;o=s.next()){var c=o.value;i=i[c]}}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i}};function Hi(t,e){return function(r){var n,i,s=r;try{for(var o=B(t),c=o.next();!c.done;c=o.next()){var a=c.value;s=s[e][a]}}catch(u){n={error:u}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}}function gt(t){if(!t)return[[]];if(G(t))return[[t]];var e=Q(Object.keys(t).map(function(r){var n=t[r];return typeof n!="string"&&(!n||!Object.keys(n).length)?[[r]]:gt(t[r]).map(function(i){return[r].concat(i)})}));return e}function Q(t){var e;return(e=[]).concat.apply(e,z([],F(t),!1))}function Qr(t){return je(t)?t:[t]}function le(t){return t===void 0?[]:Qr(t)}function Et(t,e,r){var n,i;if(H(t))return t(e,r.data);var s={};try{for(var o=B(Object.keys(t)),c=o.next();!c.done;c=o.next()){var a=c.value,u=t[a];H(u)?s[a]=u(e,r.data):s[a]=u}}catch(l){n={error:l}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}function zi(t){return/^(done|error)\./.test(t)}function Xr(t){return!!(t instanceof Promise||t!==null&&(H(t)||typeof t=="object")&&H(t.then))}function Ki(t){return t!==null&&typeof t=="object"&&"transition"in t&&typeof t.transition=="function"}function Ji(t,e){var r,n,i=F([[],[]],2),s=i[0],o=i[1];try{for(var c=B(t),a=c.next();!a.done;a=c.next()){var u=a.value;e(u)?s.push(u):o.push(u)}}catch(l){r={error:l}}finally{try{a&&!a.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}return[s,o]}function Zr(t,e){return Qe(t.states,function(r,n){if(r){var i=(G(e)?void 0:e[n])||(r?r.current:void 0);if(i)return{current:i,states:Zr(r,i)}}})}function Wi(t,e){return{current:e,states:Zr(t,e)}}function en(t,e,r,n){W||ne(!!t,"Attempting to update undefined context");var i=t&&r.reduce(function(s,o){var c,a,u=o.assignment,l={state:n,action:o,_event:e},h={};if(H(u))h=u(s,e.data,l);else try{for(var d=B(Object.keys(u)),f=d.next();!f.done;f=d.next()){var p=f.value,m=u[p];h[p]=H(m)?m(s,e.data,l):m}}catch(w){c={error:w}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(c)throw c.error}}return Object.assign({},s,h)},t);return i}var ne=function(){};W||(ne=function(t,e){var r=t instanceof Error?t:void 0;if(!(!r&&t)&&console!==void 0){var n=["Warning: ".concat(e)];r&&n.push(r),console.warn.apply(console,n)}});function je(t){return Array.isArray(t)}function H(t){return typeof t=="function"}function G(t){return typeof t=="string"}function tn(t,e){if(t)return G(t)?{type:Qt,name:t,predicate:e?e[t]:void 0}:H(t)?{type:Qt,name:t.name,predicate:t}:t}function Qi(t){try{return"subscribe"in t&&H(t.subscribe)}catch{return!1}}var be=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();mt={},mt[be]=function(){return this},mt[Symbol.observable]=function(){return this};function ge(t){return!!t&&"__xstatenode"in t}function Xi(t){return!!t&&typeof t.send=="function"}var Zi=function(){var t=0;return function(){return t++,t.toString(16)}}();function er(t,e){return G(t)||typeof t=="number"?T({type:t},e):t}function oe(t,e){if(!G(t)&&"$$type"in t&&t.$$type==="scxml")return t;var r=er(t);return T({name:r.type,data:r,$$type:"scxml",type:"external"},e)}function Fe(t,e){var r=Qr(e).map(function(n){return typeof n=="undefined"||typeof n=="string"||ge(n)?{target:n,event:t}:T(T({},n),{event:t})});return r}function es(t){if(!(t===void 0||t===$i))return le(t)}function ts(t,e,r){if(!W){var n=t.stack?" Stacktrace was '".concat(t.stack,"'"):"";if(t===e)console.error("Missing onError handler for invocation '".concat(r,"', error was '").concat(t,"'.").concat(n));else{var i=e.stack?" Stacktrace was '".concat(e.stack,"'"):"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '".concat(r,"'. ")+"Original error: '".concat(t,"'. ").concat(n," Current error is '").concat(e,"'.").concat(i))}}}function rn(t,e,r,n,i){var s=t.options.guards,o={state:i,cond:e,_event:n};if(e.type===Qt)return((s==null?void 0:s[e.name])||e.predicate)(r,n.data,o);var c=s==null?void 0:s[e.type];if(!c)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return c(r,n.data,o)}function nn(t){return typeof t=="string"?{type:t}:t}function Xe(t,e,r){var n=function(){},i=typeof t=="object",s=i?t:null;return{next:((i?t.next:t)||n).bind(s),error:((i?t.error:e)||n).bind(s),complete:((i?t.complete:r)||n).bind(s)}}function St(t,e){return"".concat(t,":invocation[").concat(e,"]")}var Pe=oe({type:qr});function Tt(t,e){return e&&e[t]||void 0}function Ve(t,e){var r;if(G(t)||typeof t=="number"){var n=Tt(t,e);H(n)?r={type:t,exec:n}:n?r=n:r={type:t,exec:void 0}}else if(H(t))r={type:t.name||t.toString(),exec:t};else{var n=Tt(t.type,e);if(H(n))r=T(T({},t),{exec:n});else if(n){var i=n.type||t.type;r=T(T(T({},n),t),{type:i})}else r=t}return r}var Ee=function(t,e){if(!t)return[];var r=je(t)?t:[t];return r.map(function(n){return Ve(n,e)})};function wt(t){var e=Ve(t);return T(T({id:G(t)?t:e.id},e),{type:e.type})}function sn(t){return G(t)?{type:Re,event:t}:xe(t,{to:pe.Internal})}function on(t){return{type:Re,_event:oe(t.event)}}function xe(t,e){return{to:e?e.to:void 0,type:Ce,event:H(t)?t:er(t),delay:e?e.delay:void 0,id:e&&e.id!==void 0?e.id:H(t)?t.name:Jr(t)}}function an(t,e,r,n){var i={_event:r},s=oe(H(t.event)?t.event(e,r.data,i):t.event),o;if(G(t.delay)){var c=n&&n[t.delay];o=H(c)?c(e,r.data,i):c}else o=H(t.delay)?t.delay(e,r.data,i):t.delay;var a=H(t.to)?t.to(e,r.data,i):t.to;return T(T({},t),{to:a,_event:s,event:s.data,delay:o})}function tr(t,e){return xe(t,T(T({},e),{to:pe.Parent}))}function rs(t,e,r){return xe(e,T(T({},r),{to:t}))}function ns(){return tr(vt)}function is(t,e){return xe(t,T(T({},e),{to:function(r,n,i){var s=i._event;return s.origin}}))}var ss=function(t,e){return{context:t,event:e}};function os(t,e){return t===void 0&&(t=ss),{type:ft,label:e,expr:t}}var cn=function(t,e,r){return T(T({},t),{value:G(t.expr)?t.expr:t.expr(e,r.data,{_event:r})})},un=function(t){return{type:Kt,sendId:t}};function ln(t){var e=wt(t);return{type:Y.Start,activity:e,exec:void 0}}function dn(t){var e=H(t)?t:wt(t);return{type:Y.Stop,activity:e,exec:void 0}}function hn(t,e,r){var n=H(t.activity)?t.activity(e,r.data):t.activity,i=typeof n=="string"?{id:n}:n,s={type:Y.Stop,activity:i};return s}var fn=function(t){return{type:ht,assignment:t}};function as(t){return typeof t=="object"&&"type"in t}function pn(t,e){var r=e?"#".concat(e):"";return"".concat(Y.After,"(").concat(t,")").concat(r)}function Ze(t,e){var r="".concat(Y.DoneState,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function et(t,e){var r="".concat(Y.DoneInvoke,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function Be(t,e){var r="".concat(Y.ErrorPlatform,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function cs(t){return{type:Y.Pure,get:t}}function us(t,e){if(!W&&(!t||typeof t=="function")){var r=t;t=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=typeof r=="function"?r.apply(void 0,z([],F(n),!1)):r;if(!s)throw new Error("Attempted to forward event to undefined actor. This risks an infinite loop in the sender.");return s}}return xe(function(n,i){return i},T(T({},e),{to:t}))}function ls(t,e){return tr(function(r,n,i){return{type:Wt,data:H(t)?t(r,n,i):t}},T(T({},e),{to:pe.Parent}))}function ds(t){return{type:Y.Choose,conds:t}}var hs=function(t){var e,r,n=[];try{for(var i=B(t),s=i.next();!s.done;s=i.next())for(var o=s.value,c=0;c<o.length;){if(o[c].type===ht){n.push(o[c]),o.splice(c,1);continue}c++}}catch(a){e={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n};function tt(t,e,r,n,i,s,o){o===void 0&&(o=!1);var c=o?[]:hs(i),a=c.length?en(r,n,c,e):r,u=o?[r]:void 0,l=[];function h(p){var m;switch(p.type){case Re:return on(p);case Ce:var w=an(p,a,n,t.options.delays);return W||ne(!G(p.delay)||typeof w.delay=="number","No delay reference for delay expression '".concat(p.delay,"' was found on machine '").concat(t.id,"'")),s&&w.to!==pe.Internal&&l.push(w),w;case ft:{var E=cn(p,a,n);return s==null||s(E,a,n),E}case Yr:{var x=p,S=(m=x.conds.find(function(ce){var J=tn(ce.cond,t.options.guards);return!J||rn(t,J,a,n,s?void 0:e)}))===null||m===void 0?void 0:m.actions;if(!S)return[];var A=F(tt(t,e,a,n,[Ee(le(S),t.options.actions)],s,o),2),k=A[0],_=A[1];return a=_,u==null||u.push(a),k}case Hr:{var S=p.get(a,n.data);if(!S)return[];var N=F(tt(t,e,a,n,[Ee(le(S),t.options.actions)],s,o),2),C=N[0],P=N[1];return a=P,u==null||u.push(a),C}case dt:{var E=hn(p,a,n);return s==null||s(E,r,n),E}case ht:{a=en(a,n,[p],s?void 0:e),u==null||u.push(a);break}default:var I=Ve(p,t.options.actions),M=I.exec;if(s)s(I,a,n);else if(M&&u){var Z=u.length-1;I=T(T({},I),{exec:function(ce){for(var J=[],ye=1;ye<arguments.length;ye++)J[ye-1]=arguments[ye];M.apply(void 0,z([u[Z]],F(J),!1))}})}return I}}function d(p){var m,w,E=[];try{for(var x=B(p),S=x.next();!S.done;S=x.next()){var A=S.value,k=h(A);k&&(E=E.concat(k))}}catch(_){m={error:_}}finally{try{S&&!S.done&&(w=x.return)&&w.call(x)}finally{if(m)throw m.error}}return l.forEach(function(_){s(_,a,n)}),l.length=0,E}var f=Q(i.map(d));return[f,a]}const fs=Object.freeze(Object.defineProperty({__proto__:null,actionTypes:Gi,after:pn,assign:fn,cancel:un,choose:ds,done:Ze,doneInvoke:et,error:Be,escalate:ls,forwardTo:us,getActionFunction:Tt,initEvent:Pe,isActionObject:as,log:os,pure:cs,raise:sn,resolveActions:tt,resolveLog:cn,resolveRaise:on,resolveSend:an,resolveStop:hn,respond:is,send:xe,sendParent:tr,sendTo:rs,sendUpdate:ns,start:ln,stop:dn,toActionObject:Ve,toActionObjects:Ee,toActivityDefinition:wt},Symbol.toStringTag,{value:"Module"}));var bt=[],Ge=function(t,e){bt.push(t);var r=e(t);return bt.pop(),r},ps=function(t){return t(bt[bt.length-1])};function vn(t){var e;return e={id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}},e[be]=function(){return this},e}function vs(t,e,r,n){var i,s=nn(t.src),o=(i=e==null?void 0:e.options.services)===null||i===void 0?void 0:i[s.type],c=t.data?Et(t.data,r,n):void 0,a=o?rr(o,t.id,c):vn(t.id);return a.meta=t,a}function rr(t,e,r){var n=vn(e);if(n.deferred=!0,ge(t)){var i=n.state=Ge(void 0,function(){return(r?t.withContext(r):t).initialState});n.getSnapshot=function(){return i}}return n}function ms(t){try{return typeof t.send=="function"}catch{return!1}}function ys(t){return ms(t)&&"id"in t}function gs(t){var e;return T((e={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},e[be]=function(){return this},e),t)}var xt=function(t){return t.type==="atomic"||t.type==="final"};function mn(t){return Object.keys(t.states).map(function(e){return t.states[e]})}function rt(t){return mn(t).filter(function(e){return e.type!=="history"})}function yn(t){var e=[t];return xt(t)?e:e.concat(Q(rt(t).map(yn)))}function nt(t,e){var r,n,i,s,o,c,a,u,l=new Set(t),h=nr(l),d=new Set(e);try{for(var f=B(d),p=f.next();!p.done;p=f.next())for(var m=p.value,w=m.parent;w&&!d.has(w);)d.add(w),w=w.parent}catch(P){r={error:P}}finally{try{p&&!p.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}var E=nr(d);try{for(var x=B(d),S=x.next();!S.done;S=x.next()){var m=S.value;if(m.type==="compound"&&(!E.get(m)||!E.get(m).length))h.get(m)?h.get(m).forEach(function(I){return d.add(I)}):m.initialStateNodes.forEach(function(I){return d.add(I)});else if(m.type==="parallel")try{for(var A=(o=void 0,B(rt(m))),k=A.next();!k.done;k=A.next()){var _=k.value;d.has(_)||(d.add(_),h.get(_)?h.get(_).forEach(function(I){return d.add(I)}):_.initialStateNodes.forEach(function(I){return d.add(I)}))}}catch(I){o={error:I}}finally{try{k&&!k.done&&(c=A.return)&&c.call(A)}finally{if(o)throw o.error}}}}catch(P){i={error:P}}finally{try{S&&!S.done&&(s=x.return)&&s.call(x)}finally{if(i)throw i.error}}try{for(var N=B(d),C=N.next();!C.done;C=N.next())for(var m=C.value,w=m.parent;w&&!d.has(w);)d.add(w),w=w.parent}catch(P){a={error:P}}finally{try{C&&!C.done&&(u=N.return)&&u.call(N)}finally{if(a)throw a.error}}return d}function gn(t,e){var r=e.get(t);if(!r)return{};if(t.type==="compound"){var n=r[0];if(n){if(xt(n))return n.key}else return{}}var i={};return r.forEach(function(s){i[s.key]=gn(s,e)}),i}function nr(t){var e,r,n=new Map;try{for(var i=B(t),s=i.next();!s.done;s=i.next()){var o=s.value;n.has(o)||n.set(o,[]),o.parent&&(n.has(o.parent)||n.set(o.parent,[]),n.get(o.parent).push(o))}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}function Es(t,e){var r=nt([t],e);return gn(t,nr(r))}function it(t,e){return Array.isArray(t)?t.some(function(r){return r===e}):t instanceof Set?t.has(e):!1}function Ss(t){return z([],F(new Set(Q(z([],F(t.map(function(e){return e.ownEvents})),!1)))),!1)}function At(t,e){return e.type==="compound"?rt(e).some(function(r){return r.type==="final"&&it(t,r)}):e.type==="parallel"?rt(e).every(function(r){return At(t,r)}):!1}function Ts(t){return t===void 0&&(t=[]),t.reduce(function(e,r){return r.meta!==void 0&&(e[r.id]=r.meta),e},{})}function En(t){return new Set(Q(t.map(function(e){return e.tags})))}function Sn(t,e){if(t===e)return!0;if(t===void 0||e===void 0)return!1;if(G(t)||G(e))return t===e;var r=Object.keys(t),n=Object.keys(e);return r.length===n.length&&r.every(function(i){return Sn(t[i],e[i])})}function ws(t){return typeof t!="object"||t===null?!1:"value"in t&&"_event"in t}function bs(t,e){var r=t.exec,n=T(T({},t),{exec:r!==void 0?function(){return r(e.context,e.event,{action:t,state:e,_event:e._event})}:void 0});return n}var de=function(){function t(e){var r=this,n;this.actions=[],this.activities=Kr,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||Kr,this.meta=Ts(e.configuration),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=(n=Array.isArray(e.tags)?new Set(e.tags):e.tags)!==null&&n!==void 0?n:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return Ss(r.configuration)}})}return t.from=function(e,r){if(e instanceof t)return e.context!==r?new t({value:e.value,context:r,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e;var n=Pe;return new t({value:e,context:r,_event:n,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(e){return new t(e)},t.inert=function(e,r){if(e instanceof t){if(!e.actions.length)return e;var n=Pe;return new t({value:e.value,context:r,_event:n,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return t.from(e,r)},t.prototype.toStrings=function(e,r){var n=this;if(e===void 0&&(e=this.value),r===void 0&&(r="."),G(e))return[e];var i=Object.keys(e);return i.concat.apply(i,z([],F(i.map(function(s){return n.toStrings(e[s],r).map(function(o){return s+r+o})})),!1))},t.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var r=e.tags;e.machine;var n=zt(e,["configuration","transitions","tags","machine"]);return T(T({},n),{tags:Array.from(r)})},t.prototype.matches=function(e){return Xt(e,this.value)},t.prototype.hasTag=function(e){return this.tags.has(e)},t.prototype.can=function(e){var r;W&&ne(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var n=(r=this.machine)===null||r===void 0?void 0:r.getTransitionData(this,e);return!!(n!=null&&n.transitions.length)&&n.transitions.some(function(i){return i.target!==void 0||i.actions.length})},t}(),xs={deferEvents:!1},Tn=function(){function t(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=T(T({},xs),e)}return t.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents){this.schedule(e);return}this.process(e)}this.flushEvents()},t.prototype.schedule=function(e){if(!this.initialized||this.processingEvent){this.queue.push(e);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()},t.prototype.clear=function(){this.queue=[]},t.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},t.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(r){throw this.clear(),r}finally{this.processingEvent=!1}},t}(),ir=new Map,As=0,Ot={bookId:function(){return"x:".concat(As++)},register:function(t,e){return ir.set(t,e),t},get:function(t){return ir.get(t)},free:function(t){ir.delete(t)}};function sr(){if(typeof globalThis!="undefined")return globalThis;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;W||console.warn("XState could not find a global object in this environment. Please let the maintainers know and raise an issue here: https://github.com/statelyai/xstate/issues")}function Os(){var t=sr();if(t&&"__xstate__"in t)return t.__xstate__}function Is(t){if(sr()){var e=Os();e&&e.register(t)}}function ks(t,e){e===void 0&&(e={});var r=t.initialState,n=new Set,i=[],s=!1,o=function(){if(!s){for(s=!0;i.length>0;){var u=i.shift();r=t.transition(r,u,a),n.forEach(function(l){return l.next(r)})}s=!1}},c=gs({id:e.id,send:function(u){i.push(u),o()},getSnapshot:function(){return r},subscribe:function(u,l,h){var d=Xe(u,l,h);return n.add(d),d.next(r),{unsubscribe:function(){n.delete(d)}}}}),a={parent:e.parent,self:c,id:e.id||"anonymous",observers:n};return r=t.start?t.start(a):r,c}var or={sync:!1,autoForward:!1},te;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(te||(te={}));var _s=function(){function t(e,r){r===void 0&&(r=t.defaultOptions);var n=this;this.machine=e,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=te.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(l,h){if(je(l))return n.batch(l),n.state;var d=oe(er(l,h));if(n.status===te.Stopped)return W||ne(!1,'Event "'.concat(d.name,'" was sent to stopped service "').concat(n.machine.id,`". This service has already reached its final state, and will not transition.
Event: `).concat(JSON.stringify(d.data))),n.state;if(n.status!==te.Running&&!n.options.deferEvents)throw new Error('Event "'.concat(d.name,'" was sent to uninitialized service "').concat(n.machine.id,`". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.
Event: `).concat(JSON.stringify(d.data)));return n.scheduler.schedule(function(){n.forward(d);var f=n._nextState(d);n.update(f,d)}),n._state},this.sendTo=function(l,h,d){var f=n.parent&&(h===pe.Parent||n.parent.id===h),p=f?n.parent:G(h)?n.children.get(h)||Ot.get(h):Xi(h)?h:void 0;if(!p){if(!f)throw new Error("Unable to send event to child '".concat(h,"' from service '").concat(n.id,"'."));W||ne(!1,"Service '".concat(n.id,"' has no parent: unable to send event ").concat(l.type));return}if("machine"in p){if(n.status!==te.Stopped||n.parent!==p||n.state.done){var m=T(T({},l),{name:l.name===Wt?"".concat(Be(n.id)):l.name,origin:n.sessionId});!d&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([p,m]):p.send(m)}}else!d&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([p,l.data]):p.send(l.data)},this._exec=function(l,h,d,f){f===void 0&&(f=n.machine.options.actions);var p=l.exec||Tt(l.type,f),m=H(p)?p:p?p.exec:l.exec;if(m)try{return m(h,d.data,n.machine.config.predictableActionArguments?{action:l,_event:d}:{action:l,state:n.state,_event:d})}catch(Z){throw n.parent&&n.parent.send({type:"xstate.error",data:Z}),Z}switch(l.type){case Ce:var w=l;if(typeof w.delay=="number"){n.defer(w);return}else w.to?n.sendTo(w._event,w.to,d===Pe):n.send(w._event);break;case Kt:n.cancel(l.sendId);break;case lt:{if(n.status!==te.Running)return;var E=l.activity;if(!n.machine.config.predictableActionArguments&&!n.state.activities[E.id||E.type])break;if(E.type===Y.Invoke){var x=nn(E.src),S=n.machine.options.services?n.machine.options.services[x.type]:void 0,A=E.id,k=E.data;W||ne(!("forward"in E),"`forward` property is deprecated (found in invocation of '".concat(E.src,"' in in machine '").concat(n.machine.id,"'). ")+"Please use `autoForward` instead.");var _="autoForward"in E?E.autoForward:!!E.forward;if(!S){W||ne(!1,"No service found for invocation '".concat(E.src,"' in machine '").concat(n.machine.id,"'."));return}var N=k?Et(k,h,d):void 0;if(typeof S=="string")return;var C=H(S)?S(h,d.data,{data:N,src:x,meta:E.meta}):S;if(!C)return;var P=void 0;ge(C)&&(C=N?C.withContext(N):C,P={autoForward:_}),n.spawn(C,A,P)}else n.spawnActivity(E);break}case dt:{n.stopChild(l.activity.id);break}case ft:var I=l.label,M=l.value;I?n.logger(I,M):n.logger(M);break;default:W||ne(!1,"No implementation found for action type '".concat(l.type,"'"));break}};var i=T(T({},t.defaultOptions),r),s=i.clock,o=i.logger,c=i.parent,a=i.id,u=a!==void 0?a:e.id;this.id=u,this.logger=o,this.clock=s,this.parent=c,this.options=i,this.scheduler=new Tn({deferEvents:this.options.deferEvents}),this.sessionId=Ot.bookId()}return Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:Ge(this,function(){return e._initialState=e.machine.initialState,e._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return W||ne(this.status!==te.NotStarted,"Attempted to read state from uninitialized service '".concat(this.id,"'. Make sure the service is started first.")),this._state},enumerable:!1,configurable:!0}),t.prototype.execute=function(e,r){var n,i;try{for(var s=B(e.actions),o=s.next();!o.done;o=s.next()){var c=o.value;this.exec(c,e,r)}}catch(a){n={error:a}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}},t.prototype.update=function(e,r){var n,i,s,o,c,a,u,l,h=this;if(e._sessionid=this.sessionId,this._state=e,(!this.machine.config.predictableActionArguments||r===Pe)&&this.options.execute)this.execute(this.state);else for(var d=void 0;d=this._outgoingQueue.shift();)d[0].send(d[1]);if(this.children.forEach(function(P){h.state.children[P.id]=P}),this.devTools&&this.devTools.send(r.data,e),e.event)try{for(var f=B(this.eventListeners),p=f.next();!p.done;p=f.next()){var m=p.value;m(e.event)}}catch(P){n={error:P}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}try{for(var w=B(this.listeners),E=w.next();!E.done;E=w.next()){var m=E.value;m(e,e.event)}}catch(P){s={error:P}}finally{try{E&&!E.done&&(o=w.return)&&o.call(w)}finally{if(s)throw s.error}}try{for(var x=B(this.contextListeners),S=x.next();!S.done;S=x.next()){var A=S.value;A(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(P){c={error:P}}finally{try{S&&!S.done&&(a=x.return)&&a.call(x)}finally{if(c)throw c.error}}if(this.state.done){var k=e.configuration.find(function(P){return P.type==="final"&&P.parent===h.machine}),_=k&&k.doneData?Et(k.doneData,e.context,r):void 0;try{for(var N=B(this.doneListeners),C=N.next();!C.done;C=N.next()){var m=C.value;m(et(this.id,_))}}catch(P){u={error:P}}finally{try{C&&!C.done&&(l=N.return)&&l.call(N)}finally{if(u)throw u.error}}this._stop(),this._stopChildren()}},t.prototype.onTransition=function(e){return this.listeners.add(e),this.status===te.Running&&e(this.state,this.state.event),this},t.prototype.subscribe=function(e,r,n){var i=this,s=Xe(e,r,n);this.listeners.add(s.next),this.status!==te.NotStarted&&s.next(this.state);var o=function(){i.doneListeners.delete(o),i.stopListeners.delete(o),s.complete()};return this.status===te.Stopped?s.complete():(this.onDone(o),this.onStop(o)),{unsubscribe:function(){i.listeners.delete(s.next),i.doneListeners.delete(o),i.stopListeners.delete(o)}}},t.prototype.onEvent=function(e){return this.eventListeners.add(e),this},t.prototype.onSend=function(e){return this.sendListeners.add(e),this},t.prototype.onChange=function(e){return this.contextListeners.add(e),this},t.prototype.onStop=function(e){return this.stopListeners.add(e),this},t.prototype.onDone=function(e){return this.doneListeners.add(e),this},t.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},t.prototype.start=function(e){var r=this;if(this.status===te.Running)return this;this.machine._init(),Ot.register(this.sessionId,this),this.initialized=!0,this.status=te.Running;var n=e===void 0?this.initialState:Ge(this,function(){return ws(e)?r.machine.resolveState(e):r.machine.resolveState(de.from(e,r.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){r.update(n,Pe)}),this},t.prototype._stopChildren=function(){this.children.forEach(function(e){H(e.stop)&&e.stop()}),this.children.clear()},t.prototype._stop=function(){var e,r,n,i,s,o,c,a,u,l;try{for(var h=B(this.listeners),d=h.next();!d.done;d=h.next()){var f=d.value;this.listeners.delete(f)}}catch(N){e={error:N}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(e)throw e.error}}try{for(var p=B(this.stopListeners),m=p.next();!m.done;m=p.next()){var f=m.value;f(),this.stopListeners.delete(f)}}catch(N){n={error:N}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}try{for(var w=B(this.contextListeners),E=w.next();!E.done;E=w.next()){var f=E.value;this.contextListeners.delete(f)}}catch(N){s={error:N}}finally{try{E&&!E.done&&(o=w.return)&&o.call(w)}finally{if(s)throw s.error}}try{for(var x=B(this.doneListeners),S=x.next();!S.done;S=x.next()){var f=S.value;this.doneListeners.delete(f)}}catch(N){c={error:N}}finally{try{S&&!S.done&&(a=x.return)&&a.call(x)}finally{if(c)throw c.error}}if(!this.initialized)return this;this.initialized=!1,this.status=te.Stopped,this._initialState=void 0;try{for(var A=B(Object.keys(this.delayedEventsMap)),k=A.next();!k.done;k=A.next()){var _=k.value;this.clock.clearTimeout(this.delayedEventsMap[_])}}catch(N){u={error:N}}finally{try{k&&!k.done&&(l=A.return)&&l.call(A)}finally{if(u)throw u.error}}this.scheduler.clear(),this.scheduler=new Tn({deferEvents:this.options.deferEvents})},t.prototype.stop=function(){var e=this,r=this.scheduler;return this._stop(),r.schedule(function(){var n=oe({type:"xstate.stop"}),i=Ge(e,function(){var s=Q(z([],F(e.state.configuration),!1).sort(function(l,h){return h.order-l.order}).map(function(l){return Ee(l.onExit,e.machine.options.actions)})),o=F(tt(e.machine,e.state,e.state.context,n,[s],e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),c=o[0],a=o[1],u=new de({value:e.state.value,context:a,_event:n,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:c.filter(function(l){return l.type!==Re&&(l.type!==Ce||!!l.to&&l.to!==pe.Internal)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return u.changed=!0,u});e.update(i,n),e._stopChildren(),Ot.free(e.sessionId)}),this},t.prototype.batch=function(e){var r=this;if(this.status===te.NotStarted&&this.options.deferEvents)W||ne(!1,"".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,`" and are deferred. Make sure .start() is called for this service.
Event: `).concat(JSON.stringify(event)));else if(this.status!==te.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));if(e.length){var n=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var i,s,o=r.state,c=!1,a=[],u=function(f){var p=oe(f);r.forward(p),o=Ge(r,function(){return r.machine.transition(o,p,void 0,n||void 0)}),a.push.apply(a,z([],F(r.machine.config.predictableActionArguments?o.actions:o.actions.map(function(m){return bs(m,o)})),!1)),c=c||!!o.changed};try{for(var l=B(e),h=l.next();!h.done;h=l.next()){var d=h.value;u(d)}}catch(f){i={error:f}}finally{try{h&&!h.done&&(s=l.return)&&s.call(l)}finally{if(i)throw i.error}}o.changed=c,o.actions=a,r.update(o,oe(e[e.length-1]))})}},t.prototype.sender=function(e){return this.send.bind(this,e)},t.prototype._nextState=function(e,r){var n=this;r===void 0&&(r=!!this.machine.config.predictableActionArguments&&this._exec);var i=oe(e);if(i.name.indexOf(Jt)===0&&!this.state.nextEvents.some(function(o){return o.indexOf(Jt)===0}))throw i.data.data;var s=Ge(this,function(){return n.machine.transition(n.state,i,void 0,r||void 0)});return s},t.prototype.nextState=function(e){return this._nextState(e,!1)},t.prototype.forward=function(e){var r,n;try{for(var i=B(this.forwardTo),s=i.next();!s.done;s=i.next()){var o=s.value,c=this.children.get(o);if(!c)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));c.send(e)}}catch(a){r={error:a}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t.prototype.defer=function(e){var r=this;this.delayedEventsMap[e.id]=this.clock.setTimeout(function(){e.to?r.sendTo(e._event,e.to,!0):r.send(e._event)},e.delay)},t.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},t.prototype.exec=function(e,r,n){n===void 0&&(n=this.machine.options.actions),this._exec(e,r.context,r._event,n)},t.prototype.removeChild=function(e){var r;this.children.delete(e),this.forwardTo.delete(e),(r=this.state)===null||r===void 0||delete r.children[e]},t.prototype.stopChild=function(e){var r=this.children.get(e);r&&(this.removeChild(e),H(r.stop)&&r.stop())},t.prototype.spawn=function(e,r,n){if(this.status!==te.Running)return rr(e,r);if(Xr(e))return this.spawnPromise(Promise.resolve(e),r);if(H(e))return this.spawnCallback(e,r);if(ys(e))return this.spawnActor(e,r);if(Qi(e))return this.spawnObservable(e,r);if(ge(e))return this.spawnMachine(e,T(T({},n),{id:r}));if(Ki(e))return this.spawnBehavior(e,r);throw new Error('Unable to spawn entity "'.concat(r,'" of type "').concat(typeof e,'".'))},t.prototype.spawnMachine=function(e,r){var n=this;r===void 0&&(r={});var i=new t(e,T(T({},this.options),{parent:this,id:r.id||e.id})),s=T(T({},or),r);s.sync&&i.onTransition(function(c){n.send(vt,{state:c,id:i.id})});var o=i;return this.children.set(i.id,o),s.autoForward&&this.forwardTo.add(i.id),i.onDone(function(c){n.removeChild(i.id),n.send(oe(c,{origin:i.id}))}).start(),o},t.prototype.spawnBehavior=function(e,r){var n=ks(e,{id:r,parent:this});return this.children.set(r,n),n},t.prototype.spawnPromise=function(e,r){var n,i=this,s=!1,o;e.then(function(a){s||(o=a,i.removeChild(r),i.send(oe(et(r,a),{origin:r})))},function(a){if(!s){i.removeChild(r);var u=Be(r,a);try{i.send(oe(u,{origin:r}))}catch(l){ts(a,l,r),i.devTools&&i.devTools.send(u,i.state),i.machine.strict&&i.stop()}}});var c=(n={id:r,send:function(){},subscribe:function(a,u,l){var h=Xe(a,u,l),d=!1;return e.then(function(f){d||(h.next(f),!d&&h.complete())},function(f){d||h.error(f)}),{unsubscribe:function(){return d=!0}}},stop:function(){s=!0},toJSON:function(){return{id:r}},getSnapshot:function(){return o}},n[be]=function(){return this},n);return this.children.set(r,c),c},t.prototype.spawnCallback=function(e,r){var n,i=this,s=!1,o=new Set,c=new Set,a,u=function(d){a=d,c.forEach(function(f){return f(d)}),!s&&i.send(oe(d,{origin:r}))},l;try{l=e(u,function(d){o.add(d)})}catch(d){this.send(Be(r,d))}if(Xr(l))return this.spawnPromise(l,r);var h=(n={id:r,send:function(d){return o.forEach(function(f){return f(d)})},subscribe:function(d){var f=Xe(d);return c.add(f.next),{unsubscribe:function(){c.delete(f.next)}}},stop:function(){s=!0,H(l)&&l()},toJSON:function(){return{id:r}},getSnapshot:function(){return a}},n[be]=function(){return this},n);return this.children.set(r,h),h},t.prototype.spawnObservable=function(e,r){var n,i=this,s,o=e.subscribe(function(a){s=a,i.send(oe(a,{origin:r}))},function(a){i.removeChild(r),i.send(oe(Be(r,a),{origin:r}))},function(){i.removeChild(r),i.send(oe(et(r),{origin:r}))}),c=(n={id:r,send:function(){},subscribe:function(a,u,l){return e.subscribe(a,u,l)},stop:function(){return o.unsubscribe()},getSnapshot:function(){return s},toJSON:function(){return{id:r}}},n[be]=function(){return this},n);return this.children.set(r,c),c},t.prototype.spawnActor=function(e,r){return this.children.set(r,e),e},t.prototype.spawnActivity=function(e){var r=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(!r){W||ne(!1,"No implementation found for activity '".concat(e.type,"'"));return}var n=r(this.state.context,e);this.spawnEffect(e.id,n)},t.prototype.spawnEffect=function(e,r){var n;this.children.set(e,(n={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:r||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}},n[be]=function(){return this},n))},t.prototype.attachDev=function(){var e=sr();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var r=typeof this.options.devTools=="object"?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(T(T({name:this.id,autoPause:!0,stateSanitizer:function(n){return{value:n.value,context:n.context,actions:n.actions}}},r),{features:T({jump:!1,skip:!1},r?r.features:void 0)}),this.machine),this.devTools.init(this.state)}Is(this)}},t.prototype.toJSON=function(){return{id:this.id}},t.prototype[be]=function(){return this},t.prototype.getSnapshot=function(){return this.status===te.NotStarted?this.initialState:this._state},t.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,r){return setTimeout(e,r)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},t.interpret=Le,t}(),Ns=function(t){return G(t)?T(T({},or),{name:t}):T(T(T({},or),{name:Zi()}),t)};function Ds(t,e){var r=Ns(e);return ps(function(n){if(!W){var i=ge(t)||H(t);ne(!!n||i,'Attempted to spawn an Actor (ID: "'.concat(ge(t)?t.id:"undefined",'") outside of a service. This will have no effect.'))}return n?n.spawn(t,r.name,r):rr(t,r.name)})}function Le(t,e){var r=new _s(t,e);return r}function Rs(t){if(typeof t=="string"){var e={type:t};return e.toString=function(){return t},e}return t}function It(t){return T(T({type:pt},t),{toJSON:function(){t.onDone,t.onError;var e=zt(t,["onDone","onError"]);return T(T({},e),{type:pt,src:Rs(t.src)})}})}var $e="",ar="#",st="*",qe={},Ye=function(t){return t[0]===ar},Cs=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},Ps=function(t,e,r){var n=r.slice(0,-1).some(function(s){return!("cond"in s)&&!("in"in s)&&(G(s.target)||ge(s.target))}),i=e===$e?"the transient event":"event '".concat(e,"'");ne(!n,"One or more transitions for ".concat(i," on state '").concat(t.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")},Ls=function(){function t(e,r,n,i){n===void 0&&(n="context"in e?e.context:void 0);var s=this,o;this.config=e,this._context=n,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(Cs(),r),this.parent=i==null?void 0:i.parent,this.key=this.config.key||(i==null?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:zr),this.id=this.config.id||z([this.machine.key],F(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(o=this.config.schema)!==null&&o!==void 0?o:{},this.description=this.config.description,W||ne(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '.concat(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '".concat(this.type,"'`")," in the config for state node '").concat(this.id,"' instead.")),this.initial=this.config.initial,this.states=this.config.states?Qe(this.config.states,function(u,l){var h,d=new t(u,{},void 0,{parent:s,key:l});return Object.assign(s.idMap,T((h={},h[d.id]=d,h),d.idMap)),d}):qe;var c=0;function a(u){var l,h;u.order=c++;try{for(var d=B(mn(u)),f=d.next();!f.done;f=d.next()){var p=f.value;a(p)}}catch(m){l={error:m}}finally{try{f&&!f.done&&(h=d.return)&&h.call(d)}finally{if(l)throw l.error}}}a(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(u){var l=u.event;return l===$e}):$e in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=le(this.config.entry||this.config.onEntry).map(function(u){return Ve(u)}),this.onExit=le(this.config.exit||this.config.onExit).map(function(u){return Ve(u)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=le(this.config.invoke).map(function(u,l){var h,d;if(ge(u)){var f=St(s.id,l);return s.machine.options.services=T((h={},h[f]=u,h),s.machine.options.services),It({src:f,id:f})}else if(G(u.src)){var f=u.id||St(s.id,l);return It(T(T({},u),{id:f,src:u.src}))}else if(ge(u.src)||H(u.src)){var f=u.id||St(s.id,l);return s.machine.options.services=T((d={},d[f]=u.src,d),s.machine.options.services),It(T(T({id:f},u),{src:f}))}else{var p=u.src;return It(T(T({id:St(s.id,l)},u),{src:p}))}}),this.activities=le(this.config.activities).concat(this.invoke).map(function(u){return wt(u)}),this.transition=this.transition.bind(this),this.tags=le(this.config.tags)}return t.prototype._init=function(){this.__cache.transitions||yn(this).forEach(function(e){return e.on})},t.prototype.withConfig=function(e,r){var n=this.options,i=n.actions,s=n.activities,o=n.guards,c=n.services,a=n.delays;return new t(this.config,{actions:T(T({},i),e.actions),activities:T(T({},s),e.activities),guards:T(T({},o),e.guards),services:T(T({},c),e.services),delays:T(T({},a),e.delays)},r!=null?r:this.context)},t.prototype.withContext=function(e){return new t(this.config,this.options,e)},Object.defineProperty(t.prototype,"context",{get:function(){return H(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:Qe(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return this.definition},Object.defineProperty(t.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(r,n){return r[n.eventType]=r[n.eventType]||[],r[n.eventType].push(n),r},{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),t.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var r=e===$e,n=this.transitions.filter(function(i){var s=i.eventType===e;return r?s:s||i.eventType===st});return this.__cache.candidates[e]=n,n},t.prototype.getDelayedTransitions=function(){var e=this,r=this.config.after;if(!r)return[];var n=function(s,o){var c=H(s)?"".concat(e.id,":delay[").concat(o,"]"):s,a=pn(c,e.id);return e.onEntry.push(xe(a,{delay:s})),e.onExit.push(un(a)),a},i=je(r)?r.map(function(s,o){var c=n(s.delay,o);return T(T({},s),{event:c})}):Q(Object.keys(r).map(function(s,o){var c=r[s],a=G(c)?{target:c}:c,u=isNaN(+s)?s:+s,l=n(u,o);return le(a).map(function(h){return T(T({},h),{event:l,delay:u})})}));return i.map(function(s){var o=s.delay;return T(T({},e.formatTransition(s)),{delay:o})})},t.prototype.getStateNodes=function(e){var r,n=this;if(!e)return[];var i=e instanceof de?e.value:We(e,this.delimiter);if(G(i)){var s=this.getStateNode(i).initial;return s!==void 0?this.getStateNodes((r={},r[i]=s,r)):[this,this.states[i]]}var o=Object.keys(i),c=[this];return c.push.apply(c,z([],F(Q(o.map(function(a){return n.getStateNode(a).getStateNodes(i[a])}))),!1)),c},t.prototype.handles=function(e){var r=Jr(e);return this.events.includes(r)},t.prototype.resolveState=function(e){var r=e instanceof de?e:de.create(e),n=Array.from(nt([],this.getStateNodes(r.value)));return new de(T(T({},r),{value:this.resolve(r.value),configuration:n,done:At(n,this),tags:En(n),machine:this.machine}))},t.prototype.transitionLeafNode=function(e,r,n){var i=this.getStateNode(e),s=i.next(r,n);return!s||!s.transitions.length?this.next(r,n):s},t.prototype.transitionCompoundNode=function(e,r,n){var i=Object.keys(e),s=this.getStateNode(i[0]),o=s._transition(e[i[0]],r,n);return!o||!o.transitions.length?this.next(r,n):o},t.prototype.transitionParallelNode=function(e,r,n){var i,s,o={};try{for(var c=B(Object.keys(e)),a=c.next();!a.done;a=c.next()){var u=a.value,l=e[u];if(l){var h=this.getStateNode(u),d=h._transition(l,r,n);d&&(o[u]=d)}}}catch(x){i={error:x}}finally{try{a&&!a.done&&(s=c.return)&&s.call(c)}finally{if(i)throw i.error}}var f=Object.keys(o).map(function(x){return o[x]}),p=Q(f.map(function(x){return x.transitions})),m=f.some(function(x){return x.transitions.length>0});if(!m)return this.next(r,n);var w=Q(f.map(function(x){return x.entrySet})),E=Q(Object.keys(o).map(function(x){return o[x].configuration}));return{transitions:p,entrySet:w,exitSet:Q(f.map(function(x){return x.exitSet})),configuration:E,source:r,actions:Q(Object.keys(o).map(function(x){return o[x].actions}))}},t.prototype._transition=function(e,r,n){return G(e)?this.transitionLeafNode(e,r,n):Object.keys(e).length===1?this.transitionCompoundNode(e,r,n):this.transitionParallelNode(e,r,n)},t.prototype.getTransitionData=function(e,r){return this._transition(e.value,e,oe(r))},t.prototype.next=function(e,r){var n,i,s=this,o=r.name,c=[],a=[],u;try{for(var l=B(this.getCandidates(o)),h=l.next();!h.done;h=l.next()){var d=h.value,f=d.cond,p=d.in,m=e.context,w=p?G(p)&&Ye(p)?e.matches(We(this.getStateNodeById(p).path,this.delimiter)):Xt(We(p,this.delimiter),Yi(this.path.slice(0,-2))(e.value)):!0,E=!1;try{E=!f||rn(this.machine,f,m,r,e)}catch(k){throw new Error("Unable to evaluate guard '".concat(f.name||f.type,"' in transition for event '").concat(o,"' in state node '").concat(this.id,`':
`).concat(k.message))}if(E&&w){d.target!==void 0&&(a=d.target),c.push.apply(c,z([],F(d.actions),!1)),u=d;break}}}catch(k){n={error:k}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}if(u){if(!a.length)return{transitions:[u],entrySet:[],exitSet:[],configuration:e.value?[this]:[],source:e,actions:c};var x=Q(a.map(function(k){return s.getRelativeStateNodes(k,e.historyValue)})),S=!!u.internal,A=[];return S||a.forEach(function(k){A.push.apply(A,z([],F(s.getExternalReentryNodes(k)),!1))}),{transitions:[u],entrySet:A,exitSet:S?[]:[this],configuration:x,source:e,actions:c}}},t.prototype.getExternalReentryNodes=function(e){for(var r=[],n=F(e.order>this.order?[e,this]:[this,e],2),i=n[0],s=n[1];i&&i!==s;)r.push(i),i=i.parent;return i!==s?[]:(r.push(s),r)},t.prototype.getActions=function(e,r,n,i,s,o,c){var a,u,l,h,d=this,f=nt([],o?this.getStateNodes(o.value):[this]);try{for(var p=B(e),m=p.next();!m.done;m=p.next()){var w=m.value;(!it(f,w)||it(n.entrySet,w.parent))&&n.entrySet.push(w)}}catch(I){a={error:I}}finally{try{m&&!m.done&&(u=p.return)&&u.call(p)}finally{if(a)throw a.error}}try{for(var E=B(f),x=E.next();!x.done;x=E.next()){var w=x.value;(!it(e,w)||it(n.exitSet,w.parent))&&n.exitSet.push(w)}}catch(I){l={error:I}}finally{try{x&&!x.done&&(h=E.return)&&h.call(E)}finally{if(l)throw l.error}}var S=Q(n.entrySet.map(function(I){var M=[];if(I.type!=="final")return M;var Z=I.parent;if(!Z.parent)return M;M.push(Ze(I.id,I.doneData),Ze(Z.id,I.doneData?Et(I.doneData,i,s):void 0));var ce=Z.parent;return ce.type==="parallel"&&rt(ce).every(function(J){return At(n.configuration,J)})&&M.push(Ze(ce.id)),M}));n.exitSet.sort(function(I,M){return M.order-I.order}),n.entrySet.sort(function(I,M){return I.order-M.order});var A=new Set(n.entrySet),k=new Set(n.exitSet),_=Array.from(A).map(function(I){var M=I.onEntry,Z=I.activities.map(function(ce){return ln(ce)});return Ee(c?z(z([],F(M),!1),F(Z),!1):z(z([],F(Z),!1),F(M),!1),d.machine.options.actions)}).concat([S.map(sn)]),N=Array.from(k).map(function(I){return Ee(z(z([],F(I.onExit),!1),F(I.activities.map(function(M){return dn(M)})),!1),d.machine.options.actions)}),C=N.concat([Ee(n.actions,this.machine.options.actions)]).concat(_);if(r){var P=Ee(Q(z([],F(e),!1).sort(function(I,M){return M.order-I.order}).map(function(I){return I.onExit})),this.machine.options.actions).filter(function(I){return I.type!==Re&&(I.type!==Ce||!!I.to&&I.to!==pe.Internal)});return C.concat([P])}return C},t.prototype.transition=function(e,r,n,i){e===void 0&&(e=this.initialState);var s=oe(r),o;if(e instanceof de)o=n===void 0?e:this.resolveState(de.from(e,n));else{var c=G(e)?this.resolve(yt(this.getResolvedPath(e))):this.resolve(e),a=n!=null?n:this.machine.context;o=this.resolveState(de.from(c,a))}if(!W&&s.name===st)throw new Error("An event cannot have the wildcard type ('".concat(st,"')"));if(this.strict&&!this.events.includes(s.name)&&!zi(s.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(s.name,"'"));var u=this._transition(o.value,o,s)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:o,actions:[]},l=nt([],this.getStateNodes(o.value)),h=u.configuration.length?nt(l,u.configuration):l;return u.configuration=z([],F(h),!1),this.resolveTransition(u,o,o.context,i,s)},t.prototype.resolveRaisedTransition=function(e,r,n,i){var s,o=e.actions;return e=this.transition(e,r,void 0,i),e._event=n,e.event=n.data,(s=e.actions).unshift.apply(s,z([],F(o),!1)),e},t.prototype.resolveTransition=function(e,r,n,i,s){var o,c,a,u,l=this;s===void 0&&(s=Pe);var h=e.configuration,d=!r||e.transitions.length>0,f=d?e.configuration:r?r.configuration:[],p=At(f,this),m=d?Es(this.machine,h):void 0,w=r?r.historyValue?r.historyValue:e.source?this.machine.historyValue(r.value):void 0:void 0,E=this.getActions(new Set(f),p,e,n,s,r,i),x=r?T({},r.activities):{};try{for(var S=B(E),A=S.next();!A.done;A=S.next()){var k=A.value;try{for(var _=(a=void 0,B(k)),N=_.next();!N.done;N=_.next()){var C=N.value;C.type===lt?x[C.activity.id||C.activity.type]=C:C.type===dt&&(x[C.activity.id||C.activity.type]=!1)}}catch(ue){a={error:ue}}finally{try{N&&!N.done&&(u=_.return)&&u.call(_)}finally{if(a)throw a.error}}}}catch(ue){o={error:ue}}finally{try{A&&!A.done&&(c=S.return)&&c.call(S)}finally{if(o)throw o.error}}var P=F(tt(this,r,n,s,E,i,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),I=P[0],M=P[1],Z=F(Ji(I,function(ue){return ue.type===Re||ue.type===Ce&&ue.to===pe.Internal}),2),ce=Z[0],J=Z[1],ye=I.filter(function(ue){var re;return ue.type===lt&&((re=ue.activity)===null||re===void 0?void 0:re.type)===pt}),we=ye.reduce(function(ue,re){return ue[re.activity.id]=vs(re.activity,l.machine,M,s),ue},r?T({},r.children):{}),v=new de({value:m||r.value,context:M,_event:s,_sessionid:r?r._sessionid:null,historyValue:m?w?Wi(w,m):void 0:r?r.historyValue:void 0,history:!m||e.source?r:void 0,actions:m?J:[],activities:m?x:r?r.activities:{},events:[],configuration:f,transitions:e.transitions,children:we,done:p,tags:En(f),machine:this}),b=n!==M;v.changed=s.name===vt||b;var L=v.history;L&&delete L.history;var K=!p&&(this._transient||h.some(function(ue){return ue._transient}));if(!d&&(!K||s.name===$e))return v;var $=v;if(!p)for(K&&($=this.resolveRaisedTransition($,{type:$r},s,i));ce.length;){var q=ce.shift();$=this.resolveRaisedTransition($,q._event,s,i)}var Je=$.changed||(L?!!$.actions.length||b||typeof L.value!=typeof $.value||!Sn($.value,L.value):void 0);return $.changed=Je,$.history=L,$},t.prototype.getStateNode=function(e){if(Ye(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var r=this.states[e];if(!r)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return r},t.prototype.getStateNodeById=function(e){var r=Ye(e)?e.slice(ar.length):e;if(r===this.id)return this;var n=this.machine.idMap[r];if(!n)throw new Error("Child state node '#".concat(r,"' does not exist on machine '").concat(this.id,"'"));return n},t.prototype.getStateNodeByPath=function(e){if(typeof e=="string"&&Ye(e))try{return this.getStateNodeById(e.slice(1))}catch{}for(var r=Zt(e,this.delimiter).slice(),n=this;r.length;){var i=r.shift();if(!i.length)break;n=n.getStateNode(i)}return n},t.prototype.resolve=function(e){var r,n=this;if(!e)return this.initialStateValue||qe;switch(this.type){case"parallel":return Qe(this.initialStateValue,function(s,o){return s?n.getStateNode(o).resolve(e[o]||s):qe});case"compound":if(G(e)){var i=this.getStateNode(e);return i.type==="parallel"||i.type==="compound"?(r={},r[e]=i.initialStateValue,r):e}return Object.keys(e).length?Qe(e,function(s,o){return s?n.getStateNode(o).resolve(s):qe}):this.initialStateValue||{};default:return e||qe}},t.prototype.getResolvedPath=function(e){if(Ye(e)){var r=this.machine.idMap[e.slice(ar.length)];if(!r)throw new Error("Unable to find state node '".concat(e,"'"));return r.path}return Zt(e,this.delimiter)},Object.defineProperty(t.prototype,"initialStateValue",{get:function(){var e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var r;if(this.type==="parallel")r=Wr(this.states,function(n){return n.initialStateValue||qe},function(n){return n.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));r=xt(this.states[this.initial])?this.initial:(e={},e[this.initial]=this.states[this.initial].initialStateValue,e)}else r={};return this.__cache.initialStateValue=r,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),t.prototype.getInitialState=function(e,r){this._init();var n=this.getStateNodes(e);return this.resolveTransition({configuration:n,entrySet:z([],F(n),!1),exitSet:[],transitions:[],source:void 0,actions:[]},void 0,r!=null?r:this.machine.context,void 0)},Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var e;if(this.type==="history"){var r=this.config;G(r.target)?e=Ye(r.target)?yt(this.machine.getStateNodeById(r.target).path.slice(this.path.length-1)):r.target:e=r.target}return e},enumerable:!1,configurable:!0}),t.prototype.getRelativeStateNodes=function(e,r,n){return n===void 0&&(n=!0),n?e.type==="history"?e.resolveHistory(r):e.initialStateNodes:[e]},Object.defineProperty(t.prototype,"initialStateNodes",{get:function(){var e=this;if(xt(this))return[this];if(this.type==="compound"&&!this.initial)return W||ne(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this];var r=gt(this.initialStateValue);return Q(r.map(function(n){return e.getFromRelativePath(n)}))},enumerable:!1,configurable:!0}),t.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var r=F(e),n=r[0],i=r.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var s=this.getStateNode(n);if(s.type==="history")return s.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(i)},t.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:Wr(this.states,function(r,n){if(!e)return r.historyValue();var i=G(e)?void 0:e[n];return r.historyValue(i||r.initialStateValue)},function(r){return!r.history})}},t.prototype.resolveHistory=function(e){var r=this;if(this.type!=="history")return[this];var n=this.parent;if(!e){var i=this.target;return i?Q(gt(i).map(function(o){return n.getFromRelativePath(o)})):n.initialStateNodes}var s=Hi(n.path,"states")(e).current;return G(s)?[n.getStateNode(s)]:Q(gt(s).map(function(o){return r.history==="deep"?n.getFromRelativePath(o):[n.states[o[0]]]}))},Object.defineProperty(t.prototype,"stateIds",{get:function(){var e=this,r=Q(Object.keys(this.states).map(function(n){return e.states[n].stateIds}));return[this.id].concat(r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var e,r,n,i;if(this.__cache.events)return this.__cache.events;var s=this.states,o=new Set(this.ownEvents);if(s)try{for(var c=B(Object.keys(s)),a=c.next();!a.done;a=c.next()){var u=a.value,l=s[u];if(l.states)try{for(var h=(n=void 0,B(l.events)),d=h.next();!d.done;d=h.next()){var f=d.value;o.add("".concat(f))}}catch(p){n={error:p}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}}catch(p){e={error:p}}finally{try{a&&!a.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter(function(r){return!(!r.target&&!r.actions.length&&r.internal)}).map(function(r){return r.eventType}));return Array.from(e)},enumerable:!1,configurable:!0}),t.prototype.resolveTarget=function(e){var r=this;if(e!==void 0)return e.map(function(n){if(!G(n))return n;var i=n[0]===r.delimiter;if(i&&!r.parent)return r.getStateNodeByPath(n.slice(1));var s=i?r.key+n:n;if(r.parent)try{var o=r.parent.getStateNodeByPath(s);return o}catch(c){throw new Error("Invalid transition definition for state node '".concat(r.id,`':
`).concat(c.message))}else return r.getStateNodeByPath(s)})},t.prototype.formatTransition=function(e){var r=this,n=es(e.target),i="internal"in e?e.internal:n?n.some(function(a){return G(a)&&a[0]===r.delimiter}):!0,s=this.machine.options.guards,o=this.resolveTarget(n),c=T(T({},e),{actions:Ee(le(e.actions)),cond:tn(e.cond,s),target:o,source:this,internal:i,eventType:e.event,toJSON:function(){return T(T({},c),{target:c.target?c.target.map(function(a){return"#".concat(a.id)}):void 0,source:"#".concat(r.id)})}});return c},t.prototype.formatTransitions=function(){var e,r,n=this,i;if(!this.config.on)i=[];else if(Array.isArray(this.config.on))i=this.config.on;else{var s=this.config.on,o=st,c=s[o],a=c===void 0?[]:c,u=zt(s,[typeof o=="symbol"?o:o+""]);i=Q(Object.keys(u).map(function(x){!W&&x===$e&&ne(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(n.id,'".'));var S=Fe(x,u[x]);return W||Ps(n,x,S),S}).concat(Fe(st,a)))}var l=this.config.always?Fe("",this.config.always):[],h=this.config.onDone?Fe(String(Ze(this.id)),this.config.onDone):[];W||ne(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var d=Q(this.invoke.map(function(x){var S=[];return x.onDone&&S.push.apply(S,z([],F(Fe(String(et(x.id)),x.onDone)),!1)),x.onError&&S.push.apply(S,z([],F(Fe(String(Be(x.id)),x.onError)),!1)),S})),f=this.after,p=Q(z(z(z(z([],F(h),!1),F(d),!1),F(i),!1),F(l),!1).map(function(x){return le(x).map(function(S){return n.formatTransition(S)})}));try{for(var m=B(f),w=m.next();!w.done;w=m.next()){var E=w.value;p.push(E)}}catch(x){e={error:x}}finally{try{w&&!w.done&&(r=m.return)&&r.call(m)}finally{if(e)throw e.error}}return p},t}(),wn=!1;function Ae(t,e){return!W&&!t.predictableActionArguments&&!wn&&(wn=!0,console.warn("It is highly recommended to set `predictableActionArguments` to `true` when using `createMachine`. https://xstate.js.org/docs/guides/actions.html")),new Ls(t,e)}var j=fn,ie=xe;/*! js-cookie v3.0.1 | MIT */function kt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}var Us={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function cr(t,e){function r(i,s,o){if(typeof document!="undefined"){o=kt({},e,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var a in o)o[a]&&(c+="; "+a,o[a]!==!0&&(c+="="+o[a].split(";")[0]));return document.cookie=i+"="+t.write(s,i)+c}}function n(i){if(!(typeof document=="undefined"||arguments.length&&!i)){for(var s=document.cookie?document.cookie.split("; "):[],o={},c=0;c<s.length;c++){var a=s[c].split("="),u=a.slice(1).join("=");try{var l=decodeURIComponent(a[0]);if(o[l]=t.read(u,l),i===l)break}catch{}}return i?o[i]:o}}return Object.create({set:r,get:n,remove:function(i,s){r(i,"",kt({},s,{expires:-1}))},withAttributes:function(i){return cr(this.converter,kt({},this.attributes,i))},withConverter:function(i){return cr(kt({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(t)}})}var Oe=cr(Us,{path:"/"}),ur=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function lr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Ms(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){if(this instanceof n){var i=[null];i.push.apply(i,arguments);var s=Function.bind.apply(e,i);return new s}return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var dr={exports:{}};(function(t,e){(function(r){function n(i){var s=i&&i.Promise||r.Promise,o=i&&i.XMLHttpRequest||r.XMLHttpRequest;return function(){var c=Object.create(r,{fetch:{value:void 0,writable:!0}});return function(a,u){u(e)}(this,function(a){var u=typeof c!="undefined"&&c||typeof self!="undefined"&&self||typeof u!="undefined"&&u,l={searchParams:"URLSearchParams"in u,iterable:"Symbol"in u&&"iterator"in Symbol,blob:"FileReader"in u&&"Blob"in u&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in u,arrayBuffer:"ArrayBuffer"in u};function h(v){return v&&DataView.prototype.isPrototypeOf(v)}if(l.arrayBuffer)var d=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=ArrayBuffer.isView||function(v){return v&&d.indexOf(Object.prototype.toString.call(v))>-1};function p(v){if(typeof v!="string"&&(v=String(v)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(v)||v==="")throw new TypeError("Invalid character in header field name");return v.toLowerCase()}function m(v){return typeof v!="string"&&(v=String(v)),v}function w(v){var b={next:function(){var L=v.shift();return{done:L===void 0,value:L}}};return l.iterable&&(b[Symbol.iterator]=function(){return b}),b}function E(v){this.map={},v instanceof E?v.forEach(function(b,L){this.append(L,b)},this):Array.isArray(v)?v.forEach(function(b){this.append(b[0],b[1])},this):v&&Object.getOwnPropertyNames(v).forEach(function(b){this.append(b,v[b])},this)}E.prototype.append=function(v,b){v=p(v),b=m(b);var L=this.map[v];this.map[v]=L?L+", "+b:b},E.prototype.delete=function(v){delete this.map[p(v)]},E.prototype.get=function(v){return v=p(v),this.has(v)?this.map[v]:null},E.prototype.has=function(v){return this.map.hasOwnProperty(p(v))},E.prototype.set=function(v,b){this.map[p(v)]=m(b)},E.prototype.forEach=function(v,b){for(var L in this.map)this.map.hasOwnProperty(L)&&v.call(b,this.map[L],L,this)},E.prototype.keys=function(){var v=[];return this.forEach(function(b,L){v.push(L)}),w(v)},E.prototype.values=function(){var v=[];return this.forEach(function(b){v.push(b)}),w(v)},E.prototype.entries=function(){var v=[];return this.forEach(function(b,L){v.push([L,b])}),w(v)},l.iterable&&(E.prototype[Symbol.iterator]=E.prototype.entries);function x(v){if(v.bodyUsed)return s.reject(new TypeError("Already read"));v.bodyUsed=!0}function S(v){return new s(function(b,L){v.onload=function(){b(v.result)},v.onerror=function(){L(v.error)}})}function A(v){var b=new FileReader,L=S(b);return b.readAsArrayBuffer(v),L}function k(v){var b=new FileReader,L=S(b);return b.readAsText(v),L}function _(v){for(var b=new Uint8Array(v),L=new Array(b.length),K=0;K<b.length;K++)L[K]=String.fromCharCode(b[K]);return L.join("")}function N(v){if(v.slice)return v.slice(0);var b=new Uint8Array(v.byteLength);return b.set(new Uint8Array(v)),b.buffer}function C(){return this.bodyUsed=!1,this._initBody=function(v){this.bodyUsed=this.bodyUsed,this._bodyInit=v,v?typeof v=="string"?this._bodyText=v:l.blob&&Blob.prototype.isPrototypeOf(v)?this._bodyBlob=v:l.formData&&FormData.prototype.isPrototypeOf(v)?this._bodyFormData=v:l.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)?this._bodyText=v.toString():l.arrayBuffer&&l.blob&&h(v)?(this._bodyArrayBuffer=N(v.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(v)||f(v))?this._bodyArrayBuffer=N(v):this._bodyText=v=Object.prototype.toString.call(v):this._bodyText="",this.headers.get("content-type")||(typeof v=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l.blob&&(this.blob=function(){var v=x(this);if(v)return v;if(this._bodyBlob)return s.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return s.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return s.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var v=x(this);return v||(ArrayBuffer.isView(this._bodyArrayBuffer)?s.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):s.resolve(this._bodyArrayBuffer))}else return this.blob().then(A)}),this.text=function(){var v=x(this);if(v)return v;if(this._bodyBlob)return k(this._bodyBlob);if(this._bodyArrayBuffer)return s.resolve(_(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return s.resolve(this._bodyText)},l.formData&&(this.formData=function(){return this.text().then(Z)}),this.json=function(){return this.text().then(JSON.parse)},this}var P=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function I(v){var b=v.toUpperCase();return P.indexOf(b)>-1?b:v}function M(v,b){if(!(this instanceof M))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');b=b||{};var L=b.body;if(v instanceof M){if(v.bodyUsed)throw new TypeError("Already read");this.url=v.url,this.credentials=v.credentials,b.headers||(this.headers=new E(v.headers)),this.method=v.method,this.mode=v.mode,this.signal=v.signal,!L&&v._bodyInit!=null&&(L=v._bodyInit,v.bodyUsed=!0)}else this.url=String(v);if(this.credentials=b.credentials||this.credentials||"same-origin",(b.headers||!this.headers)&&(this.headers=new E(b.headers)),this.method=I(b.method||this.method||"GET"),this.mode=b.mode||this.mode||null,this.signal=b.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&L)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(L),(this.method==="GET"||this.method==="HEAD")&&(b.cache==="no-store"||b.cache==="no-cache")){var K=/([?&])_=[^&]*/;if(K.test(this.url))this.url=this.url.replace(K,"$1_="+new Date().getTime());else{var $=/\?/;this.url+=($.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}M.prototype.clone=function(){return new M(this,{body:this._bodyInit})};function Z(v){var b=new FormData;return v.trim().split("&").forEach(function(L){if(L){var K=L.split("="),$=K.shift().replace(/\+/g," "),q=K.join("=").replace(/\+/g," ");b.append(decodeURIComponent($),decodeURIComponent(q))}}),b}function ce(v){var b=new E,L=v.replace(/\r?\n[\t ]+/g," ");return L.split("\r").map(function(K){return K.indexOf(`
`)===0?K.substr(1,K.length):K}).forEach(function(K){var $=K.split(":"),q=$.shift().trim();if(q){var Je=$.join(":").trim();b.append(q,Je)}}),b}C.call(M.prototype);function J(v,b){if(!(this instanceof J))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');b||(b={}),this.type="default",this.status=b.status===void 0?200:b.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in b?b.statusText:"",this.headers=new E(b.headers),this.url=b.url||"",this._initBody(v)}C.call(J.prototype),J.prototype.clone=function(){return new J(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new E(this.headers),url:this.url})},J.error=function(){var v=new J(null,{status:0,statusText:""});return v.type="error",v};var ye=[301,302,303,307,308];J.redirect=function(v,b){if(ye.indexOf(b)===-1)throw new RangeError("Invalid status code");return new J(null,{status:b,headers:{location:v}})},a.DOMException=u.DOMException;try{new a.DOMException}catch{a.DOMException=function(b,L){this.message=b,this.name=L;var K=Error(b);this.stack=K.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function we(v,b){return new s(function(L,K){var $=new M(v,b);if($.signal&&$.signal.aborted)return K(new a.DOMException("Aborted","AbortError"));var q=new o;function Je(){q.abort()}q.onload=function(){var re={status:q.status,statusText:q.statusText,headers:ce(q.getAllResponseHeaders()||"")};re.url="responseURL"in q?q.responseURL:re.headers.get("X-Request-URL");var Yt="response"in q?q.response:q.responseText;setTimeout(function(){L(new J(Yt,re))},0)},q.onerror=function(){setTimeout(function(){K(new TypeError("Network request failed"))},0)},q.ontimeout=function(){setTimeout(function(){K(new TypeError("Network request failed"))},0)},q.onabort=function(){setTimeout(function(){K(new a.DOMException("Aborted","AbortError"))},0)};function ue(re){try{return re===""&&u.location.href?u.location.href:re}catch{return re}}q.open($.method,ue($.url),!0),$.credentials==="include"?q.withCredentials=!0:$.credentials==="omit"&&(q.withCredentials=!1),"responseType"in q&&(l.blob?q.responseType="blob":l.arrayBuffer&&$.headers.get("Content-Type")&&$.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(q.responseType="arraybuffer")),b&&typeof b.headers=="object"&&!(b.headers instanceof E)?Object.getOwnPropertyNames(b.headers).forEach(function(re){q.setRequestHeader(re,m(b.headers[re]))}):$.headers.forEach(function(re,Yt){q.setRequestHeader(Yt,re)}),$.signal&&($.signal.addEventListener("abort",Je),q.onreadystatechange=function(){q.readyState===4&&$.signal.removeEventListener("abort",Je)}),q.send(typeof $._bodyInit=="undefined"?null:$._bodyInit)})}we.polyfill=!0,u.fetch||(u.fetch=we,u.Headers=E,u.Request=M,u.Response=J),a.Headers=E,a.Request=M,a.Response=J,a.fetch=we,Object.defineProperty(a,"__esModule",{value:!0})}),{fetch:c.fetch,Headers:c.Headers,Request:c.Request,Response:c.Response,DOMException:c.DOMException}}()}t.exports=n})(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:ur)})(dr,dr.exports);var js=dr.exports;const hr=lr(js),Ie="nhostRefreshToken",_t="nhostRefreshTokenId",He="nhostRefreshTokenExpiresAt",Fs=3,Vs=60,bn=5,xn=0,An=1,ve=10,Nt=20;let Dt=class extends Error{constructor(e){super(e.message),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),e instanceof Error?(this.name=e.name,this.error={error:e.name,status:An,message:e.message}):(this.name=e.error,this.error=e)}};const ke={status:ve,error:"invalid-email",message:"Email is incorrectly formatted"},Bs={status:ve,error:"invalid-mfa-type",message:"MFA type is invalid"},Gs={status:ve,error:"invalid-mfa-code",message:"MFA code is invalid"},fr={status:ve,error:"invalid-password",message:"Password is incorrectly formatted"},On={status:ve,error:"invalid-phone-number",message:"Phone number is incorrectly formatted"},$s={status:ve,error:"invalid-mfa-ticket",message:"MFA ticket is invalid"},qs={status:ve,error:"no-mfa-ticket",message:"No MFA ticket has been provided"},Ys={status:ve,error:"no-refresh-token",message:"No refresh token has been provided"},Hs={status:Nt,error:"refresher-already-running",message:"The token refresher is already running. You must wait until is has finished before submitting a new token."},me={status:Nt,error:"already-signed-in",message:"User is already signed in"},zs={status:Nt,error:"unauthenticated-user",message:"User is not authenticated"},Ks={status:Nt,error:"unverified-user",message:"Email needs verification"},Js={status:ve,error:"invalid-refresh-token",message:"Invalid or expired refresh token"},Ws={status:An,error:"invalid-sign-in-method",message:"Invalid sign-in method"},pr={user:null,mfa:null,accessToken:{value:null,expiresAt:null,expiresInSeconds:15},refreshTimer:{startedAt:null,attempts:0,lastAttempt:null},refreshToken:{value:null},importTokenAttempts:0,errors:{}};function Qs(t){return new TextEncoder().encode(t)}function Ue(t){const e=new Uint8Array(t);let r="";for(const n of e)r+=String.fromCharCode(n);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function vr(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4,n=e.padEnd(e.length+r,"="),i=atob(n),s=new ArrayBuffer(i.length),o=new Uint8Array(s);for(let c=0;c<i.length;c++)o[c]=i.charCodeAt(c);return s}function In(){return(window==null?void 0:window.PublicKeyCredential)!==void 0&&typeof window.PublicKeyCredential=="function"}function kn(t){const{id:e}=t;return{...t,id:vr(e),transports:t.transports}}function _n(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}let ae=class extends Error{constructor(e,r="WebAuthnError"){super(e),this.name=r}};function Xs({error:t,options:e}){var r,n;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal===new AbortController().signal)return new ae("Registration ceremony was sent an abort signal","AbortError")}else if(t.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new ae("Discoverable credentials were required but no available authenticator supported it","ConstraintError");if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new ae("User verification was required but no available authenticator supported it","ConstraintError")}else{if(t.name==="InvalidStateError")return new ae("The authenticator was previously registered","InvalidStateError");if(t.name==="NotAllowedError")return new ae("User clicked cancel, or the registration ceremony timed out","NotAllowedError");if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(s=>s.type==="public-key").length===0?new ae('No entry in pubKeyCredParams was of type "public-key"',"NotSupportedError"):new ae("No available authenticator supported any of the specified pubKeyCredParams algorithms","NotSupportedError");if(t.name==="SecurityError"){const s=window.location.hostname;if(_n(s)){if(i.rp.id!==s)return new ae(`The RP ID "${i.rp.id}" is invalid for this domain`,"SecurityError")}else return new ae(`${window.location.hostname} is an invalid domain`,"SecurityError")}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new ae("User ID was not between 1 and 64 characters","TypeError")}else if(t.name==="UnknownError")return new ae("The authenticator was unable to process the specified options, or could not create a new credential","UnknownError")}return t}let Zs=class{createNewAbortSignal(){return this.controller&&this.controller.abort(),this.controller=new AbortController,this.controller.signal}reset(){this.controller=void 0}};const Rt=new Zs;async function Nn(t){if(!In())throw new Error("WebAuthn is not supported in this browser");const e={publicKey:{...t,challenge:vr(t.challenge),user:{...t.user,id:Qs(t.user.id)},excludeCredentials:t.excludeCredentials.map(kn)}};e.signal=Rt.createNewAbortSignal();let r;try{r=await navigator.credentials.create(e)}catch(a){throw Xs({error:a,options:e})}finally{Rt.reset()}if(!r)throw new Error("Registration was not completed");const{id:n,rawId:i,response:s,type:o}=r,c={id:n,rawId:Ue(i),response:{attestationObject:Ue(s.attestationObject),clientDataJSON:Ue(s.clientDataJSON)},type:o,clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:r.authenticatorAttachment};return typeof s.getTransports=="function"&&(c.transports=s.getTransports()),c}function eo(t){return new TextDecoder("utf-8").decode(t)}async function to(){if(navigator.credentials.conditionalMediationSupported)return!0;const t=window.PublicKeyCredential;return t.isConditionalMediationAvailable!==void 0&&t.isConditionalMediationAvailable()}function ro({error:t,options:e}){var r;const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal===new AbortController().signal)return new ae("Authentication ceremony was sent an abort signal","AbortError")}else{if(t.name==="NotAllowedError")return!((r=n.allowCredentials)===null||r===void 0)&&r.length?new ae("No available authenticator recognized any of the allowed credentials","NotAllowedError"):new ae("User clicked cancel, or the authentication ceremony timed out","NotAllowedError");if(t.name==="SecurityError"){const i=window.location.hostname;if(_n(i)){if(n.rpId!==i)return new ae(`The RP ID "${n.rpId}" is invalid for this domain`,"SecurityError")}else return new ae(`${window.location.hostname} is an invalid domain`,"SecurityError")}else if(t.name==="UnknownError")return new ae("The authenticator was unable to process the specified options, or could not create a new assertion signature","UnknownError")}return t}async function no(t,e=!1){var r,n;if(!In())throw new Error("WebAuthn is not supported in this browser");let i;((r=t.allowCredentials)===null||r===void 0?void 0:r.length)!==0&&(i=(n=t.allowCredentials)===null||n===void 0?void 0:n.map(kn));const s={...t,challenge:vr(t.challenge),allowCredentials:i},o={};if(e){if(!await to())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete*='webauthn']").length<1)throw Error('No <input> with `"webauthn"` in its `autocomplete` attribute was detected');o.mediation="conditional",s.allowCredentials=[]}o.publicKey=s,o.signal=Rt.createNewAbortSignal();let c;try{c=await navigator.credentials.get(o)}catch(f){throw ro({error:f,options:o})}finally{Rt.reset()}if(!c)throw new Error("Authentication was not completed");const{id:a,rawId:u,response:l,type:h}=c;let d;return l.userHandle&&(d=eo(l.userHandle)),{id:a,rawId:Ue(u),response:{authenticatorData:Ue(l.authenticatorData),clientDataJSON:Ue(l.clientDataJSON),signature:Ue(l.signature),userHandle:d},type:h,clientExtensionResults:c.getClientExtensionResults(),authenticatorAttachment:c.authenticatorAttachment}}const Ct=typeof window!="undefined",Pt=new Map,io=t=>{var e;return Ct&&typeof localStorage!="undefined"?localStorage.getItem(t):(e=Pt.get(t))!=null?e:null},so=(t,e)=>{Ct&&typeof localStorage!="undefined"?e?localStorage.setItem(t,e):localStorage.removeItem(t):e?Pt.set(t,e):Pt.has(t)&&Pt.delete(t)},oo=(t,e)=>{if(t==="localStorage"||t==="web")return io;if(t==="cookie")return r=>{var n;return Ct&&(n=Oe.get(r))!=null?n:null};if(!e)throw Error(`clientStorageType is set to '${t}' but no clientStorage has been given`);if(t==="react-native")return r=>{var n;return(n=e.getItem)==null?void 0:n.call(e,r)};if(t==="capacitor")return r=>{var n;return(n=e.get)==null?void 0:n.call(e,{key:r})};if(t==="expo-secure-storage")return r=>{var n;return(n=e.getItemAsync)==null?void 0:n.call(e,r)};if(t==="custom"){if(e.getItem&&e.removeItem)return e.getItem;if(e.getItemAsync)return e.getItemAsync;throw Error(`clientStorageType is set to 'custom' but clientStorage is missing either "getItem" and "removeItem" properties or "getItemAsync" property`)}throw Error(`Unknown storage type: ${t}`)},ao=(t,e)=>{if(t==="localStorage"||t==="web")return so;if(t==="cookie")return(r,n)=>{Ct&&(n?Oe.set(r,n,{expires:30,sameSite:"lax",httpOnly:!1}):Oe.remove(r))};if(!e)throw Error(`clientStorageType is set to '${t}' but no clienStorage has been given`);if(t==="react-native")return(r,n)=>{var i,s;return n?(i=e.setItem)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};if(t==="capacitor")return(r,n)=>{var i,s;return n?(i=e.set)==null?void 0:i.call(e,{key:r,value:n}):(s=e.remove)==null?void 0:s.call(e,{key:r})};if(t==="expo-secure-storage")return async(r,n)=>{var i,s;return n?(i=e.setItemAsync)==null?void 0:i.call(e,r,n):(s=e.deleteItemAsync)==null?void 0:s.call(e,r)};if(t==="custom"){if(!e.removeItem)throw Error("clientStorageType is set to 'custom' but clientStorage is missing a removeItem property");if(e.setItem)return(r,n)=>{var i,s;return n?(i=e.setItem)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};if(e.setItemAsync)return async(r,n)=>{var i,s;return n?(i=e.setItemAsync)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};throw Error("clientStorageType is set to 'custom' but clientStorage is missing setItem or setItemAsync property")}throw Error(`Unknown storage type: ${t}`)},Lt=t=>!t||!t.accessToken.value||!t.refreshToken.value||!t.accessToken.expiresAt||!t.user?null:{accessToken:t.accessToken.value,accessTokenExpiresIn:(t.accessToken.expiresAt.getTime()-Date.now())/1e3,refreshToken:t.refreshToken.value,user:t.user},_e=({accessToken:t,isError:e,user:r,error:n})=>e?{session:null,error:n}:r&&t?{session:{accessToken:t,accessTokenExpiresIn:0,refreshToken:"",user:r},error:null}:{session:null,error:null},co=()=>typeof window!="undefined",{fetch:uo}=hr(),Dn=async(t,e,{token:r,body:n}={})=>{const i={"Content-Type":"application/json",Accept:"*/*"};r&&(i.Authorization=`Bearer ${r}`);const s={method:e,headers:i};n&&(s.body=JSON.stringify(n));try{const o=await uo(t,s);if(!o.ok){const c=await o.json();return Promise.reject({error:c})}try{return{data:await o.json(),error:null}}catch{return console.warn(`Unexpected response: can't parse the response of the server at ${t}`),{data:"OK",error:null}}}catch{const o={message:"Network Error",status:xn,error:"network"};return Promise.reject({error:o})}},Se=async(t,e,r)=>Dn(t,"POST",{token:r,body:e}),lo=(t,e)=>Dn(t,"GET",{token:e}),mr=(t,e)=>{const r=e&&Object.entries(e).map(([n,i])=>{const s=Array.isArray(i)?i.join(","):typeof i=="object"?JSON.stringify(i):i;return`${n}=${encodeURIComponent(s)}`}).join("&");return r?`${t}?${r}`:t},he=(t,e)=>{if(!(e!=null&&e.redirectTo))return e;const{redirectTo:r,...n}=e;if(!t)return r.startsWith("/")?n:e;const i=new URL(t),s=Object.fromEntries(new URLSearchParams(i.search)),o=new URL(r.startsWith("/")?i.origin+r:r),c=new URLSearchParams(o.search);let a=Object.fromEntries(c);r.startsWith("/")&&(a={...s,...a});let u=i.pathname;return o.pathname.length>1&&(u+=o.pathname.slice(1)),{...n,redirectTo:mr(o.origin+u,a)}};function Ut(t,e){var r;if(!e){if(typeof window=="undefined")return;e=((r=window.location)==null?void 0:r.href)||""}t=t.replace(/[\[\]]/g,"\\$&");const n=new RegExp("[?&#]"+t+"(=([^&#]*)|&|#|$)"),i=n.exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function Rn(t){var e;if(typeof window=="undefined")return;const r=window==null?void 0:window.location;if(r&&r){const n=new URLSearchParams(r.search),i=new URLSearchParams((e=r.hash)==null?void 0:e.slice(1));n.delete(t),i.delete(t);let s=window.location.pathname;Array.from(n).length&&(s+=`?${n.toString()}`),Array.from(i).length&&(s+=`#${i.toString()}`),window.history.pushState({},"",s)}}const Ne=t=>!!t&&typeof t=="string"&&!!String(t).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),yr=t=>!!t&&typeof t=="string"&&t.length>=Fs,Cn=t=>!!t&&typeof t=="string",ho=t=>t&&typeof t=="string"&&t.match(/^mfaTotp:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i),fo=({backendUrl:t,clientUrl:e,clientStorageType:r="web",clientStorage:n,refreshIntervalTime:i,autoRefreshToken:s=!0,autoSignIn:o=!0})=>{const c=oo(r,n),a=ao(r,n),u=async(l,h,d)=>(await Se(`${t}${l}`,h,d)).data;return Ae({schema:{context:{},events:{},services:{}},tsTypes:{},context:pr,predictableActionArguments:!0,id:"nhost",type:"parallel",states:{authentication:{initial:"starting",on:{SESSION_UPDATE:[{cond:"hasSession",actions:["saveSession","resetTimer","reportTokenChanged"],target:".signedIn"}]},states:{starting:{tags:["loading"],always:{cond:"isSignedIn",target:"signedIn"},invoke:{id:"importRefreshToken",src:"importRefreshToken",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"signedIn"},{target:"signedOut"}],onError:[{cond:"shouldRetryImportToken",actions:"incrementTokenImportAttempts",target:"retryTokenImport"},{actions:["saveAuthenticationError"],target:"signedOut"}]}},retryTokenImport:{tags:["loading"],after:{RETRY_IMPORT_TOKEN_DELAY:"starting"}},signedOut:{initial:"noErrors",entry:"reportSignedOut",states:{noErrors:{},success:{},needsSmsOtp:{},needsMfa:{},failed:{},signingOut:{entry:["clearContextExceptRefreshToken"],exit:["destroyRefreshToken","reportTokenChanged"],invoke:{src:"signout",id:"signingOut",onDone:{target:"success"},onError:{target:"failed",actions:["saveAuthenticationError"]}}}},on:{SIGNIN_PASSWORD:"authenticating.password",SIGNIN_ANONYMOUS:"authenticating.anonymous",SIGNIN_SECURITY_KEY_EMAIL:"authenticating.securityKeyEmail",SIGNIN_MFA_TOTP:"authenticating.mfa.totp",SIGNIN_PAT:"authenticating.pat"}},authenticating:{entry:"resetErrors",states:{password:{invoke:{src:"signInPassword",id:"authenticateUserWithPassword",onDone:[{cond:"hasMfaTicket",actions:["saveMfaTicket"],target:"#nhost.authentication.signedOut.needsMfa"},{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"}],onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}},pat:{invoke:{src:"signInPAT",id:"authenticateWithPAT",onDone:{actions:["savePATSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},anonymous:{invoke:{src:"signInAnonymous",id:"authenticateAnonymously",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},mfa:{states:{totp:{invoke:{src:"signInMfaTotp",id:"signInMfaTotp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:["saveAuthenticationError"],target:"#nhost.authentication.signedOut.failed"}}}}},securityKeyEmail:{invoke:{src:"signInSecurityKeyEmail",id:"authenticateUserWithSecurityKey",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}}}},signedIn:{type:"parallel",entry:["reportSignedIn","cleanUrl","broadcastToken","resetErrors"],on:{SIGNOUT:"signedOut.signingOut"},states:{refreshTimer:{id:"timer",initial:"idle",states:{disabled:{type:"final"},stopped:{always:{cond:"noToken",target:"idle"}},idle:{always:[{cond:"isAutoRefreshDisabled",target:"disabled"},{cond:"isRefreshTokenPAT",target:"disabled"},{cond:"hasRefreshToken",target:"running"}]},running:{initial:"pending",entry:"resetTimer",states:{pending:{after:{1e3:{internal:!1,target:"pending"}},always:{cond:"refreshTimerShouldRefresh",target:"refreshing"}},refreshing:{invoke:{src:"refreshToken",id:"refreshToken",onDone:{actions:["saveSession","resetTimer","reportTokenChanged"],target:"pending"},onError:[{actions:"saveRefreshAttempt",target:"pending"}]}}}}}}}}}},token:{initial:"idle",states:{idle:{on:{TRY_TOKEN:"running"},initial:"noErrors",states:{noErrors:{},error:{}}},running:{invoke:{src:"refreshToken",id:"authenticateWithToken",onDone:{actions:["saveSession","reportTokenChanged"],target:["#nhost.authentication.signedIn","idle.noErrors"]},onError:[{cond:"isSignedIn",target:"idle.error"},{actions:"saveAuthenticationError",target:["#nhost.authentication.signedOut.failed","idle.error"]}]}}}},registration:{initial:"incomplete",on:{SIGNED_IN:[{cond:"isAnonymous",target:".incomplete"},".complete"]},states:{incomplete:{on:{SIGNUP_EMAIL_PASSWORD:"emailPassword",SIGNUP_SECURITY_KEY:"securityKey",PASSWORDLESS_EMAIL:"passwordlessEmail",PASSWORDLESS_SMS:"passwordlessSms",PASSWORDLESS_SMS_OTP:"passwordlessSmsOtp"},initial:"noErrors",states:{noErrors:{},needsEmailVerification:{},needsOtp:{},failed:{}}},emailPassword:{entry:["resetErrors"],invoke:{src:"signUpEmailPassword",id:"signUpEmailPassword",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},securityKey:{entry:["resetErrors"],invoke:{src:"signUpSecurityKey",id:"signUpSecurityKey",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},passwordlessEmail:{entry:["resetErrors"],invoke:{src:"passwordlessEmail",id:"passwordlessEmail",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSms:{entry:["resetErrors"],invoke:{src:"passwordlessSms",id:"passwordlessSms",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsOtp"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSmsOtp:{entry:["resetErrors"],invoke:{src:"passwordlessSmsOtp",id:"passwordlessSmsOtp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},complete:{on:{SIGNED_OUT:"incomplete"}}}}}},{actions:{reportSignedIn:ie("SIGNED_IN"),reportSignedOut:ie("SIGNED_OUT"),reportTokenChanged:ie("TOKEN_CHANGED"),incrementTokenImportAttempts:j({importTokenAttempts:({importTokenAttempts:l})=>l+1}),clearContext:j(()=>(a(He,null),a(Ie,null),a(_t,null),{...pr})),clearContextExceptRefreshToken:j(({refreshToken:{value:l}})=>(a(He,null),{...pr,refreshToken:{value:l}})),saveSession:j({user:(l,{data:h})=>{var d;return((d=h==null?void 0:h.session)==null?void 0:d.user)||null},accessToken:(l,{data:h})=>{if(h.session){const{accessTokenExpiresIn:d,accessToken:f}=h.session,p=new Date(Date.now()+d*1e3);return a(He,p.toISOString()),{value:f,expiresAt:p,expiresInSeconds:d}}return a(He,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(l,{data:h})=>{var d,f;const p=((d=h.session)==null?void 0:d.refreshToken)||null,m=((f=h.session)==null?void 0:f.refreshTokenId)||null;return p&&a(Ie,p),m&&a(_t,m),{value:p}}}),savePATSession:j({user:(l,{data:h})=>{var d;return((d=h==null?void 0:h.session)==null?void 0:d.user)||null},accessToken:(l,{data:h})=>{if(h.session){const{accessTokenExpiresIn:d,accessToken:f}=h.session,p=new Date(Date.now()+d*1e3);return a(He,p.toISOString()),{value:f,expiresAt:p,expiresInSeconds:d}}return a(He,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(l,{data:h})=>{var d,f;const p=((d=h.session)==null?void 0:d.refreshToken)||null,m=((f=h.session)==null?void 0:f.refreshTokenId)||null;return p&&a(Ie,p),m&&a(_t,m),{value:p,isPAT:!0}}}),saveMfaTicket:j({mfa:(l,h)=>{var d;return(d=h.data)==null?void 0:d.mfa}}),resetTimer:j({refreshTimer:l=>({startedAt:new Date,attempts:0,lastAttempt:null})}),saveRefreshAttempt:j({refreshTimer:(l,h)=>({startedAt:l.refreshTimer.startedAt,attempts:l.refreshTimer.attempts+1,lastAttempt:new Date})}),saveAuthenticationError:j({errors:({errors:l},{data:{error:h}})=>({...l,authentication:h})}),resetErrors:j({errors:l=>({}),importTokenAttempts:l=>0}),saveRegistrationError:j({errors:({errors:l},{data:{error:h}})=>({...l,registration:h})}),destroyRefreshToken:j({refreshToken:l=>(a(Ie,null),a(_t,null),{value:null})}),cleanUrl:()=>{o&&Ut("refreshToken")&&(Rn("refreshToken"),Rn("type"))},broadcastToken:l=>{if(o)try{new BroadcastChannel("nhost").postMessage(l.refreshToken.value)}catch{}}},guards:{isAnonymous:(l,h)=>{var d;return!!((d=l.user)!=null&&d.isAnonymous)},isSignedIn:l=>!!l.user&&!!l.refreshToken.value&&!!l.accessToken.value,noToken:l=>!l.refreshToken.value,isRefreshTokenPAT:l=>{var h;return!!((h=l.refreshToken)!=null&&h.isPAT)},hasRefreshToken:l=>!!l.refreshToken.value,isAutoRefreshDisabled:()=>!s,refreshTimerShouldRefresh:l=>{const{expiresAt:h}=l.accessToken;if(!h)return!1;if(l.refreshTimer.lastAttempt)return l.refreshTimer.attempts>bn?!1:Date.now()-l.refreshTimer.lastAttempt.getTime()>Math.pow(2,l.refreshTimer.attempts-1)*5e3;if(i&&Date.now()-l.refreshTimer.startedAt.getTime()>i*1e3)return!0;const d=l.accessToken.expiresInSeconds;return d?h.getTime()-Date.now()-1e3*Math.min(Vs,d*.5)<=0:!1},shouldRetryImportToken:(l,h)=>l.importTokenAttempts<bn&&(h.data.error.status===xn||h.data.error.status>=500),unverified:(l,{data:{error:h}})=>h.status===401&&(h.message==="Email is not verified"||h.error==="unverified-user"),hasSession:(l,h)=>{var d;return!!((d=h.data)!=null&&d.session)},hasMfaTicket:(l,h)=>{var d;return!!((d=h.data)!=null&&d.mfa)}},services:{signInPassword:(l,{email:h,password:d})=>Ne(h)?yr(d)?u("/signin/email-password",{email:h,password:d}):Promise.reject({error:fr}):Promise.reject({error:ke}),signInPAT:(l,{pat:h})=>u("/signin/pat",{personalAccessToken:h}),passwordlessSms:(l,{phoneNumber:h,options:d})=>{var f;return Cn(h)?(f=l.user)!=null&&f.isAnonymous?(console.warn("Deanonymisation from a phone number is not yet implemented in hasura-auth"),u("/user/deanonymize",{signInMethod:"passwordless",connection:"sms",phoneNumber:h,options:he(e,d)},l.accessToken.value)):u("/signin/passwordless/sms",{phoneNumber:h,options:he(e,d)}):Promise.reject({error:On})},passwordlessSmsOtp:(l,{phoneNumber:h,otp:d})=>Cn(h)?u("/signin/passwordless/sms/otp",{phoneNumber:h,otp:d}):Promise.reject({error:On}),passwordlessEmail:(l,{email:h,options:d})=>{var f;return Ne(h)?(f=l.user)!=null&&f.isAnonymous?u("/user/deanonymize",{signInMethod:"passwordless",connection:"email",email:h,options:he(e,d)},l.accessToken.value):u("/signin/passwordless/email",{email:h,options:he(e,d)}):Promise.reject({error:ke})},signInAnonymous:l=>u("/signin/anonymous"),signInMfaTotp:(l,h)=>{var d;const f=h.ticket||((d=l.mfa)==null?void 0:d.ticket);return f?ho(f)?u("/signin/mfa/totp",{ticket:f,otp:h.otp}):Promise.reject({error:$s}):Promise.reject({error:qs})},signInSecurityKeyEmail:async(l,{email:h})=>{if(!Ne(h))throw new Dt(ke);const d=await u("/signin/webauthn",{email:h});let f;try{f=await no(d)}catch(p){throw new Dt(p)}return u("/signin/webauthn/verify",{email:h,credential:f})},refreshToken:async(l,h)=>{const d=h.type==="TRY_TOKEN"?h.token:l.refreshToken.value;return{session:await u("/token",{refreshToken:d}),error:null}},signout:(l,h)=>u("/signout",{refreshToken:l.refreshToken.value,all:!!h.all}),signUpEmailPassword:async(l,{email:h,password:d,options:f})=>{var p;return Ne(h)?yr(d)?(p=l.user)!=null&&p.isAnonymous?u("/user/deanonymize",{signInMethod:"email-password",email:h,password:d,options:he(e,f)},l.accessToken.value):u("/signup/email-password",{email:h,password:d,options:he(e,f)}):Promise.reject({error:fr}):Promise.reject({error:ke})},signUpSecurityKey:async(l,{email:h,options:d})=>{if(!Ne(h))return Promise.reject({error:ke});const f=d==null?void 0:d.nickname;f&&delete d.nickname;const p=await u("/signup/webauthn",{email:h,options:d});let m;try{m=await Nn(p)}catch(w){throw new Dt(w)}return u("/signup/webauthn/verify",{credential:m,options:{redirectTo:d==null?void 0:d.redirectTo,nickname:f}})},importRefreshToken:async l=>{if(l.user&&l.refreshToken.value&&l.accessToken.value&&l.accessToken.expiresAt)return{session:{accessToken:l.accessToken.value,accessTokenExpiresIn:l.accessToken.expiresAt.getTime()-Date.now(),refreshToken:l.refreshToken.value,user:l.user},error:null};let h=null;if(o){const f=Ut("refreshToken")||null;if(f)try{return{session:await u("/token",{refreshToken:f}),error:null}}catch(p){h=p.error}else{const p=Ut("error");if(p)return Promise.reject({session:null,error:{status:ve,error:p,message:Ut("errorDescription")||p}})}}const d=await c(Ie);if(d)try{return{session:await u("/token",{refreshToken:d}),error:null}}catch(f){h=f.error}return h?Promise.reject({error:h,session:null}):{error:null,session:null}}},delays:{RETRY_IMPORT_TOKEN_DELAY:({importTokenAttempts:l})=>Math.pow(2,l-1)*5e3}})},Pn=({backendUrl:t,clientUrl:e,interpreter:r})=>Ae({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changeEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:j({error:n=>ke}),saveRequestError:j({error:(n,{data:{error:i}})=>i}),reportError:ie(n=>({type:"ERROR",error:n.error})),reportSuccess:ie("SUCCESS")},guards:{invalidEmail:(n,{email:i})=>!Ne(i)},services:{requestChange:async(n,{email:i,options:s})=>(await Se(`${t}/user/email/change`,{newEmail:i,options:he(e,s)},r==null?void 0:r.getSnapshot().context.accessToken.value)).data}}),Ln=({backendUrl:t,interpreter:e})=>Ae({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidPassword",actions:"saveInvalidPasswordError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidPasswordError:j({error:r=>fr}),saveRequestError:j({error:(r,{data:{error:n}})=>n}),reportError:ie(r=>({type:"ERROR",error:r.error})),reportSuccess:ie("SUCCESS")},guards:{invalidPassword:(r,{password:n})=>!yr(n)},services:{requestChange:(r,{password:n,ticket:i})=>Se(`${t}/user/password`,{newPassword:n,ticket:i},e==null?void 0:e.getSnapshot().context.accessToken.value)}}),po=({backendUrl:t,interpreter:e})=>Ae({schema:{context:{},events:{}},tsTypes:{},predictableActionArguments:!0,id:"enableMfa",initial:"idle",context:{error:null,imageUrl:null,secret:null},states:{idle:{initial:"initial",on:{GENERATE:"generating"},states:{initial:{},error:{}}},generating:{invoke:{src:"generate",id:"generate",onDone:{target:"generated",actions:["reportGeneratedSuccess","saveGeneration"]},onError:{actions:["saveError","reportGeneratedError"],target:"idle.error"}}},generated:{initial:"idle",states:{idle:{initial:"idle",on:{ACTIVATE:[{cond:"invalidMfaType",actions:"saveInvalidMfaTypeError",target:".error"},{cond:"invalidMfaCode",actions:"saveInvalidMfaCodeError",target:".error"},{target:"activating"}]},states:{idle:{},error:{}}},activating:{invoke:{src:"activate",id:"activate",onDone:{target:"activated",actions:"reportSuccess"},onError:{actions:["saveError","reportError"],target:"idle.error"}}},activated:{type:"final"}}}}},{actions:{saveInvalidMfaTypeError:j({error:r=>Bs}),saveInvalidMfaCodeError:j({error:r=>Gs}),saveError:j({error:(r,{data:{error:n}})=>n}),saveGeneration:j({imageUrl:(r,{data:{imageUrl:n}})=>n,secret:(r,{data:{totpSecret:n}})=>n}),reportError:ie((r,n)=>(console.log("REPORT",r,n),{type:"ERROR",error:r.error})),reportSuccess:ie("SUCCESS"),reportGeneratedSuccess:ie("GENERATED"),reportGeneratedError:ie(r=>({type:"GENERATED_ERROR",error:r.error}))},guards:{invalidMfaCode:(r,{code:n})=>!n,invalidMfaType:(r,{activeMfaType:n})=>!n||n!=="totp"},services:{generate:async r=>{const{data:n}=await lo(`${t}/mfa/totp/generate`,e==null?void 0:e.getSnapshot().context.accessToken.value);return n},activate:(r,{code:n,activeMfaType:i})=>Se(`${t}/user/mfa`,{code:n,activeMfaType:i},e==null?void 0:e.getSnapshot().context.accessToken.value)}}),Un=({backendUrl:t,clientUrl:e})=>Ae({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:j({error:r=>ke}),saveRequestError:j({error:(r,{data:{error:n}})=>n}),reportError:ie(r=>({type:"ERROR",error:r.error})),reportSuccess:ie("SUCCESS")},guards:{invalidEmail:(r,{email:n})=>!Ne(n)},services:{requestChange:(r,{email:n,options:i})=>Se(`${t}/user/password/reset`,{email:n,options:he(e,i)})}}),Mn=({backendUrl:t,clientUrl:e})=>Ae({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"sendVerificationEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"request",id:"request",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:j({error:r=>ke}),saveRequestError:j({error:(r,{data:{error:n}})=>n}),reportError:ie(r=>({type:"ERROR",error:r.error})),reportSuccess:ie("SUCCESS")},guards:{invalidEmail:(r,{email:n})=>!Ne(n)},services:{request:async(r,{email:n,options:i})=>(await Se(`${t}/user/email/send-verification-email`,{email:n,options:he(e,i)})).data}});class vo{constructor({clientStorageType:e="web",autoSignIn:r=!0,autoRefreshToken:n=!0,start:i=!0,backendUrl:s,clientUrl:o,devTools:c,...a}){if(this._started=!1,this._subscriptionsQueue=new Set,this._subscriptions=new Set,this.backendUrl=s,this.clientUrl=o,this._machine=fo({...a,backendUrl:s,clientUrl:o,clientStorageType:e,autoSignIn:r,autoRefreshToken:n}),i&&this.start({devTools:c}),typeof window!="undefined"&&r)try{this._channel=new BroadcastChannel("nhost"),this._channel.addEventListener("message",u=>{var l;const h=(l=this.interpreter)==null?void 0:l.getSnapshot().context.refreshToken.value;this.interpreter&&u.data!==h&&this.interpreter.send("TRY_TOKEN",{token:u.data})})}catch{}}start({devTools:e=!1,initialSession:r,interpreter:n}={}){var i,s;const o={...this.machine.context};r&&(o.user=r.user,o.refreshToken.value=(i=r.refreshToken)!=null?i:null,o.accessToken.value=(s=r.accessToken)!=null?s:null,o.accessToken.expiresAt=new Date(Date.now()+r.accessTokenExpiresIn*1e3));const c=this.machine.withContext(o);this._interpreter||(this._interpreter=n||Le(c,{devTools:e})),(!this._started||typeof window=="undefined")&&(this._interpreter.initialized&&(this._interpreter.stop(),this._subscriptions.forEach(a=>a())),this._interpreter.start(c.initialState),this._subscriptionsQueue.forEach(a=>a(this))),this._started=!0}get machine(){return this._machine}get interpreter(){return this._interpreter}get started(){return this._started}subscribe(e){if(this.started){const r=e(this);return this._subscriptions.add(r),r}else return this._subscriptionsQueue.add(e),()=>{console.log("onTokenChanged was added before the interpreter started. Cannot unsubscribe listener.")}}}const jn=async({backendUrl:t,interpreter:e},r)=>{try{const{data:n}=await Se(`${t}/user/webauthn/add`,{},e==null?void 0:e.getSnapshot().context.accessToken.value);let i;try{i=await Nn(n)}catch(o){throw new Dt(o)}const{data:s}=await Se(`${t}/user/webauthn/verify`,{credential:i,nickname:r},e==null?void 0:e.getSnapshot().context.accessToken.value);return{key:s,isError:!1,error:null,isSuccess:!0}}catch(n){const{error:i}=n;return{isError:!0,error:i,isSuccess:!1}}},Fn=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,needsEmailVerification:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,needsEmailVerification:!0})})}),Vn=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{password:e,ticket:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSuccess:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSuccess:!0})})}),mo=t=>new Promise(e=>{t.send("GENERATE"),t.onTransition(r=>{r.matches("generated")?e({error:null,isError:!1,isGenerated:!0,qrCodeDataUrl:r.context.imageUrl||""}):r.matches({idle:"error"})&&e({error:r.context.error||null,isError:!0,isGenerated:!1,qrCodeDataUrl:""})})}),yo=(t,e)=>new Promise(r=>{t.send("ACTIVATE",{activeMfaType:"totp",code:e}),t.onTransition(n=>{n.matches({generated:"activated"})?r({error:null,isActivated:!0,isError:!1}):n.matches({generated:{idle:"error"}})&&r({error:n.context.error,isActivated:!1,isError:!0})})}),Bn=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSent:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),Gn=(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSent:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),$n=t=>new Promise(e=>{const{changed:r}=t.send("SIGNIN_ANONYMOUS");r||e({isSuccess:!1,isError:!0,error:me,user:null,accessToken:null}),t.onTransition(n=>{n.matches({authentication:"signedIn"})&&e({isSuccess:!0,isError:!1,error:null,user:n.context.user,accessToken:n.context.accessToken.value}),n.matches({authentication:{signedOut:"failed"}})&&e({isSuccess:!1,isError:!0,error:n.context.errors.authentication||null,user:null,accessToken:null})})}),qn=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNIN_PASSWORD",{email:e,password:r});if(!i)return n({accessToken:s.accessToken.value,error:me,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:s.user});t.onTransition(o=>{o.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?n({accessToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,needsMfaOtp:!1,mfa:null,user:null}):o.matches({authentication:{signedOut:"needsMfa"}})?n({accessToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!0,mfa:o.context.mfa,user:null}):o.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,error:o.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:null}):o.matches({authentication:"signedIn"})&&n({accessToken:o.context.accessToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:o.context.user})})}),gr=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send("PASSWORDLESS_EMAIL",{email:e,options:r});if(!i)return n({error:me,isError:!0,isSuccess:!1});t.onTransition(s=>{s.matches("registration.incomplete.failed")?n({error:s.context.errors.registration||null,isError:!0,isSuccess:!1}):s.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})&&n({error:null,isError:!1,isSuccess:!0})})}),Yn=(t,e)=>new Promise(r=>{const{changed:n,context:i}=t.send({type:"SIGNIN_SECURITY_KEY_EMAIL",email:e});if(!n)return r({accessToken:i.accessToken.value,error:me,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:i.user});t.onTransition(s=>{s.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?r({accessToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):s.matches({authentication:{signedOut:"failed"}})?r({accessToken:null,error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):s.matches({authentication:"signedIn"})&&r({accessToken:s.context.accessToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:s.context.user})})}),Hn=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNIN_MFA_TOTP",{otp:e,ticket:r});if(!i)return n({accessToken:s.accessToken.value,error:me,isError:!0,isSuccess:!1,user:s.user});t.onTransition(o=>{o.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,error:o.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null}):o.matches({authentication:"signedIn"})&&n({accessToken:o.context.accessToken.value,error:null,isError:!1,isSuccess:!0,user:o.context.user})})}),zn=(t,e)=>new Promise(r=>{const{changed:n}=t.send("SIGNIN_PAT",{pat:e});n||r({isSuccess:!1,isError:!0,error:me,user:null,accessToken:null}),t.onTransition(i=>{if(i.matches({authentication:{signedOut:"failed"}}))return r({accessToken:null,user:null,error:i.context.errors.authentication||null,isError:!0,isSuccess:!1});if(i.matches({authentication:"signedIn"}))return r({accessToken:i.context.accessToken.value,user:i.context.user,error:null,isError:!1,isSuccess:!0})})}),Er=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send("PASSWORDLESS_SMS",{phoneNumber:e,options:r});if(!i)return n({error:me,isError:!0,isSuccess:!1,needsOtp:!1});t.onTransition(s=>{s.matches("registration.incomplete.needsOtp")?n({error:null,isError:!1,isSuccess:!1,needsOtp:!0}):s.matches("registration.incomplete.failed")&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,needsOtp:!1})})}),Sr=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send({type:"PASSWORDLESS_SMS_OTP",phoneNumber:e,otp:r});if(!i)return n({error:me,isError:!0,isSuccess:!1,user:null,accessToken:null});t.onTransition(s=>{s.matches({authentication:"signedIn"})?n({error:null,isError:!1,isSuccess:!0,user:s.context.user,accessToken:s.context.accessToken.value}):s.matches({registration:{incomplete:"failed"}})&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null,accessToken:null})})}),Kn=async(t,e)=>new Promise(r=>{const{event:n}=t.send("SIGNOUT",{all:e});if(n.type!=="SIGNED_OUT")return r({isSuccess:!1,isError:!0,error:zs});t.onTransition(i=>{i.matches({authentication:{signedOut:"success"}})?r({isSuccess:!0,isError:!1,error:null}):i.matches("authentication.signedOut.failed")&&r({isSuccess:!1,isError:!0,error:i.context.errors.signout||null})})}),Tr=(t,e,r,n)=>new Promise(i=>{const{changed:s,context:o}=t.send("SIGNUP_EMAIL_PASSWORD",{email:e,password:r,options:n});if(!s)return i({error:me,accessToken:o.accessToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:o.user});t.onTransition(c=>{c.matches("registration.incomplete.failed")?i({accessToken:null,error:c.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):c.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?i({accessToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):c.matches({authentication:"signedIn",registration:"complete"})&&i({accessToken:c.context.accessToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:c.context.user})})}),Jn=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNUP_SECURITY_KEY",{email:e,options:r});if(!i)return n({error:me,accessToken:s.accessToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:s.user});t.onTransition(o=>{o.matches("registration.incomplete.failed")?n({accessToken:null,error:o.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):o.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?n({accessToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):o.matches({authentication:"signedIn",registration:"complete"})&&n({accessToken:o.context.accessToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:o.context.user})})}),go=async({backendUrl:t,interpreter:e},{expiresAt:r,metadata:n})=>{try{const{data:i}=await Se(`${t}/pat`,{expiresAt:r.toUTCString(),metadata:n},e==null?void 0:e.getSnapshot().context.accessToken.value);return{data:i?{id:i.id||null,personalAccessToken:i.personalAccessToken||null}:null,isError:!1,error:null,isSuccess:!0}}catch(i){const{error:s}=i;return{isError:!0,error:s,isSuccess:!1,data:null}}};class Eo{constructor({url:e,autoRefreshToken:r=!0,autoSignIn:n=!0,clientStorage:i,clientStorageType:s,refreshIntervalTime:o,start:c=!0}){var a;this.url=e,this._client=new vo({backendUrl:e,clientUrl:typeof window!="undefined"&&((a=window.location)==null?void 0:a.origin)||"",autoRefreshToken:r,autoSignIn:n,start:c,clientStorage:i,clientStorageType:s,refreshIntervalTime:o})}async signUp(e){const r=await this.waitUntilReady(),{email:n,options:i}=e;return"securityKey"in e?_e(await Jn(r,n,i)):_e(await Tr(r,n,e.password,i))}async signIn(e){const r=await this.waitUntilReady();if(!e){const n=await $n(r);return{..._e(n),mfa:null}}if("provider"in e){const{provider:n,options:i}=e,s=mr(`${this._client.backendUrl}/signin/provider/${n}`,he(this._client.clientUrl,i));return co()&&(window.location.href=s),{providerUrl:s,provider:n,session:null,mfa:null,error:null}}if("email"in e&&"password"in e){const n=await qn(r,e.email,e.password);return n.needsEmailVerification?{session:null,mfa:null,error:Ks}:n.needsMfaOtp?{session:null,mfa:n.mfa,error:null}:{..._e(n),mfa:null}}if("email"in e&&"securityKey"in e){if(e.securityKey!==!0)throw Error("securityKey must be true");const n=await Yn(r,e.email);return{..._e(n),mfa:null}}if("email"in e){const{email:n,options:i}=e,{error:s}=await gr(r,n,i);return{session:null,mfa:null,error:s}}if("phoneNumber"in e&&"otp"in e){const n=await Sr(r,e.phoneNumber,e.otp);return{..._e(n),mfa:null}}if("phoneNumber"in e){const{error:n}=await Er(r,e.phoneNumber,e.options);return{error:n,mfa:null,session:null}}if("otp"in e){const n=await Hn(r,e.otp,e.ticket);return{..._e(n),mfa:null}}return{error:Ws,mfa:null,session:null}}async signInPAT(e){const r=await this.waitUntilReady(),n=await zn(r,e);return _e(n)}async signOut(e){const r=await this.waitUntilReady(),{error:n}=await Kn(r,e==null?void 0:e.all);return{error:n}}async resetPassword({email:e,options:r}){const n=Le(Un(this._client)).start(),{error:i}=await Bn(n,e,r);return{error:i}}async changePassword({newPassword:e,ticket:r}){const n=Le(Ln(this._client)).start(),{error:i}=await Vn(n,e,r);return{error:i}}async sendVerificationEmail({email:e,options:r}){const n=Le(Mn(this._client)).start(),{error:i}=await Gn(n,e,r);return{error:i}}async changeEmail({newEmail:e,options:r}){const n=Le(Pn(this._client)).start(),{error:i}=await Fn(n,e,r);return{error:i}}async deanonymize(e){const r=await this.waitUntilReady();if(e.signInMethod==="passwordless"){if(e.connection==="email"){const{error:n}=await gr(r,e.email,e.options);return{error:n}}if(e.connection==="sms"){const{error:n}=await Er(r,e.phoneNumber,e.options);return{error:n}}}if(e.signInMethod==="email-password"){const{error:n}=await Tr(r,e.email,e.password,e.options);return{error:n}}throw Error("Unknown deanonymization method")}async addSecurityKey(e){const{error:r,key:n}=await jn(this._client,e);return{error:r,key:n}}async createPAT(e,r){return go(this._client,{expiresAt:e,metadata:r})}onTokenChanged(e){return this._client.subscribe(()=>{var r;const n=(r=this._client.interpreter)==null?void 0:r.onTransition(({event:i,context:s})=>{i.type==="TOKEN_CHANGED"&&e(Lt(s))});return()=>n==null?void 0:n.stop()})}onAuthStateChanged(e){return this._client.subscribe(()=>{var r;const n=(r=this._client.interpreter)==null?void 0:r.onTransition(({event:i,context:s})=>{(i.type==="SIGNED_IN"||i.type==="SIGNED_OUT")&&e(i.type,Lt(s))});return()=>n==null?void 0:n.stop()})}isAuthenticated(){var e;return!!((e=this._client.interpreter)!=null&&e.getSnapshot().matches({authentication:"signedIn"}))}async isAuthenticatedAsync(){return(await this.waitUntilReady()).getSnapshot().matches({authentication:"signedIn"})}getAuthenticationStatus(){var e;const r=((e=this.client.interpreter)==null?void 0:e.getSnapshot().context.importTokenAttempts)||0;return this.isReady()?{isAuthenticated:this.isAuthenticated(),isLoading:!1,connectionAttempts:r}:{isAuthenticated:!1,isLoading:!0,connectionAttempts:r}}getAccessToken(){var e,r;return(r=(e=this._client.interpreter)==null?void 0:e.getSnapshot().context.accessToken.value)!=null?r:void 0}getDecodedAccessToken(){const e=this.getAccessToken();return e?Gr(e):null}getHasuraClaims(){var e;return((e=this.getDecodedAccessToken())==null?void 0:e["https://hasura.io/jwt/claims"])||null}getHasuraClaim(e){var r;return((r=this.getHasuraClaims())==null?void 0:r[e.startsWith("x-hasura-")?e:`x-hasura-${e}`])||null}async refreshSession(e){try{const r=await this.waitUntilReady();return new Promise(n=>{const i=e||r.getSnapshot().context.refreshToken.value;if(!i)return n({session:null,error:Ys});const{changed:s}=r.send("TRY_TOKEN",{token:i});if(!s)return n({session:null,error:Hs});r.onTransition(o=>{o.matches({token:{idle:"error"}})?n({session:null,error:Js}):o.event.type==="TOKEN_CHANGED"&&n({session:Lt(o.context),error:null})})})}catch(r){return{session:null,error:r.message}}}getSession(){var e,r;return Lt((r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())==null?void 0:r.context)}getUser(){var e,r,n;return((n=(r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())==null?void 0:r.context)==null?void 0:n.user)||null}waitUntilReady(){const e=this._client.interpreter;if(!e)throw Error("Auth interpreter not set");return e.getSnapshot().hasTag("loading")?new Promise((r,n)=>{let i=setTimeout(()=>n("The state machine is not yet ready after 15 seconds."),15e3);e.onTransition(s=>{if(!s.hasTag("loading"))return clearTimeout(i),r(e)})}):Promise.resolve(e)}isReady(){var e,r;return!((r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())!=null&&r.hasTag("loading"))}get client(){return this._client}}var So=typeof self=="object"?self.FormData:window.FormData;const Wn=lr(So);let Qn=globalThis.fetch;typeof EdgeRuntime!="string"&&(Qn=hr().fetch);const wr=async(t,e,{accessToken:r,name:n,fileId:i,bucketId:s,adminSecret:o,onUploadProgress:c,headers:a={}}={})=>{var u;const l={...a};s&&e.append("bucket-id",s),o&&(l["x-hasura-admin-secret"]=o),r&&(l.Authorization=`Bearer ${r}`);const h=`${t}/files`;if(typeof XMLHttpRequest=="undefined")try{const d=await Qn(h,{method:"POST",headers:l,body:e}),f=await d.json();return d.ok?{fileMetadata:f,error:null}:{error:{status:d.status,message:((u=f==null?void 0:f.error)==null?void 0:u.message)||d.statusText,error:d.statusText},fileMetadata:null}}catch(d){return{error:{status:0,message:d.message,error:d.message},fileMetadata:null}}return new Promise(d=>{let f=new XMLHttpRequest;f.responseType="json",f.onload=()=>{var p,m,w,E,x;return f.status<200||f.status>=300?d({fileMetadata:null,error:{error:(m=(p=f.response)==null?void 0:p.error)!=null?m:f.response,message:(x=(E=(w=f.response)==null?void 0:w.error)==null?void 0:E.message)!=null?x:f.response,status:f.status}}):d({fileMetadata:f.response,error:null})},f.onerror=()=>d({fileMetadata:null,error:{error:f.statusText,message:f.statusText,status:f.status}}),c&&f.upload.addEventListener("progress",c,!1),f.open("POST",h,!0),Object.entries(l).forEach(([p,m])=>{f.setRequestHeader(p,m)}),f.send(e)})},{fetch:Xn}=hr();let To=class{constructor({url:e}){this.url=e}async uploadFormData({formData:e,headers:r,bucketId:n}){const{error:i,fileMetadata:s}=await wr(this.url,e,{accessToken:this.accessToken,adminSecret:this.adminSecret,bucketId:n,headers:r});return i?{fileMetadata:null,error:i}:s&&!("processedFiles"in s)?{fileMetadata:{processedFiles:[s]},error:null}:{fileMetadata:s,error:null}}async uploadFile({file:e,bucketId:r,id:n,name:i}){const s=new Wn;s.append("file[]",e),s.append("metadata[]",JSON.stringify({id:n,name:i}));const{error:o,fileMetadata:c}=await wr(this.url,s,{accessToken:this.accessToken,adminSecret:this.adminSecret,bucketId:r,fileId:n,name:i});return o?{fileMetadata:null,error:o}:c&&"processedFiles"in c?{fileMetadata:c.processedFiles[0],error:null}:{fileMetadata:c,error:null}}async getPresignedUrl(e){try{const{fileId:r}=e,n=await Xn(`${this.url}/files/${r}/presignedurl`,{method:"GET",headers:this.generateAuthHeaders()});if(!n.ok)throw new Error(await n.text());return{presignedUrl:await n.json(),error:null}}catch(r){return{presignedUrl:null,error:r}}}async delete(e){try{const{fileId:r}=e,n=await Xn(`${this.url}/files/${r}`,{method:"DELETE",headers:this.generateAuthHeaders()});if(!n.ok)throw new Error(await n.text());return{error:null}}catch(r){return{error:r}}}setAccessToken(e){return this.accessToken=e,this}setAdminSecret(e){return this.adminSecret=e,this}generateAuthHeaders(){if(!(!this.adminSecret&&!this.accessToken))return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:{Authorization:`Bearer ${this.accessToken}`}}};function Zn(t,e){if(!e||Object.keys(e).length===0)return t;const r=new URL(t),n=Object.entries(e).reduce((i,[s,o])=>({...i,[s.charAt(0)]:o}),{});return Object.entries(n).forEach(([i,s])=>{s&&r.searchParams.set(i,s)}),r.toString()}let wo=class{constructor({url:e,adminSecret:r}){this.url=e,this.api=new To({url:e}),this.setAdminSecret(r)}async upload(e){return"file"in e?this.api.uploadFile(e):this.api.uploadFormData(e)}getPublicUrl(e){const{fileId:r,...n}=e;return Zn(`${this.url}/files/${r}`,n)}async getPresignedUrl(e){const{fileId:r,...n}=e,{presignedUrl:i,error:s}=await this.api.getPresignedUrl(e);if(s)return{presignedUrl:null,error:s};if(!i)return{presignedUrl:null,error:new Error("Invalid file id")};const o=Zn(i.url,n);return{presignedUrl:{...i,url:o},error:null}}async delete(e){const{error:r}=await this.api.delete(e);return r?{error:r}:{error:null}}setAccessToken(e){return this.api.setAccessToken(e),this}setAdminSecret(e){return this.api.setAdminSecret(e),this}};const br={progress:null,loaded:0,error:null,bucketId:void 0,file:void 0,id:void 0},ei=()=>Ae({predictableActionArguments:!0,schema:{context:{},events:{}},tsTypes:{},context:{...br},initial:"idle",on:{DESTROY:{actions:"sendDestroy",target:"stopped"}},states:{idle:{on:{ADD:{actions:"addFile"},UPLOAD:{cond:"hasFile",target:"uploading"}}},uploading:{entry:"resetProgress",on:{UPLOAD_PROGRESS:{actions:["incrementProgress","sendProgress"]},UPLOAD_DONE:"uploaded",UPLOAD_ERROR:"error",CANCEL:"idle"},invoke:{src:"uploadFile"}},uploaded:{entry:["setFileMetadata","sendDone"],on:{ADD:{actions:"addFile",target:"idle"},UPLOAD:{actions:"resetContext",target:"uploading"}}},error:{entry:["setError","sendError"],on:{ADD:{actions:"addFile",target:"idle"},UPLOAD:{actions:"resetContext",target:"uploading"}}},stopped:{type:"final"}}},{guards:{hasFile:(t,e)=>!!t.file||!!e.file},actions:{incrementProgress:j({loaded:(t,{loaded:e})=>e,progress:(t,{progress:e})=>e}),setFileMetadata:j({id:(t,{id:e})=>e,bucketId:(t,{bucketId:e})=>e,progress:t=>100}),setError:j({error:(t,{error:e})=>e}),sendProgress:()=>{},sendError:()=>{},sendDestroy:()=>{},sendDone:()=>{},resetProgress:j({progress:t=>null,loaded:t=>0}),resetContext:j(t=>br),addFile:j({file:(t,{file:e})=>e,bucketId:(t,{bucketId:e})=>e,id:(t,{id:e})=>e})},services:{uploadFile:(t,e)=>r=>{const n=e.file||t.file,i=new Wn;i.append("file[]",n);let s=0;return wr(e.url,i,{fileId:e.id||t.id,bucketId:e.bucketId||t.bucketId,accessToken:e.accessToken,adminSecret:e.adminSecret,name:e.name||n.name,onUploadProgress:o=>{const c=o.total?Math.round(o.loaded*n.size/o.total):0,a=c-s;s=c,r({type:"UPLOAD_PROGRESS",progress:o.total?Math.round(c*100/o.total):0,loaded:c,additions:a})}}).then(({fileMetadata:o,error:c})=>{if(c&&r({type:"UPLOAD_ERROR",error:c}),o&&!("processedFiles"in o)){const{id:a,bucketId:u}=o;r({type:"UPLOAD_DONE",id:a,bucketId:u})}if(o&&"processedFiles"in o){const{id:a,bucketId:u}=o.processedFiles[0];r({type:"UPLOAD_DONE",id:a,bucketId:u})}}),()=>{}}}}),{pure:xr,sendParent:Mt}=fs,bo=()=>Ae({id:"files-list",schema:{context:{},events:{}},tsTypes:{},predictableActionArguments:!0,context:{progress:null,files:[],loaded:0,total:0},initial:"idle",on:{UPLOAD:{cond:"hasFileToDownload",actions:"addItem",target:"uploading"},ADD:{actions:"addItem"},REMOVE:{actions:"removeItem"}},states:{idle:{entry:["resetProgress","resetLoaded","resetTotal"],on:{CLEAR:{actions:"clearList",target:"idle"}}},uploading:{entry:["upload","startProgress","resetLoaded","resetTotal"],on:{UPLOAD_PROGRESS:{actions:["incrementProgress"]},UPLOAD_DONE:[{cond:"isAllUploaded",target:"uploaded"},{cond:"isAllUploadedOrError",target:"error"}],UPLOAD_ERROR:[{cond:"isAllUploaded",target:"uploaded"},{cond:"isAllUploadedOrError",target:"error"}],CANCEL:{actions:"cancel",target:"idle"}}},uploaded:{entry:"setUploaded",on:{CLEAR:{actions:"clearList",target:"idle"}}},error:{on:{CLEAR:{actions:"clearList",target:"idle"}}}}},{guards:{hasFileToDownload:(t,e)=>t.files.some(r=>r.getSnapshot().matches("idle"))||!!e.files,isAllUploaded:t=>t.files.every(e=>{var r;return(r=e.getSnapshot())==null?void 0:r.matches("uploaded")}),isAllUploadedOrError:t=>t.files.every(e=>{const r=e.getSnapshot();return(r==null?void 0:r.matches("error"))||(r==null?void 0:r.matches("uploaded"))})},actions:{incrementProgress:j((t,e)=>{const r=t.loaded+e.additions,n=Math.round(r*100/t.total);return{...t,loaded:r,progress:n}}),setUploaded:j({progress:t=>100,loaded:({files:t})=>t.map(e=>e.getSnapshot()).filter(e=>e.matches("uploaded")).reduce((e,r)=>{var n;return e+((n=r.context.file)==null?void 0:n.size)},0)}),resetTotal:j({total:({files:t})=>t.map(e=>e.getSnapshot()).filter(e=>!e.matches("uploaded")).reduce((e,r)=>{var n;return e+((n=r.context.file)==null?void 0:n.size)},0)}),resetLoaded:j({loaded:t=>0}),startProgress:j({progress:t=>0}),resetProgress:j({progress:t=>null}),addItem:j((t,{files:e,bucketId:r})=>{const n=e?Array.isArray(e)?e:"item"in e?Array.from(e):[e]:[],i=t.total+n.reduce((o,c)=>o+c.size,0),s=Math.round(t.loaded*100/i);return{files:[...t.files,...n.map(o=>Ds(ei().withConfig({actions:{sendProgress:Mt((c,{additions:a})=>({type:"UPLOAD_PROGRESS",additions:a})),sendDone:Mt("UPLOAD_DONE"),sendError:Mt("UPLOAD_ERROR"),sendDestroy:Mt("REMOVE")}}).withContext({...br,file:o,bucketId:r}),{sync:!0}))],total:i,loaded:t.loaded,progress:s}}),removeItem:j({files:t=>t.files.filter(e=>{var r,n;const i=(r=e.getSnapshot())==null?void 0:r.matches("stopped");return i&&((n=e.stop)==null||n.call(e)),!i})}),clearList:xr(t=>t.files.map(e=>ie({type:"DESTROY"},{to:e.id}))),upload:xr((t,e)=>t.files.map(r=>ie(e,{to:r.id}))),cancel:xr(t=>t.files.map(e=>ie({type:"CANCEL"},{to:e.id})))}}),xo=async(t,e)=>new Promise(r=>{e.send({type:"UPLOAD",...t}),e.subscribe(n=>{var i;n.matches("error")?r({error:n.context.error,isError:!0,isUploaded:!1}):n.matches("uploaded")&&r({error:null,isError:!1,isUploaded:!0,id:n.context.id,bucketId:n.context.id,name:(i=n.context.file)==null?void 0:i.name})})}),Ao=async(t,e)=>new Promise(r=>{e.send({type:"UPLOAD",...t,files:t.files}),e.onTransition(n=>{n.matches("error")?r({errors:n.context.files.filter(i=>{var s;return(s=i.getSnapshot())==null?void 0:s.context.error}),isError:!0,files:[]}):n.matches("uploaded")&&r({errors:[],isError:!1,files:n.context.files})})});function Oo(t,e){return e=e||{},new Promise(function(r,n){var i=new XMLHttpRequest,s=[],o=[],c={},a=function(){return{ok:(i.status/100|0)==2,statusText:i.statusText,status:i.status,url:i.responseURL,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(i.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([i.response]))},clone:a,headers:{keys:function(){return s},entries:function(){return o},get:function(l){return c[l.toLowerCase()]},has:function(l){return l.toLowerCase()in c}}}};for(var u in i.open(e.method||"get",t,!0),i.onload=function(){i.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(l,h,d){s.push(h=h.toLowerCase()),o.push([h,d]),c[h]=c[h]?c[h]+","+d:d}),r(a())},i.onerror=n,i.withCredentials=e.credentials=="include",e.headers)i.setRequestHeader(u,e.headers[u]);i.send(e.body||null)})}const ti=Ms(Object.freeze(Object.defineProperty({__proto__:null,default:Oo},Symbol.toStringTag,{value:"Module"})));var Io=self.fetch||(self.fetch=ti.default||ti);const ri=lr(Io);function jt(t,e){if(!!!t)throw new Error(e)}function ko(t){return typeof t=="object"&&t!==null}function _o(t,e){if(!!!t)throw new Error(e!=null?e:"Unexpected invariant triggered.")}const No=/\r\n|[\n\r]/g;function Ar(t,e){let r=0,n=1;for(const i of t.body.matchAll(No)){if(typeof i.index=="number"||_o(!1),i.index>=e)break;r=i.index+i[0].length,n+=1}return{line:n,column:e+1-r}}function Do(t){return ni(t.source,Ar(t.source,t.start))}function ni(t,e){const r=t.locationOffset.column-1,n="".padStart(r)+t.body,i=e.line-1,s=t.locationOffset.line-1,o=e.line+s,c=e.line===1?r:0,a=e.column+c,u=`${t.name}:${o}:${a}
`,l=n.split(/\r\n|[\n\r]/g),h=l[i];if(h.length>120){const d=Math.floor(a/80),f=a%80,p=[];for(let m=0;m<h.length;m+=80)p.push(h.slice(m,m+80));return u+ii([[`${o} |`,p[0]],...p.slice(1,d+1).map(m=>["|",m]),["|","^".padStart(f)],["|",p[d+1]]])}return u+ii([[`${o-1} |`,l[i-1]],[`${o} |`,h],["|","^".padStart(a)],[`${o+1} |`,l[i+1]]])}function ii(t){const e=t.filter(([n,i])=>i!==void 0),r=Math.max(...e.map(([n])=>n.length));return e.map(([n,i])=>n.padStart(r)+(i?" "+i:"")).join(`
`)}function Ro(t){const e=t[0];return e==null||"kind"in e||"length"in e?{nodes:e,source:t[1],positions:t[2],path:t[3],originalError:t[4],extensions:t[5]}:e}class Or extends Error{constructor(e,...r){var n,i,s;const{nodes:o,source:c,positions:a,path:u,originalError:l,extensions:h}=Ro(r);super(e),this.name="GraphQLError",this.path=u!=null?u:void 0,this.originalError=l!=null?l:void 0,this.nodes=si(Array.isArray(o)?o:o?[o]:void 0);const d=si((n=this.nodes)===null||n===void 0?void 0:n.map(p=>p.loc).filter(p=>p!=null));this.source=c!=null?c:d==null||(i=d[0])===null||i===void 0?void 0:i.source,this.positions=a!=null?a:d==null?void 0:d.map(p=>p.start),this.locations=a&&c?a.map(p=>Ar(c,p)):d==null?void 0:d.map(p=>Ar(p.source,p.start));const f=ko(l==null?void 0:l.extensions)?l==null?void 0:l.extensions:void 0;this.extensions=(s=h!=null?h:f)!==null&&s!==void 0?s:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),l!=null&&l.stack?Object.defineProperty(this,"stack",{value:l.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,Or):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let e=this.message;if(this.nodes)for(const r of this.nodes)r.loc&&(e+=`

`+Do(r.loc));else if(this.source&&this.locations)for(const r of this.locations)e+=`

`+ni(this.source,r);return e}toJSON(){const e={message:this.message};return this.locations!=null&&(e.locations=this.locations),this.path!=null&&(e.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(e.extensions=this.extensions),e}}function si(t){return t===void 0||t.length===0?void 0:t}function se(t,e,r){return new Or(`Syntax Error: ${r}`,{source:t,positions:[e]})}class Co{constructor(e,r,n){this.start=e.start,this.end=r.end,this.startToken=e,this.endToken=r,this.source=n}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class oi{constructor(e,r,n,i,s,o){this.kind=e,this.start=r,this.end=n,this.line=i,this.column=s,this.value=o,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const ai={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},Po=new Set(Object.keys(ai));function ci(t){const e=t==null?void 0:t.kind;return typeof e=="string"&&Po.has(e)}var ze;(function(t){t.QUERY="query",t.MUTATION="mutation",t.SUBSCRIPTION="subscription"})(ze||(ze={}));var Ir;(function(t){t.QUERY="QUERY",t.MUTATION="MUTATION",t.SUBSCRIPTION="SUBSCRIPTION",t.FIELD="FIELD",t.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",t.FRAGMENT_SPREAD="FRAGMENT_SPREAD",t.INLINE_FRAGMENT="INLINE_FRAGMENT",t.VARIABLE_DEFINITION="VARIABLE_DEFINITION",t.SCHEMA="SCHEMA",t.SCALAR="SCALAR",t.OBJECT="OBJECT",t.FIELD_DEFINITION="FIELD_DEFINITION",t.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",t.INTERFACE="INTERFACE",t.UNION="UNION",t.ENUM="ENUM",t.ENUM_VALUE="ENUM_VALUE",t.INPUT_OBJECT="INPUT_OBJECT",t.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(Ir||(Ir={}));var R;(function(t){t.NAME="Name",t.DOCUMENT="Document",t.OPERATION_DEFINITION="OperationDefinition",t.VARIABLE_DEFINITION="VariableDefinition",t.SELECTION_SET="SelectionSet",t.FIELD="Field",t.ARGUMENT="Argument",t.FRAGMENT_SPREAD="FragmentSpread",t.INLINE_FRAGMENT="InlineFragment",t.FRAGMENT_DEFINITION="FragmentDefinition",t.VARIABLE="Variable",t.INT="IntValue",t.FLOAT="FloatValue",t.STRING="StringValue",t.BOOLEAN="BooleanValue",t.NULL="NullValue",t.ENUM="EnumValue",t.LIST="ListValue",t.OBJECT="ObjectValue",t.OBJECT_FIELD="ObjectField",t.DIRECTIVE="Directive",t.NAMED_TYPE="NamedType",t.LIST_TYPE="ListType",t.NON_NULL_TYPE="NonNullType",t.SCHEMA_DEFINITION="SchemaDefinition",t.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",t.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",t.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",t.FIELD_DEFINITION="FieldDefinition",t.INPUT_VALUE_DEFINITION="InputValueDefinition",t.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",t.UNION_TYPE_DEFINITION="UnionTypeDefinition",t.ENUM_TYPE_DEFINITION="EnumTypeDefinition",t.ENUM_VALUE_DEFINITION="EnumValueDefinition",t.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",t.DIRECTIVE_DEFINITION="DirectiveDefinition",t.SCHEMA_EXTENSION="SchemaExtension",t.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",t.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",t.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",t.UNION_TYPE_EXTENSION="UnionTypeExtension",t.ENUM_TYPE_EXTENSION="EnumTypeExtension",t.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(R||(R={}));function kr(t){return t===9||t===32}function ot(t){return t>=48&&t<=57}function ui(t){return t>=97&&t<=122||t>=65&&t<=90}function li(t){return ui(t)||t===95}function Lo(t){return ui(t)||ot(t)||t===95}function Uo(t){var e;let r=Number.MAX_SAFE_INTEGER,n=null,i=-1;for(let o=0;o<t.length;++o){var s;const c=t[o],a=Mo(c);a!==c.length&&(n=(s=n)!==null&&s!==void 0?s:o,i=o,o!==0&&a<r&&(r=a))}return t.map((o,c)=>c===0?o:o.slice(r)).slice((e=n)!==null&&e!==void 0?e:0,i+1)}function Mo(t){let e=0;for(;e<t.length&&kr(t.charCodeAt(e));)++e;return e}function jo(t,e){const r=t.replace(/"""/g,'\\"""'),n=r.split(/\r\n|[\n\r]/g),i=n.length===1,s=n.length>1&&n.slice(1).every(f=>f.length===0||kr(f.charCodeAt(0))),o=r.endsWith('\\"""'),c=t.endsWith('"')&&!o,a=t.endsWith("\\"),u=c||a,l=!(e!=null&&e.minimize)&&(!i||t.length>70||u||s||o);let h="";const d=i&&kr(t.charCodeAt(0));return(l&&!d||s)&&(h+=`
`),h+=r,(l||u)&&(h+=`
`),'"""'+h+'"""'}var y;(function(t){t.SOF="<SOF>",t.EOF="<EOF>",t.BANG="!",t.DOLLAR="$",t.AMP="&",t.PAREN_L="(",t.PAREN_R=")",t.SPREAD="...",t.COLON=":",t.EQUALS="=",t.AT="@",t.BRACKET_L="[",t.BRACKET_R="]",t.BRACE_L="{",t.PIPE="|",t.BRACE_R="}",t.NAME="Name",t.INT="Int",t.FLOAT="Float",t.STRING="String",t.BLOCK_STRING="BlockString",t.COMMENT="Comment"})(y||(y={}));class Fo{constructor(e){const r=new oi(y.SOF,0,0,0,0);this.source=e,this.lastToken=r,this.token=r,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let e=this.token;if(e.kind!==y.EOF)do if(e.next)e=e.next;else{const r=Bo(this,e.end);e.next=r,r.prev=e,e=r}while(e.kind===y.COMMENT);return e}}function Vo(t){return t===y.BANG||t===y.DOLLAR||t===y.AMP||t===y.PAREN_L||t===y.PAREN_R||t===y.SPREAD||t===y.COLON||t===y.EQUALS||t===y.AT||t===y.BRACKET_L||t===y.BRACKET_R||t===y.BRACE_L||t===y.PIPE||t===y.BRACE_R}function Ke(t){return t>=0&&t<=55295||t>=57344&&t<=1114111}function Ft(t,e){return di(t.charCodeAt(e))&&hi(t.charCodeAt(e+1))}function di(t){return t>=55296&&t<=56319}function hi(t){return t>=56320&&t<=57343}function Me(t,e){const r=t.source.body.codePointAt(e);if(r===void 0)return y.EOF;if(r>=32&&r<=126){const n=String.fromCodePoint(r);return n==='"'?`'"'`:`"${n}"`}return"U+"+r.toString(16).toUpperCase().padStart(4,"0")}function ee(t,e,r,n,i){const s=t.line,o=1+r-t.lineStart;return new oi(e,r,n,s,o,i)}function Bo(t,e){const r=t.source.body,n=r.length;let i=e;for(;i<n;){const s=r.charCodeAt(i);switch(s){case 65279:case 9:case 32:case 44:++i;continue;case 10:++i,++t.line,t.lineStart=i;continue;case 13:r.charCodeAt(i+1)===10?i+=2:++i,++t.line,t.lineStart=i;continue;case 35:return Go(t,i);case 33:return ee(t,y.BANG,i,i+1);case 36:return ee(t,y.DOLLAR,i,i+1);case 38:return ee(t,y.AMP,i,i+1);case 40:return ee(t,y.PAREN_L,i,i+1);case 41:return ee(t,y.PAREN_R,i,i+1);case 46:if(r.charCodeAt(i+1)===46&&r.charCodeAt(i+2)===46)return ee(t,y.SPREAD,i,i+3);break;case 58:return ee(t,y.COLON,i,i+1);case 61:return ee(t,y.EQUALS,i,i+1);case 64:return ee(t,y.AT,i,i+1);case 91:return ee(t,y.BRACKET_L,i,i+1);case 93:return ee(t,y.BRACKET_R,i,i+1);case 123:return ee(t,y.BRACE_L,i,i+1);case 124:return ee(t,y.PIPE,i,i+1);case 125:return ee(t,y.BRACE_R,i,i+1);case 34:return r.charCodeAt(i+1)===34&&r.charCodeAt(i+2)===34?Ko(t,i):qo(t,i)}if(ot(s)||s===45)return $o(t,i,s);if(li(s))return Jo(t,i);throw se(t.source,i,s===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:Ke(s)||Ft(r,i)?`Unexpected character: ${Me(t,i)}.`:`Invalid character: ${Me(t,i)}.`)}return ee(t,y.EOF,n,n)}function Go(t,e){const r=t.source.body,n=r.length;let i=e+1;for(;i<n;){const s=r.charCodeAt(i);if(s===10||s===13)break;if(Ke(s))++i;else if(Ft(r,i))i+=2;else break}return ee(t,y.COMMENT,e,i,r.slice(e+1,i))}function $o(t,e,r){const n=t.source.body;let i=e,s=r,o=!1;if(s===45&&(s=n.charCodeAt(++i)),s===48){if(s=n.charCodeAt(++i),ot(s))throw se(t.source,i,`Invalid number, unexpected digit after 0: ${Me(t,i)}.`)}else i=_r(t,i,s),s=n.charCodeAt(i);if(s===46&&(o=!0,s=n.charCodeAt(++i),i=_r(t,i,s),s=n.charCodeAt(i)),(s===69||s===101)&&(o=!0,s=n.charCodeAt(++i),(s===43||s===45)&&(s=n.charCodeAt(++i)),i=_r(t,i,s),s=n.charCodeAt(i)),s===46||li(s))throw se(t.source,i,`Invalid number, expected digit but got: ${Me(t,i)}.`);return ee(t,o?y.FLOAT:y.INT,e,i,n.slice(e,i))}function _r(t,e,r){if(!ot(r))throw se(t.source,e,`Invalid number, expected digit but got: ${Me(t,e)}.`);const n=t.source.body;let i=e+1;for(;ot(n.charCodeAt(i));)++i;return i}function qo(t,e){const r=t.source.body,n=r.length;let i=e+1,s=i,o="";for(;i<n;){const c=r.charCodeAt(i);if(c===34)return o+=r.slice(s,i),ee(t,y.STRING,e,i+1,o);if(c===92){o+=r.slice(s,i);const a=r.charCodeAt(i+1)===117?r.charCodeAt(i+2)===123?Yo(t,i):Ho(t,i):zo(t,i);o+=a.value,i+=a.size,s=i;continue}if(c===10||c===13)break;if(Ke(c))++i;else if(Ft(r,i))i+=2;else throw se(t.source,i,`Invalid character within String: ${Me(t,i)}.`)}throw se(t.source,i,"Unterminated string.")}function Yo(t,e){const r=t.source.body;let n=0,i=3;for(;i<12;){const s=r.charCodeAt(e+i++);if(s===125){if(i<5||!Ke(n))break;return{value:String.fromCodePoint(n),size:i}}if(n=n<<4|at(s),n<0)break}throw se(t.source,e,`Invalid Unicode escape sequence: "${r.slice(e,e+i)}".`)}function Ho(t,e){const r=t.source.body,n=fi(r,e+2);if(Ke(n))return{value:String.fromCodePoint(n),size:6};if(di(n)&&r.charCodeAt(e+6)===92&&r.charCodeAt(e+7)===117){const i=fi(r,e+8);if(hi(i))return{value:String.fromCodePoint(n,i),size:12}}throw se(t.source,e,`Invalid Unicode escape sequence: "${r.slice(e,e+6)}".`)}function fi(t,e){return at(t.charCodeAt(e))<<12|at(t.charCodeAt(e+1))<<8|at(t.charCodeAt(e+2))<<4|at(t.charCodeAt(e+3))}function at(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-55:t>=97&&t<=102?t-87:-1}function zo(t,e){const r=t.source.body;switch(r.charCodeAt(e+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw se(t.source,e,`Invalid character escape sequence: "${r.slice(e,e+2)}".`)}function Ko(t,e){const r=t.source.body,n=r.length;let i=t.lineStart,s=e+3,o=s,c="";const a=[];for(;s<n;){const u=r.charCodeAt(s);if(u===34&&r.charCodeAt(s+1)===34&&r.charCodeAt(s+2)===34){c+=r.slice(o,s),a.push(c);const l=ee(t,y.BLOCK_STRING,e,s+3,Uo(a).join(`
`));return t.line+=a.length-1,t.lineStart=i,l}if(u===92&&r.charCodeAt(s+1)===34&&r.charCodeAt(s+2)===34&&r.charCodeAt(s+3)===34){c+=r.slice(o,s),o=s+1,s+=4;continue}if(u===10||u===13){c+=r.slice(o,s),a.push(c),u===13&&r.charCodeAt(s+1)===10?s+=2:++s,c="",o=s,i=s;continue}if(Ke(u))++s;else if(Ft(r,s))s+=2;else throw se(t.source,s,`Invalid character within String: ${Me(t,s)}.`)}throw se(t.source,s,"Unterminated string.")}function Jo(t,e){const r=t.source.body,n=r.length;let i=e+1;for(;i<n;){const s=r.charCodeAt(i);if(Lo(s))++i;else break}return ee(t,y.NAME,e,i,r.slice(e,i))}const Wo=10,pi=2;function Nr(t){return Vt(t,[])}function Vt(t,e){switch(typeof t){case"string":return JSON.stringify(t);case"function":return t.name?`[function ${t.name}]`:"[function]";case"object":return Qo(t,e);default:return String(t)}}function Qo(t,e){if(t===null)return"null";if(e.includes(t))return"[Circular]";const r=[...e,t];if(Xo(t)){const n=t.toJSON();if(n!==t)return typeof n=="string"?n:Vt(n,r)}else if(Array.isArray(t))return ea(t,r);return Zo(t,r)}function Xo(t){return typeof t.toJSON=="function"}function Zo(t,e){const r=Object.entries(t);return r.length===0?"{}":e.length>pi?"["+ta(t)+"]":"{ "+r.map(([i,s])=>i+": "+Vt(s,e)).join(", ")+" }"}function ea(t,e){if(t.length===0)return"[]";if(e.length>pi)return"[Array]";const r=Math.min(Wo,t.length),n=t.length-r,i=[];for(let s=0;s<r;++s)i.push(Vt(t[s],e));return n===1?i.push("... 1 more item"):n>1&&i.push(`... ${n} more items`),"["+i.join(", ")+"]"}function ta(t){const e=Object.prototype.toString.call(t).replace(/^\[object /,"").replace(/]$/,"");if(e==="Object"&&typeof t.constructor=="function"){const r=t.constructor.name;if(typeof r=="string"&&r!=="")return r}return e}const ra=globalThis.process&&globalThis.process.env.NODE_ENV==="production"?function(e,r){return e instanceof r}:function(e,r){if(e instanceof r)return!0;if(typeof e=="object"&&e!==null){var n;const i=r.prototype[Symbol.toStringTag],s=Symbol.toStringTag in e?e[Symbol.toStringTag]:(n=e.constructor)===null||n===void 0?void 0:n.name;if(i===s){const o=Nr(e);throw new Error(`Cannot use ${i} "${o}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class vi{constructor(e,r="GraphQL request",n={line:1,column:1}){typeof e=="string"||jt(!1,`Body must be a string. Received: ${Nr(e)}.`),this.body=e,this.name=r,this.locationOffset=n,this.locationOffset.line>0||jt(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||jt(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function na(t){return ra(t,vi)}function ia(t,e){return new sa(t,e).parseDocument()}class sa{constructor(e,r={}){const n=na(e)?e:new vi(e);this._lexer=new Fo(n),this._options=r,this._tokenCounter=0}parseName(){const e=this.expectToken(y.NAME);return this.node(e,{kind:R.NAME,value:e.value})}parseDocument(){return this.node(this._lexer.token,{kind:R.DOCUMENT,definitions:this.many(y.SOF,this.parseDefinition,y.EOF)})}parseDefinition(){if(this.peek(y.BRACE_L))return this.parseOperationDefinition();const e=this.peekDescription(),r=e?this._lexer.lookahead():this._lexer.token;if(r.kind===y.NAME){switch(r.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(e)throw se(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(r.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(r)}parseOperationDefinition(){const e=this._lexer.token;if(this.peek(y.BRACE_L))return this.node(e,{kind:R.OPERATION_DEFINITION,operation:ze.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const r=this.parseOperationType();let n;return this.peek(y.NAME)&&(n=this.parseName()),this.node(e,{kind:R.OPERATION_DEFINITION,operation:r,name:n,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const e=this.expectToken(y.NAME);switch(e.value){case"query":return ze.QUERY;case"mutation":return ze.MUTATION;case"subscription":return ze.SUBSCRIPTION}throw this.unexpected(e)}parseVariableDefinitions(){return this.optionalMany(y.PAREN_L,this.parseVariableDefinition,y.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:R.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(y.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(y.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const e=this._lexer.token;return this.expectToken(y.DOLLAR),this.node(e,{kind:R.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:R.SELECTION_SET,selections:this.many(y.BRACE_L,this.parseSelection,y.BRACE_R)})}parseSelection(){return this.peek(y.SPREAD)?this.parseFragment():this.parseField()}parseField(){const e=this._lexer.token,r=this.parseName();let n,i;return this.expectOptionalToken(y.COLON)?(n=r,i=this.parseName()):i=r,this.node(e,{kind:R.FIELD,alias:n,name:i,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(y.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(e){const r=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(y.PAREN_L,r,y.PAREN_R)}parseArgument(e=!1){const r=this._lexer.token,n=this.parseName();return this.expectToken(y.COLON),this.node(r,{kind:R.ARGUMENT,name:n,value:this.parseValueLiteral(e)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const e=this._lexer.token;this.expectToken(y.SPREAD);const r=this.expectOptionalKeyword("on");return!r&&this.peek(y.NAME)?this.node(e,{kind:R.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(e,{kind:R.INLINE_FRAGMENT,typeCondition:r?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const e=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(e,{kind:R.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(e,{kind:R.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(e){const r=this._lexer.token;switch(r.kind){case y.BRACKET_L:return this.parseList(e);case y.BRACE_L:return this.parseObject(e);case y.INT:return this.advanceLexer(),this.node(r,{kind:R.INT,value:r.value});case y.FLOAT:return this.advanceLexer(),this.node(r,{kind:R.FLOAT,value:r.value});case y.STRING:case y.BLOCK_STRING:return this.parseStringLiteral();case y.NAME:switch(this.advanceLexer(),r.value){case"true":return this.node(r,{kind:R.BOOLEAN,value:!0});case"false":return this.node(r,{kind:R.BOOLEAN,value:!1});case"null":return this.node(r,{kind:R.NULL});default:return this.node(r,{kind:R.ENUM,value:r.value})}case y.DOLLAR:if(e)if(this.expectToken(y.DOLLAR),this._lexer.token.kind===y.NAME){const n=this._lexer.token.value;throw se(this._lexer.source,r.start,`Unexpected variable "$${n}" in constant value.`)}else throw this.unexpected(r);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const e=this._lexer.token;return this.advanceLexer(),this.node(e,{kind:R.STRING,value:e.value,block:e.kind===y.BLOCK_STRING})}parseList(e){const r=()=>this.parseValueLiteral(e);return this.node(this._lexer.token,{kind:R.LIST,values:this.any(y.BRACKET_L,r,y.BRACKET_R)})}parseObject(e){const r=()=>this.parseObjectField(e);return this.node(this._lexer.token,{kind:R.OBJECT,fields:this.any(y.BRACE_L,r,y.BRACE_R)})}parseObjectField(e){const r=this._lexer.token,n=this.parseName();return this.expectToken(y.COLON),this.node(r,{kind:R.OBJECT_FIELD,name:n,value:this.parseValueLiteral(e)})}parseDirectives(e){const r=[];for(;this.peek(y.AT);)r.push(this.parseDirective(e));return r}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(e){const r=this._lexer.token;return this.expectToken(y.AT),this.node(r,{kind:R.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e)})}parseTypeReference(){const e=this._lexer.token;let r;if(this.expectOptionalToken(y.BRACKET_L)){const n=this.parseTypeReference();this.expectToken(y.BRACKET_R),r=this.node(e,{kind:R.LIST_TYPE,type:n})}else r=this.parseNamedType();return this.expectOptionalToken(y.BANG)?this.node(e,{kind:R.NON_NULL_TYPE,type:r}):r}parseNamedType(){return this.node(this._lexer.token,{kind:R.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(y.STRING)||this.peek(y.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("schema");const n=this.parseConstDirectives(),i=this.many(y.BRACE_L,this.parseOperationTypeDefinition,y.BRACE_R);return this.node(e,{kind:R.SCHEMA_DEFINITION,description:r,directives:n,operationTypes:i})}parseOperationTypeDefinition(){const e=this._lexer.token,r=this.parseOperationType();this.expectToken(y.COLON);const n=this.parseNamedType();return this.node(e,{kind:R.OPERATION_TYPE_DEFINITION,operation:r,type:n})}parseScalarTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("scalar");const n=this.parseName(),i=this.parseConstDirectives();return this.node(e,{kind:R.SCALAR_TYPE_DEFINITION,description:r,name:n,directives:i})}parseObjectTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("type");const n=this.parseName(),i=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),o=this.parseFieldsDefinition();return this.node(e,{kind:R.OBJECT_TYPE_DEFINITION,description:r,name:n,interfaces:i,directives:s,fields:o})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(y.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(y.BRACE_L,this.parseFieldDefinition,y.BRACE_R)}parseFieldDefinition(){const e=this._lexer.token,r=this.parseDescription(),n=this.parseName(),i=this.parseArgumentDefs();this.expectToken(y.COLON);const s=this.parseTypeReference(),o=this.parseConstDirectives();return this.node(e,{kind:R.FIELD_DEFINITION,description:r,name:n,arguments:i,type:s,directives:o})}parseArgumentDefs(){return this.optionalMany(y.PAREN_L,this.parseInputValueDef,y.PAREN_R)}parseInputValueDef(){const e=this._lexer.token,r=this.parseDescription(),n=this.parseName();this.expectToken(y.COLON);const i=this.parseTypeReference();let s;this.expectOptionalToken(y.EQUALS)&&(s=this.parseConstValueLiteral());const o=this.parseConstDirectives();return this.node(e,{kind:R.INPUT_VALUE_DEFINITION,description:r,name:n,type:i,defaultValue:s,directives:o})}parseInterfaceTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("interface");const n=this.parseName(),i=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),o=this.parseFieldsDefinition();return this.node(e,{kind:R.INTERFACE_TYPE_DEFINITION,description:r,name:n,interfaces:i,directives:s,fields:o})}parseUnionTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("union");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseUnionMemberTypes();return this.node(e,{kind:R.UNION_TYPE_DEFINITION,description:r,name:n,directives:i,types:s})}parseUnionMemberTypes(){return this.expectOptionalToken(y.EQUALS)?this.delimitedMany(y.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("enum");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseEnumValuesDefinition();return this.node(e,{kind:R.ENUM_TYPE_DEFINITION,description:r,name:n,directives:i,values:s})}parseEnumValuesDefinition(){return this.optionalMany(y.BRACE_L,this.parseEnumValueDefinition,y.BRACE_R)}parseEnumValueDefinition(){const e=this._lexer.token,r=this.parseDescription(),n=this.parseEnumValueName(),i=this.parseConstDirectives();return this.node(e,{kind:R.ENUM_VALUE_DEFINITION,description:r,name:n,directives:i})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw se(this._lexer.source,this._lexer.token.start,`${Bt(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("input");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseInputFieldsDefinition();return this.node(e,{kind:R.INPUT_OBJECT_TYPE_DEFINITION,description:r,name:n,directives:i,fields:s})}parseInputFieldsDefinition(){return this.optionalMany(y.BRACE_L,this.parseInputValueDef,y.BRACE_R)}parseTypeSystemExtension(){const e=this._lexer.lookahead();if(e.kind===y.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)}parseSchemaExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const r=this.parseConstDirectives(),n=this.optionalMany(y.BRACE_L,this.parseOperationTypeDefinition,y.BRACE_R);if(r.length===0&&n.length===0)throw this.unexpected();return this.node(e,{kind:R.SCHEMA_EXTENSION,directives:r,operationTypes:n})}parseScalarTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const r=this.parseName(),n=this.parseConstDirectives();if(n.length===0)throw this.unexpected();return this.node(e,{kind:R.SCALAR_TYPE_EXTENSION,name:r,directives:n})}parseObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const r=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();if(n.length===0&&i.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:R.OBJECT_TYPE_EXTENSION,name:r,interfaces:n,directives:i,fields:s})}parseInterfaceTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const r=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();if(n.length===0&&i.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:R.INTERFACE_TYPE_EXTENSION,name:r,interfaces:n,directives:i,fields:s})}parseUnionTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const r=this.parseName(),n=this.parseConstDirectives(),i=this.parseUnionMemberTypes();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:R.UNION_TYPE_EXTENSION,name:r,directives:n,types:i})}parseEnumTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const r=this.parseName(),n=this.parseConstDirectives(),i=this.parseEnumValuesDefinition();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:R.ENUM_TYPE_EXTENSION,name:r,directives:n,values:i})}parseInputObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const r=this.parseName(),n=this.parseConstDirectives(),i=this.parseInputFieldsDefinition();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:R.INPUT_OBJECT_TYPE_EXTENSION,name:r,directives:n,fields:i})}parseDirectiveDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("directive"),this.expectToken(y.AT);const n=this.parseName(),i=this.parseArgumentDefs(),s=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const o=this.parseDirectiveLocations();return this.node(e,{kind:R.DIRECTIVE_DEFINITION,description:r,name:n,arguments:i,repeatable:s,locations:o})}parseDirectiveLocations(){return this.delimitedMany(y.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const e=this._lexer.token,r=this.parseName();if(Object.prototype.hasOwnProperty.call(Ir,r.value))return r;throw this.unexpected(e)}node(e,r){return this._options.noLocation!==!0&&(r.loc=new Co(e,this._lexer.lastToken,this._lexer.source)),r}peek(e){return this._lexer.token.kind===e}expectToken(e){const r=this._lexer.token;if(r.kind===e)return this.advanceLexer(),r;throw se(this._lexer.source,r.start,`Expected ${mi(e)}, found ${Bt(r)}.`)}expectOptionalToken(e){return this._lexer.token.kind===e?(this.advanceLexer(),!0):!1}expectKeyword(e){const r=this._lexer.token;if(r.kind===y.NAME&&r.value===e)this.advanceLexer();else throw se(this._lexer.source,r.start,`Expected "${e}", found ${Bt(r)}.`)}expectOptionalKeyword(e){const r=this._lexer.token;return r.kind===y.NAME&&r.value===e?(this.advanceLexer(),!0):!1}unexpected(e){const r=e!=null?e:this._lexer.token;return se(this._lexer.source,r.start,`Unexpected ${Bt(r)}.`)}any(e,r,n){this.expectToken(e);const i=[];for(;!this.expectOptionalToken(n);)i.push(r.call(this));return i}optionalMany(e,r,n){if(this.expectOptionalToken(e)){const i=[];do i.push(r.call(this));while(!this.expectOptionalToken(n));return i}return[]}many(e,r,n){this.expectToken(e);const i=[];do i.push(r.call(this));while(!this.expectOptionalToken(n));return i}delimitedMany(e,r){this.expectOptionalToken(e);const n=[];do n.push(r.call(this));while(this.expectOptionalToken(e));return n}advanceLexer(){const{maxTokens:e}=this._options,r=this._lexer.advance();if(e!==void 0&&r.kind!==y.EOF&&(++this._tokenCounter,this._tokenCounter>e))throw se(this._lexer.source,r.start,`Document contains more that ${e} tokens. Parsing aborted.`)}}function Bt(t){const e=t.value;return mi(t.kind)+(e!=null?` "${e}"`:"")}function mi(t){return Vo(t)?`"${t}"`:t}function oa(t){return`"${t.replace(aa,ca)}"`}const aa=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function ca(t){return ua[t.charCodeAt(0)]}const ua=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],la=Object.freeze({});function da(t,e,r=ai){const n=new Map;for(const E of Object.values(R))n.set(E,ha(e,E));let i,s=Array.isArray(t),o=[t],c=-1,a=[],u=t,l,h;const d=[],f=[];do{c++;const E=c===o.length,x=E&&a.length!==0;if(E){if(l=f.length===0?void 0:d[d.length-1],u=h,h=f.pop(),x)if(s){u=u.slice();let A=0;for(const[k,_]of a){const N=k-A;_===null?(u.splice(N,1),A++):u[N]=_}}else{u=Object.defineProperties({},Object.getOwnPropertyDescriptors(u));for(const[A,k]of a)u[A]=k}c=i.index,o=i.keys,a=i.edits,s=i.inArray,i=i.prev}else if(h){if(l=s?c:o[c],u=h[l],u==null)continue;d.push(l)}let S;if(!Array.isArray(u)){var p,m;ci(u)||jt(!1,`Invalid AST Node: ${Nr(u)}.`);const A=E?(p=n.get(u.kind))===null||p===void 0?void 0:p.leave:(m=n.get(u.kind))===null||m===void 0?void 0:m.enter;if(S=A==null?void 0:A.call(e,u,l,h,d,f),S===la)break;if(S===!1){if(!E){d.pop();continue}}else if(S!==void 0&&(a.push([l,S]),!E))if(ci(S))u=S;else{d.pop();continue}}if(S===void 0&&x&&a.push([l,u]),E)d.pop();else{var w;i={inArray:s,index:c,keys:o,edits:a,prev:i},s=Array.isArray(u),o=s?u:(w=r[u.kind])!==null&&w!==void 0?w:[],c=-1,a=[],h&&f.push(h),h=u}}while(i!==void 0);return a.length!==0?a[a.length-1][1]:t}function ha(t,e){const r=t[e];return typeof r=="object"?r:typeof r=="function"?{enter:r,leave:void 0}:{enter:t.enter,leave:t.leave}}function fa(t){return da(t,va)}const pa=80,va={Name:{leave:t=>t.value},Variable:{leave:t=>"$"+t.name},Document:{leave:t=>O(t.definitions,`

`)},OperationDefinition:{leave(t){const e=V("(",O(t.variableDefinitions,", "),")"),r=O([t.operation,O([t.name,e]),O(t.directives," ")]," ");return(r==="query"?"":r+" ")+t.selectionSet}},VariableDefinition:{leave:({variable:t,type:e,defaultValue:r,directives:n})=>t+": "+e+V(" = ",r)+V(" ",O(n," "))},SelectionSet:{leave:({selections:t})=>fe(t)},Field:{leave({alias:t,name:e,arguments:r,directives:n,selectionSet:i}){const s=V("",t,": ")+e;let o=s+V("(",O(r,", "),")");return o.length>pa&&(o=s+V(`(
`,Gt(O(r,`
`)),`
)`)),O([o,O(n," "),i]," ")}},Argument:{leave:({name:t,value:e})=>t+": "+e},FragmentSpread:{leave:({name:t,directives:e})=>"..."+t+V(" ",O(e," "))},InlineFragment:{leave:({typeCondition:t,directives:e,selectionSet:r})=>O(["...",V("on ",t),O(e," "),r]," ")},FragmentDefinition:{leave:({name:t,typeCondition:e,variableDefinitions:r,directives:n,selectionSet:i})=>`fragment ${t}${V("(",O(r,", "),")")} on ${e} ${V("",O(n," ")," ")}`+i},IntValue:{leave:({value:t})=>t},FloatValue:{leave:({value:t})=>t},StringValue:{leave:({value:t,block:e})=>e?jo(t):oa(t)},BooleanValue:{leave:({value:t})=>t?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:t})=>t},ListValue:{leave:({values:t})=>"["+O(t,", ")+"]"},ObjectValue:{leave:({fields:t})=>"{"+O(t,", ")+"}"},ObjectField:{leave:({name:t,value:e})=>t+": "+e},Directive:{leave:({name:t,arguments:e})=>"@"+t+V("(",O(e,", "),")")},NamedType:{leave:({name:t})=>t},ListType:{leave:({type:t})=>"["+t+"]"},NonNullType:{leave:({type:t})=>t+"!"},SchemaDefinition:{leave:({description:t,directives:e,operationTypes:r})=>V("",t,`
`)+O(["schema",O(e," "),fe(r)]," ")},OperationTypeDefinition:{leave:({operation:t,type:e})=>t+": "+e},ScalarTypeDefinition:{leave:({description:t,name:e,directives:r})=>V("",t,`
`)+O(["scalar",e,O(r," ")]," ")},ObjectTypeDefinition:{leave:({description:t,name:e,interfaces:r,directives:n,fields:i})=>V("",t,`
`)+O(["type",e,V("implements ",O(r," & ")),O(n," "),fe(i)]," ")},FieldDefinition:{leave:({description:t,name:e,arguments:r,type:n,directives:i})=>V("",t,`
`)+e+(yi(r)?V(`(
`,Gt(O(r,`
`)),`
)`):V("(",O(r,", "),")"))+": "+n+V(" ",O(i," "))},InputValueDefinition:{leave:({description:t,name:e,type:r,defaultValue:n,directives:i})=>V("",t,`
`)+O([e+": "+r,V("= ",n),O(i," ")]," ")},InterfaceTypeDefinition:{leave:({description:t,name:e,interfaces:r,directives:n,fields:i})=>V("",t,`
`)+O(["interface",e,V("implements ",O(r," & ")),O(n," "),fe(i)]," ")},UnionTypeDefinition:{leave:({description:t,name:e,directives:r,types:n})=>V("",t,`
`)+O(["union",e,O(r," "),V("= ",O(n," | "))]," ")},EnumTypeDefinition:{leave:({description:t,name:e,directives:r,values:n})=>V("",t,`
`)+O(["enum",e,O(r," "),fe(n)]," ")},EnumValueDefinition:{leave:({description:t,name:e,directives:r})=>V("",t,`
`)+O([e,O(r," ")]," ")},InputObjectTypeDefinition:{leave:({description:t,name:e,directives:r,fields:n})=>V("",t,`
`)+O(["input",e,O(r," "),fe(n)]," ")},DirectiveDefinition:{leave:({description:t,name:e,arguments:r,repeatable:n,locations:i})=>V("",t,`
`)+"directive @"+e+(yi(r)?V(`(
`,Gt(O(r,`
`)),`
)`):V("(",O(r,", "),")"))+(n?" repeatable":"")+" on "+O(i," | ")},SchemaExtension:{leave:({directives:t,operationTypes:e})=>O(["extend schema",O(t," "),fe(e)]," ")},ScalarTypeExtension:{leave:({name:t,directives:e})=>O(["extend scalar",t,O(e," ")]," ")},ObjectTypeExtension:{leave:({name:t,interfaces:e,directives:r,fields:n})=>O(["extend type",t,V("implements ",O(e," & ")),O(r," "),fe(n)]," ")},InterfaceTypeExtension:{leave:({name:t,interfaces:e,directives:r,fields:n})=>O(["extend interface",t,V("implements ",O(e," & ")),O(r," "),fe(n)]," ")},UnionTypeExtension:{leave:({name:t,directives:e,types:r})=>O(["extend union",t,O(e," "),V("= ",O(r," | "))]," ")},EnumTypeExtension:{leave:({name:t,directives:e,values:r})=>O(["extend enum",t,O(e," "),fe(r)]," ")},InputObjectTypeExtension:{leave:({name:t,directives:e,fields:r})=>O(["extend input",t,O(e," "),fe(r)]," ")}};function O(t,e=""){var r;return(r=t==null?void 0:t.filter(n=>n).join(e))!==null&&r!==void 0?r:""}function fe(t){return V(`{
`,Gt(O(t,`
`)),`
}`)}function V(t,e,r=""){return e!=null&&e!==""?t+e+r:""}function Gt(t){return V("  ",t.replace(/\n/g,`
  `))}function yi(t){var e;return(e=t==null?void 0:t.some(r=>r.includes(`
`)))!==null&&e!==void 0?e:!1}function ma(t,e,r){return t.document?t:{document:t,variables:e,config:r}}function gi(t){var e;let r;const n=t.definitions.filter(i=>i.kind==="OperationDefinition");return n.length===1&&(r=(e=n[0].name)==null?void 0:e.value),r}function ya(t){if(typeof t=="string"){let r;try{const n=ia(t);r=gi(n)}catch{}return{query:t,operationName:r}}const e=gi(t);return{query:fa(t),operationName:e}}class ga{constructor(e){const{url:r,adminSecret:n}=e;this._url=r,this.accessToken=null,this.adminSecret=n}async request(e,...r){const[n,i]=r,s=ma(e,n,i),{headers:o,...c}=i||{},{query:a,operationName:u}=ya(s.document);try{const l=await ri(this.httpUrl,{method:"POST",body:JSON.stringify({operationName:u,query:a,variables:n}),headers:{"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...o},...c});if(!l.ok)return{data:null,error:{error:l.statusText,message:l.statusText,status:l.status}};const{data:h,errors:d}=await l.json();return d?{data:null,error:d}:typeof h!="object"||Array.isArray(h)||h===null?{data:null,error:{error:"invalid-response",message:"incorrect response data from GraphQL server",status:0}}:{data:h,error:null}}catch(l){const h=l;return{data:null,error:{message:h.message,status:h.name==="AbortError"?0:500,error:h.name==="AbortError"?"abort-error":"unknown"}}}}get httpUrl(){return this._url}get wsUrl(){return this._url.replace(/^(http)(s?):\/\//,"ws$2://")}get url(){return this._url}getUrl(){return this._url}setAccessToken(e){if(!e){this.accessToken=null;return}this.accessToken=e}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}}const Ea=/^((?<protocol>http[s]?):\/\/)?(?<host>(localhost|local))(:(?<port>(\d+|__\w+__)))?$/;function $t(t,e){const{backendUrl:r,subdomain:n,region:i}=t;if(r)return`${r}/v1/${e}`;if(!n)throw new Error("Either `backendUrl` or `subdomain` must be set.");const s=n.match(Ea);if(s!=null&&s.groups){const{protocol:o,host:c,port:a}=s.groups;return wa(e)||(c==="localhost"?(console.warn('The `subdomain` is set to "localhost". Support for this will be removed in a future release. Please use "local" instead.'),`${o||"http"}://localhost:${a||1337}/v1/${e}`):a?`${o||"https"}://local.${e}.nhost.run:${a}/v1`:`${o||"https"}://local.${e}.nhost.run/v1`)}if(!i)throw new Error('`region` must be set when using a `subdomain` other than "local".');return`https://${n}.${e}.${i}.nhost.run/v1`}function Sa(){return typeof window!="undefined"}function Ta(){return typeof process!="undefined"&&process.env}function wa(t){return Sa()||!Ta()?null:process.env[`NHOST_${t.toUpperCase()}_URL`]}function ba(t,e){const r=e.startsWith("/")?e:`/${e}`;return t+r}function xa(t){const e="subdomain"in t||"backendUrl"in t?$t(t,"auth"):t.authUrl;if(!e)throw new Error("Please provide `subdomain` or `authUrl`.");return new Eo({url:e,...t})}function Aa(t){const e="subdomain"in t||"backendUrl"in t?$t(t,"functions"):t.functionsUrl;if(!e)throw new Error("Please provide `subdomain` or `functionsUrl`.");return new Oa({url:e,...t})}class Oa{constructor(e){const{url:r,adminSecret:n}=e;this.url=r,this.accessToken=null,this.adminSecret=n}async call(e,r,n){var i,s;const o={"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...n==null?void 0:n.headers},c=ba(this.url,e);try{const a=await ri(c,{body:r?JSON.stringify(r):null,headers:o,method:"POST"});if(!a.ok){let l;return(i=a.headers.get("content-type"))!=null&&i.includes("application/json")?l=await a.json():l=await a.text(),{res:null,error:{message:l,error:a.statusText,status:a.status}}}let u;return(s=a.headers.get("content-type"))!=null&&s.includes("application/json")?u=await a.json():u=await a.text(),{res:{data:u,status:a.status,statusText:a.statusText},error:null}}catch(a){const u=a;return{res:null,error:{message:u.message,status:u.name==="AbortError"?0:500,error:u.name==="AbortError"?"abort-error":"unknown"}}}}setAccessToken(e){if(!e){this.accessToken=null;return}this.accessToken=e}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}}function Ia(t){const e="subdomain"in t||"backendUrl"in t?$t(t,"graphql"):t.graphqlUrl;if(!e)throw new Error("Please provide `subdomain` or `graphqlUrl`.");return new ga({url:e,...t})}function ka(t){const e="subdomain"in t||"backendUrl"in t?$t(t,"storage"):t.storageUrl;if(!e)throw new Error("Please provide `subdomain` or `storageUrl`.");return new wo({url:e,...t})}class _a{constructor({refreshIntervalTime:e,clientStorage:r,clientStorageType:n,autoRefreshToken:i,autoSignIn:s,adminSecret:o,devTools:c,start:a=!0,...u}){this.auth=xa({refreshIntervalTime:e,clientStorage:r,clientStorageType:n,autoRefreshToken:i,autoSignIn:s,start:a,...u}),this.storage=ka({adminSecret:o,...u}),this.functions=Aa({adminSecret:o,...u}),this.graphql=Ia({adminSecret:o,...u}),this.auth.onAuthStateChanged((l,h)=>{if(l==="SIGNED_OUT"){this.storage.setAccessToken(void 0),this.functions.setAccessToken(void 0),this.graphql.setAccessToken(void 0);return}const d=h==null?void 0:h.accessToken;this.storage.setAccessToken(d),this.functions.setAccessToken(d),this.graphql.setAccessToken(d)}),this.auth.onTokenChanged(l=>{const h=l==null?void 0:l.accessToken;this.storage.setAccessToken(h),this.functions.setAccessToken(h),this.graphql.setAccessToken(h)}),this._adminSecret=o,this.devTools=c}get adminSecret(){return this._adminSecret}set adminSecret(e){this._adminSecret=e,this.storage.setAdminSecret(e)}}var Dr={exports:{}},Rr={},Cr={exports:{}},Pr={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ei;function Na(){if(Ei)return Pr;Ei=1;var t=U;function e(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,i=t.useEffect,s=t.useLayoutEffect,o=t.useDebugValue;function c(h,d){var f=d(),p=n({inst:{value:f,getSnapshot:d}}),m=p[0].inst,w=p[1];return s(function(){m.value=f,m.getSnapshot=d,a(m)&&w({inst:m})},[h,f,d]),i(function(){return a(m)&&w({inst:m}),h(function(){a(m)&&w({inst:m})})},[h]),o(f),f}function a(h){var d=h.getSnapshot;h=h.value;try{var f=d();return!r(h,f)}catch{return!0}}function u(h,d){return d()}var l=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?u:c;return Pr.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:l,Pr}var Lr={};/**
 * @license React
 * use-sync-external-store-shim.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Si;function Da(){return Si||(Si=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var t=U,e=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function r(S){{for(var A=arguments.length,k=new Array(A>1?A-1:0),_=1;_<A;_++)k[_-1]=arguments[_];n("error",S,k)}}function n(S,A,k){{var _=e.ReactDebugCurrentFrame,N=_.getStackAddendum();N!==""&&(A+="%s",k=k.concat([N]));var C=k.map(function(P){return String(P)});C.unshift("Warning: "+A),Function.prototype.apply.call(console[S],console,C)}}function i(S,A){return S===A&&(S!==0||1/S===1/A)||S!==S&&A!==A}var s=typeof Object.is=="function"?Object.is:i,o=t.useState,c=t.useEffect,a=t.useLayoutEffect,u=t.useDebugValue,l=!1,h=!1;function d(S,A,k){l||t.startTransition!==void 0&&(l=!0,r("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var _=A();if(!h){var N=A();s(_,N)||(r("The result of getSnapshot should be cached to avoid an infinite loop"),h=!0)}var C=o({inst:{value:_,getSnapshot:A}}),P=C[0].inst,I=C[1];return a(function(){P.value=_,P.getSnapshot=A,f(P)&&I({inst:P})},[S,_,A]),c(function(){f(P)&&I({inst:P});var M=function(){f(P)&&I({inst:P})};return S(M)},[S]),u(_),_}function f(S){var A=S.getSnapshot,k=S.value;try{var _=A();return!s(k,_)}catch{return!0}}function p(S,A,k){return A()}var m=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined",w=!m,E=w?p:d,x=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:E;Lr.useSyncExternalStore=x,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),Lr}process.env.NODE_ENV==="production"?Cr.exports=Na():Cr.exports=Da();var Ti=Cr.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wi;function Ra(){if(wi)return Rr;wi=1;var t=U,e=Ti;function r(u,l){return u===l&&(u!==0||1/u===1/l)||u!==u&&l!==l}var n=typeof Object.is=="function"?Object.is:r,i=e.useSyncExternalStore,s=t.useRef,o=t.useEffect,c=t.useMemo,a=t.useDebugValue;return Rr.useSyncExternalStoreWithSelector=function(u,l,h,d,f){var p=s(null);if(p.current===null){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=c(function(){function E(_){if(!x){if(x=!0,S=_,_=d(_),f!==void 0&&m.hasValue){var N=m.value;if(f(N,_))return A=N}return A=_}if(N=A,n(S,_))return N;var C=d(_);return f!==void 0&&f(N,C)?N:(S=_,A=C)}var x=!1,S,A,k=h===void 0?null:h;return[function(){return E(l())},k===null?void 0:function(){return E(k())}]},[l,h,d,f]);var w=i(u,p[0],p[1]);return o(function(){m.hasValue=!0,m.value=w},[w]),a(w),w},Rr}var Ur={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bi;function Ca(){return bi||(bi=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var t=U,e=Ti;function r(l,h){return l===h&&(l!==0||1/l===1/h)||l!==l&&h!==h}var n=typeof Object.is=="function"?Object.is:r,i=e.useSyncExternalStore,s=t.useRef,o=t.useEffect,c=t.useMemo,a=t.useDebugValue;function u(l,h,d,f,p){var m=s(null),w;m.current===null?(w={hasValue:!1,value:null},m.current=w):w=m.current;var E=c(function(){var k=!1,_,N,C=function(Z){if(!k){k=!0,_=Z;var ce=f(Z);if(p!==void 0&&w.hasValue){var J=w.value;if(p(J,ce))return N=J,J}return N=ce,ce}var ye=_,we=N;if(n(ye,Z))return we;var v=f(Z);return p!==void 0&&p(we,v)?we:(_=Z,N=v,v)},P=d===void 0?null:d,I=function(){return C(h())},M=P===null?void 0:function(){return C(P())};return[I,M]},[h,d,f,p]),x=E[0],S=E[1],A=i(l,x,S);return o(function(){w.hasValue=!0,w.value=A},[A]),a(A),A}Ur.useSyncExternalStoreWithSelector=u,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),Ur}process.env.NODE_ENV==="production"?Dr.exports=Ra():Dr.exports=Ca();var Pa=Dr.exports,La=U.useLayoutEffect;function xi(t){var e=Mi.useRef();return e.current||(e.current={v:t()}),e.current.v}var qt=globalThis&&globalThis.__assign||function(){return qt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},qt.apply(this,arguments)},Ua=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},Ai=globalThis&&globalThis.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s};function Ma(t,e){var r=xi(function(){return typeof t=="function"?t():t});if(process.env.NODE_ENV!=="production"&&typeof t!="function"){var n=Ai(U.useState(r),1),i=n[0];t!==i&&console.warn("Machine given to `useMachine` has changed between renders. This is not supported and might lead to unexpected results.\nPlease make sure that you pass the same Machine as argument each time.")}var s=e.context,o=e.guards,c=e.actions,a=e.activities,u=e.services,l=e.delays;e.state;var h=Ua(e,["context","guards","actions","activities","services","delays","state"]),d=xi(function(){var f={context:s,guards:o,actions:c,activities:a,services:u,delays:l},p=r.withConfig(f,function(){return qt(qt({},r.context),s)});return Le(p,h)});return La(function(){Object.assign(d.machine.options.actions,c),Object.assign(d.machine.options.guards,o),Object.assign(d.machine.options.activities,a),Object.assign(d.machine.options.services,u),Object.assign(d.machine.options.delays,l)},[c,o,a,u,l]),d}function De(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=Ai(e,2),i=n[0],s=i===void 0?{}:i,o=n[1],c=Ma(t,s);return U.useEffect(function(){if(o){var a=c.subscribe(Xe(o));return function(){a.unsubscribe()}}},[o]),U.useEffect(function(){var a=s.state;return c.start(a?de.create(a):void 0),function(){c.stop(),c.status=te.NotStarted}},[]),c}function ja(t){return"state"in t}globalThis&&globalThis.__read,globalThis&&globalThis.__values;function Fa(t){return t.status!==0?t.state:t.machine.initialState}function Va(t){return"state"in t&&"machine"in t}var Ba=function(t,e){return t===e},Ga=function(t,e){if(Va(t)){if(t.status===0&&e.current)return e.current;var r=Fa(t);return e.current=t.status===0?r:null,r}return ja(t)?t.state:void 0};function g(t,e,r,n){r===void 0&&(r=Ba);var i=U.useRef(null),s=U.useCallback(function(a){var u=t.subscribe(a).unsubscribe;return u},[t]),o=U.useCallback(function(){return n?n(t):Ga(t,i)},[t,n]),c=Pa.useSyncExternalStoreWithSelector(s,o,o,e,r);return c}const Mr=_a;class $a extends Mr{constructor(e){super({...e,start:!1})}}const ct=U.createContext({}),jr=({nhost:t,initial:e,...r})=>{const n=De(t.auth.client.machine,{devTools:t.devTools});t.auth.client.start({interpreter:n,initialSession:e,devTools:t.devTools});const i=U.useRef(!0);return U.useEffect(()=>{i.current?i.current=!1:e&&n.send("SESSION_UPDATE",{data:{session:e}})},[e,n]),U.createElement(ct.Provider,{value:t},r.children)},qa=jr,X=()=>{var t;const e=(t=U.useContext(ct).auth)==null?void 0:t.client.interpreter;if(!e)throw Error("Could not find the Nhost auth client. Did you wrap your app in <NhostProvider />?");return e},Fr=()=>{const t=X();return g(t,e=>({isAuthenticated:e.matches({authentication:"signedIn"}),isLoading:e.hasTag("loading"),error:e.context.errors.authentication||null,isError:e.matches({authentication:{signedOut:"failed"}}),connectionAttempts:e.context.importTokenAttempts}),(e,r)=>e.isAuthenticated===r.isAuthenticated&&e.isLoading===r.isLoading&&e.connectionAttempts===r.connectionAttempts)};function Ya({children:t}){const{isAuthenticated:e}=Fr();return e?U.createElement(U.Fragment,null,t):null}function Ha({children:t}){const{isAuthenticated:e}=Fr();return e?null:U.createElement(U.Fragment,null,t)}const Oi=()=>{const t=X();return g(t,e=>e.context.accessToken.value)},Te=()=>U.useContext(ct),za=()=>{const t=Te(),[e,r]=U.useState(null),n=!e,i=!!e,[s,o]=U.useState(!1);return{add:async c=>{o(!0);const a=await jn(t.auth.client,c),{error:u}=a;return u&&r(u),o(!1),a},isLoading:s,isSuccess:n,isError:i,error:e}},Ka=()=>{const t=X(),[e,r]=U.useState(!!t.status&&t.getSnapshot().matches({authentication:"signedIn"}));return U.useEffect(()=>t.subscribe(n=>{const i=n.matches({authentication:"signedIn"});r(i)}).unsubscribe,[t]),e};function Ja(t){const e=Te(),r=U.useMemo(()=>Pn(e.auth.client),[e]),n=De(r),i=g(n,a=>a.matches("requesting")),s=g(n,a=>a.context.error),o=g(n,a=>a.matches("idle.error")),c=g(n,a=>a.matches("idle.success"));return{changeEmail:U.useCallback(async(a,u=t)=>Fn(n,a,u),[n,t]),isLoading:i,needsEmailVerification:c,isError:o,error:s}}const Wa=()=>{const t=Te(),e=U.useMemo(()=>Ln(t.auth.client),[t]),r=De(e),n=g(r,c=>c.matches({idle:"error"})),i=g(r,c=>c.matches({idle:"success"})),s=g(r,c=>c.context.error),o=g(r,c=>c.matches("requesting"));return{changePassword:c=>Vn(r,c),isLoading:o,isSuccess:i,isError:n,error:s}},Qa=()=>{const t=Te(),e=U.useMemo(()=>po(t.auth.client),[t]),r=De(e),n=g(r,l=>l.matches({idle:"error"})||l.matches({generated:{idle:"error"}})),i=g(r,l=>l.matches("generating")),s=g(r,l=>l.matches("generated")),o=g(r,l=>l.matches({generated:"activating"})),c=g(r,l=>l.matches({generated:"activated"})),a=g(r,l=>l.context.error),u=g(r,l=>l.context.imageUrl||"");return{generateQrCode:()=>mo(r),isGenerating:i,qrCodeDataUrl:u,isGenerated:s,activateMfa:l=>yo(r,l),isActivating:o,isActivated:c,isError:n,error:a}},Ii=()=>{const t=Oi();return t?Gr(t):null},ki=t=>{const e=Te(),r=p=>{t.send({type:"ADD",file:p.file,bucketId:p.bucketId||d})},n=p=>xo({url:e.storage.url,accessToken:e.auth.getAccessToken(),adminSecret:e.adminSecret,...p},t),i=()=>{t.send("CANCEL")},s=()=>{t.send("DESTROY")},o=g(t,p=>p.matches("uploading")),c=g(t,p=>p.matches("uploaded")),a=g(t,p=>p.matches("error")),u=g(t,p=>p.context.error||null),l=g(t,p=>p.context.progress),h=g(t,p=>p.context.id),d=g(t,p=>p.context.bucketId),f=g(t,p=>{var m;return(m=p.context.file)==null?void 0:m.name});return{add:r,upload:n,cancel:i,destroy:s,isUploaded:c,isUploading:o,isError:a,error:u,progress:l,id:h,bucketId:d,name:f}},Xa=()=>{const t=De(ei);return ki(t)},_i=()=>{const t=Ii();return(t==null?void 0:t["https://hasura.io/jwt/claims"])||null},Za=t=>{const e=_i();return(e==null?void 0:e[t.startsWith("x-hasura-")?t:`x-hasura-${t}`])||null},ec=()=>{const t=Te(),[e,r]=U.useState([]),n=De(bo,{},f=>{f.event.type==="UPLOAD_ERROR"?r(f.context.files.filter(p=>{var m;return(m=p.getSnapshot())==null?void 0:m.context.error})):(f.matches("uploaded")||f.event.type==="CLEAR")&&e.length>0&&r([])}),i=f=>{n.send({type:"ADD",...f})},s=f=>Ao({url:t.storage.url,accessToken:t.auth.getAccessToken(),adminSecret:t.adminSecret,...f},n),o=()=>{n.send("CANCEL")},c=()=>{n.send("CLEAR")},a=g(n,f=>f.matches("uploading")),u=g(n,f=>f.matches("uploaded")),l=g(n,f=>f.matches("error")),h=g(n,f=>f.context.progress),d=g(n,f=>f.context.files);return{upload:s,add:i,clear:c,cancel:o,progress:h,isUploaded:u,isUploading:a,files:d,isError:l,errors:e}},tc=t=>{const[e,r]=U.useState(!0);U.useEffect(()=>{r(!1)},[]);const n=U.useContext(ct);return new Proxy({},{get(i,s){return mr(`${n.auth.client.backendUrl}/signin/provider/${s}`,he(e?void 0:n.auth.client.clientUrl,t))}})},rc=t=>{const e=Te(),r=U.useMemo(()=>Un(e.auth.client),[e]),n=De(r),i=g(n,a=>a.matches("requesting")),s=g(n,a=>a.context.error),o=g(n,a=>a.matches("idle.error")),c=g(n,a=>a.matches("idle.success"));return{resetPassword:(a,u=t)=>Bn(n,a,u),isLoading:i,isSent:c,isError:o,error:s}},nc=t=>{const e=Te(),r=U.useMemo(()=>Mn(e.auth.client),[e]),n=De(r),i=g(n,a=>a.matches({idle:"error"})),s=g(n,a=>a.matches({idle:"success"})),o=g(n,a=>a.context.error),c=g(n,a=>a.matches("requesting"));return{sendEmail:(a,u=t)=>Gn(n,a,u),isLoading:c,isSent:s,isError:i,error:o}},ic=()=>{const t=X(),e=()=>$n(t),r=g(t,c=>c.context.errors.authentication||null,(c,a)=>(c==null?void 0:c.error)===(a==null?void 0:a.error)),n=g(t,c=>c.matches({authentication:{authenticating:"anonymous"}})),i=g(t,c=>c.matches({authentication:"signedIn"})),s=g(t,c=>c.matches({authentication:{signedOut:"failed"}})),o=g(t,c=>c.context.user,(c,a)=>(c==null?void 0:c.id)===(a==null?void 0:a.id));return{accessToken:g(t,c=>c.context.accessToken.value),error:r,isError:s,isLoading:n,isSuccess:i,signInAnonymous:e,user:o}},sc=()=>{const t=X(),e=(d,f)=>qn(t,d,f),r=d=>Hn(t,d),n=g(t,d=>d.context.user,(d,f)=>(d==null?void 0:d.id)===(f==null?void 0:f.id)),i=g(t,d=>d.context.accessToken.value),s=g(t,d=>d.context.errors.authentication||null,(d,f)=>(d==null?void 0:d.error)===(f==null?void 0:f.error)),o=g(t,d=>d.matches({authentication:"signedIn"})),c=g(t,d=>d.matches({authentication:{authenticating:"password"}}),(d,f)=>d===f),a=g(t,d=>d.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(d,f)=>d===f),u=g(t,d=>d.matches({authentication:{signedOut:"needsMfa"}}),(d,f)=>d===f),l=g(t,d=>d.matches({authentication:{signedOut:"failed"}}),(d,f)=>d===f),h=g(t,d=>d.context.mfa);return{accessToken:i,error:s,isError:l,isLoading:c,isSuccess:o,needsEmailVerification:a,needsMfaOtp:u,mfa:h,sendMfaOtp:r,signInEmailPassword:e,user:n}};function oc(t){const e=X(),r=(c,a=t)=>gr(e,c,a),n=g(e,c=>c.context.errors.registration||null,(c,a)=>(c==null?void 0:c.error)===(a==null?void 0:a.error)),i=g(e,c=>c.matches("registration.passwordlessEmail")),s=g(e,c=>c.matches("registration.incomplete.needsEmailVerification")),o=g(e,c=>c.matches("registration.incomplete.failed"));return{signInEmailPasswordless:r,isLoading:i,isSuccess:s,isError:o,error:n}}const ac=()=>{const t=X(),e=u=>Yn(t,u),r=g(t,u=>u.context.user,(u,l)=>(u==null?void 0:u.id)===(l==null?void 0:l.id)),n=g(t,u=>u.context.accessToken.value),i=g(t,u=>u.context.errors.authentication||null,(u,l)=>(u==null?void 0:u.error)===(l==null?void 0:l.error)),s=g(t,u=>u.matches({authentication:"signedIn"})),o=g(t,u=>u.matches({authentication:{authenticating:"securityKeyEmail"}}),(u,l)=>u===l),c=g(t,u=>u.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(u,l)=>u===l),a=g(t,u=>u.matches({authentication:{signedOut:"failed"}}),(u,l)=>u===l);return{accessToken:n,error:i,isError:a,isLoading:o,isSuccess:s,needsEmailVerification:c,signInEmailSecurityKey:e,user:r}},cc=()=>{const t=X(),e=a=>zn(t,a),r=g(t,a=>a.context.user,(a,u)=>(a==null?void 0:a.id)===(u==null?void 0:u.id)),n=g(t,a=>a.context.accessToken.value),i=g(t,a=>a.context.errors.authentication||null,(a,u)=>(a==null?void 0:a.error)===(u==null?void 0:u.error)),s=g(t,a=>a.matches({authentication:"signedIn"})),o=g(t,a=>a.matches({authentication:{authenticating:"password"}}),(a,u)=>a===u),c=g(t,a=>a.matches({authentication:{signedOut:"failed"}}),(a,u)=>a===u);return{accessToken:n,error:i,isError:c,isLoading:o,isSuccess:s,signInPAT:e,user:r}};function uc(t){const e=X(),[r,n]=U.useState(""),i=(h,d=t)=>(n(h),Er(e,h,d)),s=async(...h)=>{if(h.length===2){const[f,p]=h;return Sr(e,f,p)}const[d]=h;return Sr(e,r,d)},o=g(e,h=>h.context.errors.registration||null,(h,d)=>(h==null?void 0:h.error)===(d==null?void 0:d.error)),c=g(e,h=>h.matches("registration.passwordlessSms")||h.matches("registration.passwordlessSmsOtp")),a=g(e,h=>h.matches("authentication.signedIn")),u=g(e,h=>h.matches("registration.incomplete.needsOtp")),l=g(e,h=>h.matches("registration.incomplete.failed"));return{signInSmsPasswordless:i,sendOtp:s,isLoading:c,isSuccess:a,needsOtp:u,isError:l,error:o}}const lc=(t=!1)=>{const e=X(),r=s=>Kn(e,typeof s=="boolean"?s:t),n=g(e,s=>s.matches({authentication:{signedOut:"success"}}),(s,o)=>s===o),i=g(e,s=>s.context.errors.signout||null,(s,o)=>(s==null?void 0:s.error)===(o==null?void 0:o.error));return{signOut:r,isSuccess:n,error:i}},dc=t=>{const e=X(),r=g(e,u=>!!u.context.errors.registration),n=g(e,u=>u.context.errors.registration||null,(u,l)=>(u==null?void 0:u.error)===(l==null?void 0:l.error)),i=g(e,u=>u.matches("registration.emailPassword")),s=g(e,u=>u.matches("registration.incomplete.needsEmailVerification")),o=g(e,u=>u.matches({authentication:"signedIn",registration:"complete"})),c=(u,l,h=t)=>Tr(e,u,l,h),a=g(e,u=>u.context.user,(u,l)=>(u==null?void 0:u.id)===(l==null?void 0:l.id));return{accessToken:g(e,u=>u.context.accessToken.value),error:n,isError:r,isLoading:i,isSuccess:o,needsEmailVerification:s,signUpEmailPassword:c,user:a}},hc=t=>{const e=X(),r=g(e,u=>!!u.context.errors.registration),n=g(e,u=>u.context.errors.registration||null,(u,l)=>(u==null?void 0:u.error)===(l==null?void 0:l.error)),i=g(e,u=>u.matches("registration.securityKey")),s=g(e,u=>u.matches("registration.incomplete.needsEmailVerification")),o=g(e,u=>u.matches({authentication:"signedIn",registration:"complete"})),c=(u,l=t)=>Jn(e,u,l),a=g(e,u=>u.context.user,(u,l)=>(u==null?void 0:u.id)===(l==null?void 0:l.id));return{accessToken:g(e,u=>u.context.accessToken.value),error:n,isError:r,isLoading:i,isSuccess:o,needsEmailVerification:s,signUpEmailSecurityKey:c,user:a}},fc=()=>{const t=X();return g(t,e=>{var r;return(r=e.context.user)==null?void 0:r.avatarUrl},(e,r)=>e===r)},pc=()=>{const t=X();return g(t,e=>e.context.user,(e,r)=>(e&&JSON.stringify(e))===(r&&JSON.stringify(r)))},vc=()=>{const t=X();return g(t,e=>{var r;return(r=e.context.user)==null?void 0:r.defaultRole},(e,r)=>e===r)},mc=()=>{const t=X();return g(t,e=>{var r;return(r=e.context.user)==null?void 0:r.displayName},(e,r)=>e===r)},yc=()=>{const t=X();return g(t,e=>{var r;return(r=e.context.user)==null?void 0:r.email},(e,r)=>e===r)},gc=()=>{const t=X();return g(t,e=>{var r;return(r=e.context.user)==null?void 0:r.id},(e,r)=>e===r)},Ec=()=>{const t=X();return g(t,e=>{var r;return(r=e.context.user)==null?void 0:r.isAnonymous},(e,r)=>e===r)},Sc=()=>{const t=X();return g(t,e=>{var r;return(r=e.context.user)==null?void 0:r.locale},(e,r)=>e===r)},Tc=()=>{const t=X();return g(t,e=>{var r;return e.matches("authentication.signedIn")?((r=e.context.user)==null?void 0:r.roles)||[]:[]})},Vr="nhostSession",Ni=t=>{const e=t&&"auth"in t?t.auth.getSession():t;if(!e){Oe.remove(Vr);return}const{refreshToken:r,...n}=e,i=new Date;i.setSeconds(i.getSeconds()+e.accessTokenExpiresIn-60),Oe.set(Vr,JSON.stringify(n),{sameSite:"strict",expires:i})};var Di={},Ri={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});/*! *****************************************************************************
    	Copyright (c) Microsoft Corporation.

    	Permission to use, copy, modify, and/or distribute this software for any
    	purpose with or without fee is hereby granted.

    	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    	PERFORMANCE OF THIS SOFTWARE.
    	***************************************************************************** */t.__assign=function(){return t.__assign=Object.assign||function(o){for(var c,a=1,u=arguments.length;a<u;a++){c=arguments[a];for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&(o[l]=c[l])}return o},t.__assign.apply(this,arguments)};function e(s,o){var c={};for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&o.indexOf(a)<0&&(c[a]=s[a]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,a=Object.getOwnPropertySymbols(s);u<a.length;u++)o.indexOf(a[u])<0&&Object.prototype.propertyIsEnumerable.call(s,a[u])&&(c[a[u]]=s[a[u]]);return c}function r(s){var o=typeof Symbol=="function"&&Symbol.iterator,c=o&&s[o],a=0;if(c)return c.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&a>=s.length&&(s=void 0),{value:s&&s[a++],done:!s}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")}function n(s,o){var c=typeof Symbol=="function"&&s[Symbol.iterator];if(!c)return s;var a=c.call(s),u,l=[],h;try{for(;(o===void 0||o-- >0)&&!(u=a.next()).done;)l.push(u.value)}catch(d){h={error:d}}finally{try{u&&!u.done&&(c=a.return)&&c.call(a)}finally{if(h)throw h.error}}return l}function i(s,o,c){if(c||arguments.length===2)for(var a=0,u=o.length,l;a<u;a++)(l||!(a in o))&&(l||(l=Array.prototype.slice.call(o,0,a)),l[a]=o[a]);return s.concat(l||Array.prototype.slice.call(o))}t.__read=n,t.__rest=e,t.__spreadArray=i,t.__values=r})(Ri),Object.defineProperty(Di,"__esModule",{value:!0});var Ci=Ri,wc={timeout:1e4};function bc(t,e,r){var n=Ci.__assign(Ci.__assign({},wc),r);return new Promise(function(i,s){var o=!1;process.env.NODE_ENV!=="production"&&n.timeout<0&&console.error("`timeout` passed to `waitFor` is negative and it will reject its internal promise immediately.");var c=n.timeout===1/0?void 0:setTimeout(function(){u.unsubscribe(),s(new Error("Timeout of ".concat(n.timeout," ms exceeded")))},n.timeout),a=function(){clearTimeout(c),o=!0,u==null||u.unsubscribe()},u=t.subscribe({next:function(l){e(l)&&(a(),i(l))},error:function(l){a(),s(l)},complete:function(){a(),s(new Error("Actor terminated without satisfying predicate"))}});o&&u.unsubscribe()})}var xc=Di.waitFor=bc;const Pi=async(t,e)=>{let r;typeof t=="string"?(console.warn("Deprecation Notice: Backend URL is no longer supported. Please use subdomain + region or individual service URLs."),r={backendUrl:t}):r={...t};const n=new Mr({...r,clientStorageType:"custom",clientStorage:{getItem:c=>{var d;const a=c===Ie?"refreshToken":c,u=e.query[a],l=(d=Oe.get(c))!=null?d:null,h=e.req.cookies[c];return typeof u=="string"?u:l!=null?l:h},setItem:(c,a)=>{Oe.set(c,a,{httpOnly:!1,sameSite:"strict",expires:30})},removeItem:c=>{Oe.remove(c)}},start:!1,autoRefreshToken:!1,autoSignIn:!0}),i=e.req.cookies[Vr],s=e.req.cookies[Ie],o=i&&s&&{...JSON.parse(i),refreshToken:s};return n.auth.client.start({initialSession:o}),await xc(n.auth.client.interpreter,c=>!c.hasTag("loading")),n},Ac=async(t,e)=>{const r=await Pi(t,e),{accessToken:n,refreshToken:i,user:s}=r.auth.client.interpreter.getSnapshot().context;return r.auth.isAuthenticated()?{accessToken:n.value,accessTokenExpiresIn:(n.expiresAt.getTime()-Date.now())/1e3,refreshToken:i.value,user:s}:null},Oc=jr,Li=typeof window!="undefined";class Ic extends $a{constructor(e){super({...e,autoSignIn:Li&&e.autoSignIn,autoRefreshToken:Li&&e.autoRefreshToken,clientStorageType:"cookie"}),this.auth.onAuthStateChanged(()=>{Ni(this)}),this.auth.onTokenChanged(Ni)}}D.NHOST_REFRESH_TOKEN_KEY=Ie,D.NhostClient=Ic,D.NhostNextProvider=Oc,D.NhostProvider=jr,D.NhostReactContext=ct,D.NhostReactProvider=qa,D.SignedIn=Ya,D.SignedOut=Ha,D.VanillaNhostClient=Mr,D.createServerSideClient=Pi,D.getNhostSession=Ac,D.useAccessToken=Oi,D.useAddSecurityKey=za,D.useAuthInterpreter=X,D.useAuthenticated=Ka,D.useAuthenticationStatus=Fr,D.useChangeEmail=Ja,D.useChangePassword=Wa,D.useConfigMfa=Qa,D.useDecodedAccessToken=Ii,D.useFileUpload=Xa,D.useFileUploadItem=ki,D.useHasuraClaim=Za,D.useHasuraClaims=_i,D.useMultipleFilesUpload=ec,D.useNhostClient=Te,D.useProviderLink=tc,D.useResetPassword=rc,D.useSendVerificationEmail=nc,D.useSignInAnonymous=ic,D.useSignInEmailPassword=sc,D.useSignInEmailPasswordless=oc,D.useSignInEmailSecurityKey=ac,D.useSignInPAT=cc,D.useSignInSmsPasswordless=uc,D.useSignOut=lc,D.useSignUpEmailPassword=dc,D.useSignUpEmailSecurityKeyEmail=hc,D.useUserAvatarUrl=fc,D.useUserData=pc,D.useUserDefaultRole=vc,D.useUserDisplayName=mc,D.useUserEmail=yc,D.useUserId=gc,D.useUserIsAnonymous=Ec,D.useUserLocale=Sc,D.useUserRoles=Tc,Object.defineProperty(D,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=nextjs.umd.js.map
